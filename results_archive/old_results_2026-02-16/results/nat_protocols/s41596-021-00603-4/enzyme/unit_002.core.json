{
  "entities": [
    {
      "id": "e1",
      "name": "organoid culture",
      "properties": {},
      "type": "sample"
    },
    {
      "id": "e2",
      "name": "Matrigel",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e3",
      "name": "Organoid culture medium",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e4",
      "name": "127IdU stock (0.5 mM)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e5",
      "name": "Protease inhibitor cocktail (100×)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e6",
      "name": "PhosSTOP (40×)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e7",
      "name": "4% (vol/vol) PFA",
      "properties": {
        "prewarmed": "37 °C"
      },
      "type": "reagent"
    },
    {
      "id": "e8",
      "name": "PBS",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e9",
      "name": "194cisplatin (0.25 µM) in PBS",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e10",
      "name": "TOBis barcodes (pre‑aliquoted)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e11",
      "name": "2 mM glutathione/CSB",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e12",
      "name": "CSB (Cell Staining Buffer)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e13",
      "name": "Dispase II (0.5 mg ml⁻¹)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e14",
      "name": "Collagenase IV (0.2 mg ml⁻¹)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e15",
      "name": "DNase I (0.2 mg ml⁻¹)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e16",
      "name": "gentleMACS C‑Tube",
      "properties": {},
      "type": "container"
    },
    {
      "id": "e17",
      "name": "gentleMACS Octo dissociator",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e18",
      "name": "centrifuge",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e19",
      "name": "polypropylene FACS tube",
      "properties": {},
      "type": "container"
    },
    {
      "id": "e20",
      "name": "rocker (≈45 rpm)",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e21",
      "name": "incubator (37 °C, 5 % CO₂)",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e22",
      "name": "Countess II automated cell counter",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e23",
      "name": "Extracellular antibody cocktail (in CSB)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e24",
      "name": "Intracellular antibody cocktail (in CSB)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e25",
      "name": "0.1 % Triton X‑100/PBS",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e26",
      "name": "50 % methanol/PBS (ice‑cold)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e27",
      "name": "1.6 % FA/PBS (fresh from 16 % FA)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e28",
      "name": "Cell‑ID Intercalator‑Ir (125 µM stock)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e29",
      "name": "Fix & Perm buffer",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e30",
      "name": "Helios mass cytometer",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e31",
      "name": "EQ beads",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e32",
      "name": "EDTA (2 mM final)",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e33",
      "name": "MaxPar water",
      "properties": {},
      "type": "reagent"
    },
    {
      "id": "e34",
      "name": "Super Sampler (Victorian Airships)",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e35",
      "name": "computer (for Fluidigm CyTOF software, MATLAB, Conda, CyGNAL)",
      "properties": {},
      "type": "instrument"
    },
    {
      "id": "e36",
      "name": "35‑µm cell strainer",
      "properties": {},
      "type": "container"
    },
    {
      "id": "e37",
      "name": "70‑µm cell strainer",
      "properties": {},
      "type": "container"
    }
  ],
  "ir_kind": "core",
  "ir_version": "0.4",
  "kind": "enzyme_hl_ir",
  "meta": {
    "language": "en",
    "protocol_id": "s41596-021-00603-4",
    "source": "Nature Protocols",
    "title": "Procedure"
  },
  "protocol": {
    "edges": [],
    "steps": []
  },
  "registries": {
    "custom": {
      "action_kind": [],
      "device_kind": [],
      "features": [],
      "modality": []
    }
  },
  "settings": {
    "biosafety_level": "2",
    "contains_human_or_animal_material": true,
    "contamination_control": [
      "use sterile technique",
      "prewarm reagents as indicated"
    ],
    "requires_irb_or_iacuc": true,
    "sterility_required": true
  },
  "steps": [
    {
      "id": "s1",
      "inputs": [
        "e2",
        "e3",
        "e1"
      ],
      "notes": "Culture organoids (or organoid co‑cultures) in 50 µl of Matrigel and 200 µl of medium.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "plate_type": "96‑well tissue culture plate",
        "well_volume": {
          "Matrigel": "50 µl",
          "medium": "200 µl"
        }
      }
    },
    {
      "id": "s2",
      "inputs": [
        "e4"
      ],
      "notes": "Add 127IdU directly to culture medium to a final concentration of 25 µM (10 µl of 0.5 mM stock added to 200 µl of medium).",
      "op": "transfer",
      "outputs": [
        "e1"
      ],
      "params": {
        "final_concentration": "25 µM",
        "target": "culture medium",
        "volume": "10 µl"
      }
    },
    {
      "id": "s2b",
      "inputs": [
        "e1"
      ],
      "notes": "Gently rotate the plate by hand five times for 10 s to mix the medium.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "rotate",
        "duration": "10 s",
        "times": 5
      }
    },
    {
      "id": "s2c",
      "inputs": [
        "e1"
      ],
      "notes": "Incubate the plate for 25 min at 37 °C and 5 % CO₂.",
      "op": "incubate",
      "outputs": [
        "e1"
      ],
      "params": {
        "CO2": "5 %",
        "duration": "25 min",
        "temperature": "37 °C"
      }
    },
    {
      "id": "s3",
      "inputs": [
        "e5",
        "e6"
      ],
      "notes": "Add the protease inhibitor cocktail (100×) and PhosSTOP (40×) directly to culture medium.",
      "op": "transfer",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "add directly to culture medium"
      }
    },
    {
      "id": "s3b",
      "inputs": [
        "e1"
      ],
      "notes": "Gently rotate the plate by hand five times for 10 s.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "rotate",
        "duration": "10 s",
        "times": 5
      }
    },
    {
      "id": "s3c",
      "inputs": [
        "e1"
      ],
      "notes": "Incubate for 5 min at 37 °C and 5 % CO₂.",
      "op": "incubate",
      "outputs": [
        "e1"
      ],
      "params": {
        "CO2": "5 %",
        "duration": "5 min",
        "temperature": "37 °C"
      }
    },
    {
      "id": "s4",
      "inputs": [
        "e1",
        "e7"
      ],
      "notes": "Remove culture medium by pipetting. Add 200 µl of pre‑warmed (37 °C) 4 % (vol/vol) PFA into each well, taking care not to disrupt Matrigel.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "remove medium",
        "add_volume": "200 µl",
        "prewarm": "37 °C"
      }
    },
    {
      "id": "s4b",
      "inputs": [
        "e1"
      ],
      "notes": "Incubate for 60 min at 37 °C and 5 % CO₂.",
      "op": "incubate",
      "outputs": [
        "e1"
      ],
      "params": {
        "CO2": "5 %",
        "duration": "60 min",
        "temperature": "37 °C"
      }
    },
    {
      "id": "s5",
      "inputs": [
        "e1",
        "e8",
        "e20"
      ],
      "notes": "Remove PFA solution by pipetting, taking care not to disturb the Matrigel. Wash the cells with PBS on a rocker (≈45 rpm) for 10 min at room temperature. Repeat the wash.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "wash",
        "rocker_speed": "~45 rpm",
        "temperature": "room temperature",
        "wash_time": "10 min",
        "wash_volume": "200 µl"
      }
    },
    {
      "id": "s5b",
      "inputs": [],
      "notes": "PAUSE POINT: Fixed cells can be kept at 4 °C in PBS. Determine maximal storage time for your system.",
      "op": "annotate",
      "outputs": [],
      "params": {}
    },
    {
      "id": "s6",
      "inputs": [
        "e9"
      ],
      "notes": "Remove PBS by pipetting. Add 200 µl of 0.25 µM 194cisplatin/PBS solution to each well and incubate for 10–15 min on a rocker at room temperature.",
      "op": "transfer",
      "outputs": [
        "e1"
      ],
      "params": {
        "target": "well",
        "volume": "200 µl"
      }
    },
    {
      "id": "s6b",
      "inputs": [
        "e1"
      ],
      "notes": "",
      "op": "incubate",
      "outputs": [
        "e1"
      ],
      "params": {
        "duration": "10–15 min",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s7",
      "inputs": [
        "e1",
        "e8",
        "e20"
      ],
      "notes": "Remove the 194cisplatin solution by pipetting. Wash cells with PBS on a rocker for 10 min at room temperature. Repeat the wash.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "wash",
        "rocker_speed": "~45 rpm",
        "temperature": "room temperature",
        "wash_time": "10 min",
        "wash_volume": "200 µl"
      }
    },
    {
      "id": "s7b",
      "inputs": [],
      "notes": "Proceed to the next steps on the same day. Long‑term storage of cisplatin‑stained cells in situ will lead to overstaining.",
      "op": "annotate",
      "outputs": [],
      "params": {}
    },
    {
      "id": "s8",
      "inputs": [
        "e10"
      ],
      "notes": "Transfer 200 µl of pre‑aliquoted TOBis barcodes to corresponding organoid samples in a 96‑well plate. Incubate the cells overnight at 4 °C.",
      "op": "transfer",
      "outputs": [
        "e1"
      ],
      "params": {
        "target": "corresponding organoid samples",
        "volume": "200 µl"
      }
    },
    {
      "id": "s8b",
      "inputs": [
        "e1"
      ],
      "notes": "",
      "op": "incubate",
      "outputs": [
        "e1"
      ],
      "params": {
        "duration": "overnight",
        "temperature": "4 °C"
      }
    },
    {
      "id": "s9",
      "inputs": [
        "e1",
        "e11",
        "e20"
      ],
      "notes": "Remove the barcoding solutions by pipetting and wash the cells with 200 µl of 2 mM glutathione/CSB for 10 min on a rocker at room temperature. Repeat the wash twice.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "wash",
        "repetitions": 3,
        "rocker_speed": "~45 rpm",
        "temperature": "room temperature",
        "wash_time": "10 min",
        "wash_volume": "200 µl"
      }
    },
    {
      "id": "s10",
      "inputs": [
        "e1",
        "e8",
        "e20"
      ],
      "notes": "Wash the cells with 200 µl of PBS for 10 min on a rocker at room temperature. Repeat the wash.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "wash",
        "repetitions": 2,
        "rocker_speed": "~45 rpm",
        "temperature": "room temperature",
        "wash_time": "10 min",
        "wash_volume": "200 µl"
      }
    },
    {
      "id": "s10b",
      "inputs": [],
      "notes": "PAUSE POINT: The barcoded cells can be kept at 4 °C for ≤4 weeks in PBS.",
      "op": "annotate",
      "outputs": [],
      "params": {}
    },
    {
      "id": "s11",
      "inputs": [],
      "notes": "Make up a dissociation solution of fresh 0.5 mg ml⁻¹ dispase II, 0.2 mg ml⁻¹ collagenase IV and 0.2 mg ml⁻¹ DNase I in PBS at room temperature.",
      "op": "allocate",
      "outputs": [
        "e13",
        "e14",
        "e15"
      ],
      "params": {
        "components": {
          "DNase I": "0.2 mg ml⁻¹",
          "collagenase IV": "0.2 mg ml⁻¹",
          "dispase II": "0.5 mg ml⁻¹"
        },
        "solution": "dissociation buffer",
        "solvent": "PBS",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s12",
      "inputs": [
        "e1",
        "e13",
        "e14",
        "e15"
      ],
      "notes": "Remove PBS from the wells by pipetting and add the dissociation solution.",
      "op": "manipulate",
      "outputs": [
        "e1"
      ],
      "params": {
        "action": "remove PBS",
        "add_solution": "dissociation buffer"
      }
    },
    {
      "id": "s13",
      "inputs": [
        "e1",
        "e16"
      ],
      "notes": "Scrape Matrigel droplets and pool all cells from all conditions with dissociation solution to a gentleMACS C‑Tube. Top up the dissociation solution to 5 ml per C‑Tube.",
      "op": "manipulate",
      "outputs": [
        "e16"
      ],
      "params": {
        "action": "scrape Matrigel droplets and pool cells",
        "final_volume": "5 ml"
      }
    },
    {
      "id": "s14",
      "inputs": [
        "e16",
        "e17"
      ],
      "notes": "Dissociate organoids into single cells using a gentleMACS Octo dissociator with the ‘Standard protocol’.",
      "op": "run_device",
      "outputs": [
        "e16"
      ],
      "params": {
        "device": "gentleMACS Octo dissociator",
        "duration": "~50 min",
        "program": "Standard protocol"
      }
    },
    {
      "id": "s15",
      "inputs": [
        "e16"
      ],
      "notes": "Centrifuge the C‑Tubes at 800 g for 1 min at room temperature to collect the cells.",
      "op": "centrifuge",
      "outputs": [
        "e16"
      ],
      "params": {
        "duration": "1 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s16",
      "inputs": [
        "e16"
      ],
      "notes": "Transfer all cells and solution to a polypropylene FACS tube.",
      "op": "transfer",
      "outputs": [
        "e19"
      ],
      "params": {
        "target": "polypropylene FACS tube"
      }
    },
    {
      "id": "s17",
      "inputs": [
        "e19"
      ],
      "notes": "Centrifuge cells at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s18",
      "inputs": [
        "e19",
        "e12"
      ],
      "notes": "Wash cells with 2 ml of CSB, centrifuge at 800 g for 5 min at room temperature and discard the supernatant. Repeat the wash.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "action": "wash",
        "duration": "5 min",
        "repetitions": 2,
        "speed": "800 g",
        "wash_volume": "2 ml"
      }
    },
    {
      "id": "s19",
      "inputs": [
        "e19"
      ],
      "notes": "Resuspend cells in 2 ml of CSB and filter through a cell strainer to remove residual clumps. Use 35‑µm strainers for monocultures and 70‑µm strainers for cultures containing fibroblasts.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "action": "filter",
        "filter_type": "cell strainer",
        "volume": "2 ml"
      }
    },
    {
      "id": "s20",
      "inputs": [
        "e19"
      ],
      "notes": "Count cells using the Countess II automated cell counter. Up to ~4.5 × 10⁶ cells can be taken forward for 1× MC staining.",
      "op": "measure",
      "outputs": [],
      "params": {
        "instrument": "Countess II automated cell counter"
      }
    },
    {
      "id": "s21",
      "inputs": [
        "e19"
      ],
      "notes": "Centrifuge cells at 800 g for 5 min at room temperature, discard the supernatant and resuspend cells in 50 µl of CSB.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s22",
      "inputs": [],
      "notes": "Prepare extracellular antibody cocktail by mixing the antibody panel in CSB (total volume up to 50 µl).",
      "op": "allocate",
      "outputs": [
        "e23"
      ],
      "params": {
        "buffer": "CSB",
        "solution": "extracellular antibody cocktail",
        "volume": "up to 50 µl"
      }
    },
    {
      "id": "s23",
      "inputs": [
        "e23"
      ],
      "notes": "Add the extracellular antibody cocktail to the cells, mix thoroughly by pipetting and incubate for 30 min on a rocker at room temperature. Mix cells by gently flicking the tube every 10 min.",
      "op": "transfer",
      "outputs": [
        "e19"
      ],
      "params": {
        "mix_method": "pipette",
        "volume": "up to 50 µl"
      }
    },
    {
      "id": "s24",
      "inputs": [
        "e19"
      ],
      "notes": "Add 2 ml of CSB to the cells, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s25",
      "inputs": [
        "e19"
      ],
      "notes": "Resuspend cells in 1 ml of 0.1 % (vol/vol) Triton X‑100/PBS, gently vortex and incubate for 30 min on a rocker at room temperature. Mix cells by gently flicking the tube every 10 min.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "incubation": {
          "duration": "30 min",
          "rocker": true,
          "temperature": "room temperature"
        },
        "mix_interval": "10 min",
        "solution": "0.1 % Triton X‑100/PBS",
        "volume": "1 ml",
        "vortex": true
      }
    },
    {
      "id": "s26",
      "inputs": [
        "e19"
      ],
      "notes": "Add 2 ml of CSB to the cells, centrifuge at 800 g for 5 min at room temperature and discard the supernatant. Repeat the wash and remove the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "repetitions": 2,
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s27",
      "inputs": [
        "e19"
      ],
      "notes": "Place the cells on ice for 1 min.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "action": "place on ice",
        "duration": "1 min"
      }
    },
    {
      "id": "s28",
      "inputs": [
        "e19"
      ],
      "notes": "Resuspend cells in 1 ml of ice‑cold 50 % (vol/vol) methanol/PBS, gently vortex and incubate for 10 min on ice.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "incubation": {
          "duration": "10 min",
          "temperature": "ice"
        },
        "solution": "50 % methanol/PBS (ice‑cold)",
        "volume": "1 ml",
        "vortex": true
      }
    },
    {
      "id": "s29",
      "inputs": [
        "e19"
      ],
      "notes": "Add 2 ml of CSB to the cells, centrifuge at 800 g for 5 min at room temperature and discard the supernatant. Repeat the wash.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "repetitions": 2,
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s30",
      "inputs": [
        "e19"
      ],
      "notes": "Resuspend cells in 50 µl of CSB.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "action": "resuspend",
        "buffer": "CSB",
        "volume": "50 µl"
      }
    },
    {
      "id": "s31",
      "inputs": [],
      "notes": "Prepare intracellular antibody cocktail by mixing the antibody panel in CSB (total volume up to 50 µl).",
      "op": "allocate",
      "outputs": [
        "e24"
      ],
      "params": {
        "buffer": "CSB",
        "solution": "intracellular antibody cocktail",
        "volume": "up to 50 µl"
      }
    },
    {
      "id": "s32",
      "inputs": [
        "e24"
      ],
      "notes": "Add the intracellular antibody cocktail to the cells, mix thoroughly by pipetting and incubate for 30 min on a rocker at room temperature. Mix cells by gently flicking the tube every 10 min.",
      "op": "transfer",
      "outputs": [
        "e19"
      ],
      "params": {
        "mix_method": "pipette",
        "volume": "up to 50 µl"
      }
    },
    {
      "id": "s33",
      "inputs": [
        "e19"
      ],
      "notes": "Add 2 ml of CSB to the cells, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s34",
      "inputs": [
        "e19"
      ],
      "notes": "Add 1 ml of 1.6 % (vol/vol) FA/PBS solution (made fresh from 16 % FA) to the cells and incubate for 10 min on a rocker at room temperature.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "incubation": {
          "duration": "10 min",
          "rocker": true,
          "temperature": "room temperature"
        },
        "solution": "1.6 % FA/PBS",
        "volume": "1 ml"
      }
    },
    {
      "id": "s35",
      "inputs": [
        "e19"
      ],
      "notes": "Add 2 ml of CSB to the cells, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s36",
      "inputs": [],
      "notes": "Prepare intercalation buffer by diluting 1 µl of 125 µM Cell‑ID Intercalator‑Ir in 1 ml of Fix & Perm buffer (final concentration = 125 nM).",
      "op": "allocate",
      "outputs": [
        "e28"
      ],
      "params": {
        "components": {
          "Cell‑ID Intercalator‑Ir": "1 µl of 125 µM",
          "Fix & Perm buffer": "1 ml"
        },
        "final_concentration": "125 nM",
        "solution": "intercalation buffer"
      }
    },
    {
      "id": "s37",
      "inputs": [
        "e19",
        "e28"
      ],
      "notes": "Resuspend cells in 1 ml of intercalation buffer, gently vortex and incubate for 1 h on a rocker at room temperature or overnight at 4 °C.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "alternative": "overnight at 4 °C",
        "incubation": {
          "duration": "1 h",
          "rocker": true,
          "temperature": "room temperature"
        },
        "volume": "1 ml",
        "vortex": true
      }
    },
    {
      "id": "s38",
      "inputs": [
        "e30"
      ],
      "notes": "Tune the Helios mass cytometer (see Equipment setup).",
      "op": "run_device",
      "outputs": [],
      "params": {
        "action": "tune mass cytometer"
      }
    },
    {
      "id": "s39",
      "inputs": [
        "e19"
      ],
      "notes": "Centrifuge cells at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "speed": "800 g",
        "temperature": "room temperature"
      }
    },
    {
      "id": "s40",
      "inputs": [
        "e19"
      ],
      "notes": "Wash the cells with 2 ml of 2 mM EDTA/CSB, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "solution": "2 mM EDTA/CSB",
        "speed": "800 g",
        "temperature": "room temperature",
        "volume": "2 ml"
      }
    },
    {
      "id": "s41",
      "inputs": [
        "e19"
      ],
      "notes": "Wash cells with 2 ml of CSB, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "solution": "CSB",
        "speed": "800 g",
        "temperature": "room temperature",
        "volume": "2 ml"
      }
    },
    {
      "id": "s42",
      "inputs": [
        "e19"
      ],
      "notes": "Wash cells with 2 ml of MaxPar water, centrifuge at 800 g for 5 min at room temperature and discard the supernatant.",
      "op": "centrifuge",
      "outputs": [
        "e19"
      ],
      "params": {
        "duration": "5 min",
        "solution": "MaxPar water",
        "speed": "800 g",
        "temperature": "room temperature",
        "volume": "2 ml"
      }
    },
    {
      "id": "s43",
      "inputs": [
        "e19"
      ],
      "notes": "Resuspend cells in 1 ml of MaxPar water, filter through a 35‑µm cell strainer (70 µm when the culture contains fibroblasts) and count the cells using a Countess II automated cell counter.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "count_method": "Countess II",
        "filter": "35‑µm cell strainer (or 70‑µm for fibroblast‑containing cultures)",
        "solution": "MaxPar water",
        "volume": "1 ml"
      }
    },
    {
      "id": "s44",
      "inputs": [
        "e19"
      ],
      "notes": "Dilute cells to ~0.8–1.2 × 10⁶ cells ml⁻¹ in MaxPar water.",
      "op": "manipulate",
      "outputs": [
        "e19"
      ],
      "params": {
        "diluent": "MaxPar water",
        "target_concentration": "0.8–1.2 ×10⁶ cells ml⁻¹"
      }
    },
    {
      "id": "s45",
      "inputs": [
        "e31"
      ],
      "notes": "Add EQ beads to the cell suspension at a volumetric ratio of 1:5.",
      "op": "transfer",
      "outputs": [
        "e19"
      ],
      "params": {
        "ratio": "1:5",
        "target": "cell suspension"
      }
    },
    {
      "id": "s46",
      "inputs": [
        "e32"
      ],
      "notes": "Add EDTA to the cells to a final concentration of 2 mM.",
      "op": "transfer",
      "outputs": [
        "e19"
      ],
      "params": {
        "final_concentration": "2 mM",
        "target": "cell suspension"
      }
    },
    {
      "id": "s47",
      "inputs": [
        "e34",
        "e30"
      ],
      "notes": "Set up the ‘Super Sampler’ (Victorian Airships) as per the manufacturer’s instructions, and set up acquisition parameters (e.g., antibody panel and experiment metadata) on the Helios mass cytometer.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "action": "set up Super Sampler and acquisition parameters"
      }
    },
    {
      "id": "s48",
      "inputs": [
        "e30"
      ],
      "notes": "Acquire events on the Helios mass cytometer using the Fluidigm CyTOF software. Aim for 100–400 events/s.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "action": "acquire events",
        "target_rate": "100–400 events/s"
      }
    },
    {
      "id": "s49",
      "inputs": [],
      "notes": "After acquisition, process the raw data with the Fluidigm CyTOF software (signal normalization, removal of EQ beads, concatenation if needed) and export data as FCS file(s).",
      "op": "observe",
      "outputs": [],
      "params": {
        "action": "process raw data and export FCS",
        "software": "Fluidigm CyTOF software"
      }
    },
    {
      "id": "s50",
      "inputs": [],
      "notes": "Debarcode multiplexed FCS file(s) into separate experimental conditions using the MATLAB program Zunder Lab Single Cell Debarcoder with user‑defined TOBis barcode keys.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "action": "debarcode FCS files",
        "software": "MATLAB Zunder Lab Single Cell Debarcoder"
      }
    },
    {
      "id": "s51",
      "inputs": [],
      "notes": "Download CyGNAL v0.2.1 from GitHub (https://github.com/TAPE-Lab/CyGNAL/releases/tag/v0.2.1) and open a terminal session from the repository folder.",
      "op": "annotate",
      "outputs": [],
      "params": {}
    },
    {
      "id": "s52",
      "inputs": [],
      "notes": "Set up the computing environment (recommended Conda) by running the provided commands.",
      "op": "annotate",
      "outputs": [],
      "params": {
        "commands": [
          "conda env create -f conda_env.yml",
          "conda activate cygnal"
        ]
      }
    },
    {
      "id": "s53",
      "inputs": [],
      "notes": "Import debarcoded FCS files to the Cytobank platform or an equivalent FCS processing software.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "action": "import debarcoded FCS files",
        "software": "Cytobank or equivalent"
      }
    },
    {
      "id": "s54",
      "inputs": [],
      "notes": "Perform Gaussian gating to remove debris.",
      "op": "observe",
      "outputs": [],
      "params": {
        "action": "Gaussian gating to remove debris"
      }
    },
    {
      "id": "s55",
      "inputs": [],
      "notes": "Perform DNA/cisplatin gating to identify cells.",
      "op": "observe",
      "outputs": [],
      "params": {
        "action": "DNA/cisplatin gating to identify cells"
      }
    },
    {
      "id": "s56",
      "inputs": [],
      "notes": "Perform cell‑type gating to exclude doublets (cells positive for mutually exclusive cell‑type markers).",
      "op": "observe",
      "outputs": [],
      "params": {
        "action": "cell‑type gating to exclude doublets"
      }
    },
    {
      "id": "s57",
      "inputs": [],
      "notes": "Export the dataset as FCS files for downstream analysis.",
      "op": "observe",
      "outputs": [],
      "params": {
        "action": "export dataset as FCS"
      }
    },
    {
      "id": "s58",
      "inputs": [],
      "notes": "Copy the cell‑comprised FCS file(s) to the Raw_Data folder, run python code/1-data_preprocess.py and follow the prompts. This generates preprocessed datasets and panel_markers.csv.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "1-data_preprocess.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s59",
      "inputs": [],
      "notes": "Copy CyGNAL‑processed dataset(s) and panel_markers.csv to Analysis/UMAP_input/, label markers for UMAP with ‘Y’, and run python code/2-umap.py.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "2-umap.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s60",
      "inputs": [],
      "notes": "Copy UMAP output to Analysis/Vis_Heatmap/ and run python code/5v1-heatmap.py for interactive heatmap visualization.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "5v1-heatmap.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s61",
      "inputs": [],
      "notes": "Copy UMAP output to Analysis/Vis_PCA/ and run python code/5v2-pca.py for PCA visualization.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "5v2-pca.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s62",
      "inputs": [],
      "notes": "Copy CyGNAL‑processed, cell‑type‑specific dataset(s) and panel_markers.csv to Analysis/EMD_input/ or Analysis/DREMI_input/, label markers with ‘Y’, and run the appropriate script (3-emd.py or 4-dremi.py).",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "3-emd.py or 4-dremi.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s63",
      "inputs": [],
      "notes": "Copy EMD/DREMI output to Analysis/Vis_Heatmap/ and run python code/5v1-heatmap.py to visualize scores as heatmaps.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "5v1-heatmap.py",
        "software": "CyGNAL"
      }
    },
    {
      "id": "s64",
      "inputs": [],
      "notes": "Copy EMD/DREMI output to Analysis/Vis_PCA/ and run python code/5v2-pca.py to visualize scores via PCA.",
      "op": "run_device",
      "outputs": [],
      "params": {
        "script": "5v2-pca.py",
        "software": "CyGNAL"
      }
    }
  ]
}

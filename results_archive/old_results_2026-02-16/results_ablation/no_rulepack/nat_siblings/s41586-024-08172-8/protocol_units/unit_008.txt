We computed 3,000 highly variable features in a batch‑aware manner using the scanpy highly_variable_genes function (flavor = ‘seurat_v3’, batch_key = ‘bio_sample’). We used these 3,000 features to compute a 50‑dimensional representation of the data using principal component analysis (PCA), which in turn we used to compute a k‑nearest‑neighbour (kNN) graph (n_neighbors = 30, metric = ‘cosine’).

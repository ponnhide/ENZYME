With the primary reference27 and query (HNOCA) data projected to the same latent space, an unweighted bipartite kNN graph was constructed by identifying 100 nearest neighbours of each query cell in the reference. The square of Jaccard index was then assigned as the weight of the edge, exp(4 × (prolif_score − apoptosis_score)) edge, to get the bipartite weighted kNN graph.

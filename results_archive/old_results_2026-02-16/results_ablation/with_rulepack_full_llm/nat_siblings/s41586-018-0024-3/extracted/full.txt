Article https://doi.org/10.1038/s41586-018-0024-3


Intra-tumour diversification in
colorectal cancer at the single-cell level
Sophie F. Roerink1,13, Nobuo Sasaki2,11,13, Henry Lee-Six1,13, Matthew D. Young1, Ludmil B. Alexandrov3,4,5, Sam Behjati1,6,
Thomas J. Mitchell1,7, Sebastian Grossmann1, Howard Lightfoot1, David A. Egan8,12, Apollo Pronk9, Niels Smakman9,
Joost van Gorp10, Elizabeth Anderson1, Stephen J. Gamble1, Chris Alder1, Marc van de Wetering2, Peter J. Campbell1,
Michael R. Stratton1* & Hans Clevers2*


 Every cancer originates from a single cell. During expansion of the neoplastic cell population, individual cells acquire
 genetic and phenotypic differences from each other. Here, to investigate the nature and extent of intra-tumour
 diversification, we characterized organoids derived from multiple single cells from three colorectal cancers as well as
 from adjacent normal intestinal crypts. Colorectal cancer cells showed extensive mutational diversification and carried
 several times more somatic mutations than normal colorectal cells. Most mutations were acquired during the final
 dominant clonal expansion of the cancer and resulted from mutational processes that are absent from normal colorectal
 cells. Intra-tumour diversification of DNA methylation and transcriptome states also occurred; these alterations were
 cell-autonomous, stable, and followed the phylogenetic tree of each cancer. There were marked differences in responses
 to anticancer drugs between even closely related cells of the same tumour. The results indicate that colorectal cancer
 cells experience substantial increases in somatic mutation rate compared to normal colorectal cells, and that genetic
 diversification of each cancer is accompanied by pervasive, stable and inherited differences in the biological states of
 individual cancer cells.


Recent studies have explored genetic diversification within cancer of clonal organoids from normal and neoplastic colorectal stem cells,
cell populations by identifying mutations shared by subpopulations and we use this strategy here to compare single cells from normal and
of cells within the cancer clone1–6. In principle, however, the extent neoplastic colorectal epithelium21–24.
of intra-tumour genetic diversity is most comprehensively revealed Comparison of the number of mutations in single cancer cell
by single-cancer-cell DNA sequencing, which can potentially iden- genomes with that in individual normal cells from the same tissue may
tify all mutations, including those that arose in the distant past, those also reveal whether alterations in somatic mutation rate and mutational
that occurred very recently, and those not present in any other cell7,8. process have been experienced by neoplastic cells. Substantial increases
Despite recent advances, however, single-cell genome sequencing in mutation rate are known to occur during the development of cancers
remains dependent on prior whole-genome amplification, which is with DNA mismatch repair deficiency or mutations in genes encoding
associated with incomplete genome coverage and artefactual muta- DNA polymerases25. Whether mutation rate increases are common
tions9. Diversification of epigenomic, transcriptomic, proteomic and in cancers without these specific abnormalities is, however, currently
metabolic states, and of functional states such as resistance to antican- unknown and a matter of controversy26–30.
cer therapy, may also occur during expansion of the neoplastic cell
population10–13. Methylation, gene expression and drug response data Clonal organoid derivation
have previously been obtained from multiple cells from individual Colorectal cancers from three previously untreated individuals (P1,
tumours, but the collection of all these features together with accurate P2 and P3) were each dissected into 4–6 pieces (Extended Data Fig. 1).
genome information from the same single cells has not been reported, Organoid cultures were derived from cell suspensions made separately
to our knowledge14–19. The origins of epigenomic and transcriptomic from each piece and were maintained for up to one week without pasdiversification are unclear, and there is little insight into whether these sage. Subsequently, individual organoids were disaggregated and floware transient or stable. sorted to obtain single cells from which clonal cancer organoids were
 One experimental approach that enables comprehensive, systematic established. For each individual, organoids were also derived from
and integrated exploration of intra-tumour diversification is to derive single crypts in normal colorectal epithelium from the same resection
immortal cell lines from multiple single cells from the same cancer20. specimens. A crypt derives from a single stem cell that has been esti-
These serve as proxies for the single cells from which they originate and mated to exist several months before crypt isolation24,31.
can be subjected to extensive and multimodal characterization, thereby The coding regions of 360 known cancer genes were sequenced in
revealing all aspects of intra-tumour diversification retained during all normal and cancer-derived clonal organoids for likely driver mutain vitro growth. We have recently developed protocols for derivation tions and a subset were whole-genome sequenced. Somatic mutations

1
 Cancer Ageing and Somatic Mutations Programme, Wellcome Trust Sanger Insitute, Hinxton, UK. 2Hubrecht Institute, University Medical Center Utrecht and Princess Maxima Center, Utrecht, The
Netherlands. 3Department of Cellular and Molecular Medicine, University of California, San Diego, La Jolla, CA, USA. 4Department of Bioengineering, University of California, San Diego, La Jolla, CA,
USA. 5Moores Cancer Center, University of California, San Diego, La Jolla, CA, USA. 6Department of Paediatrics, University of Cambridge, Cambridge, UK. 7Academic Urology Group, Department
of Surgery, Addenbrooke’s Hospitals NHS Foundation Trust, University of Cambridge, Cambridge, UK. 8Cell Screening Core, Department of Cell Biology, Center for Molecular Medicine, University
Medical Centre Utrecht, Utrecht, The Netherlands. 9Department of Surgery, Diakonessenhuis, Utrecht, The Netherlands. 10Department of Pathology, Diakonessenhuis, Utrecht, The Netherlands.
11
 Present address: Department of Gastroenterology, Keio University School of Medicine, Tokyo, Japan. 12Present address: Core Life Analytics, Utrecht, The Netherlands. 13These authors
contributed equally: Sophie F. Roerink, Nobuo Sasaki, Henry Lee-Six. *e-mail: mrs@sanger.ac.uk; h.clevers@hubrecht.eu


 2 6 A P RIL 2 0 1 8 | V O L 5 5 6 | N A T U RE | 4 5 7
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article

 Patient 1 Patient 2 Patient 3

 T2
 T3 T1
 N N T1 T4
 T2
 T4 N T3


 T4 T5 T5
 T4 T9
 T9
 T2 T6 T2
 y T1 z
 x x 1,000 mutations

 Homozygous ACVR2A APC K311fs*25 KRAS A146T
 K437fs*5 APC S1321fa*3 APC H427fs*1
 PIK3CA E81K APC L1488fs*41
 Homozygous TP53 ess. splice site
 BRAF V600E WGD


 N.1
 N.2
 N.3
 N.4


 N.2
 MLH1 hypermethylation


 N.1

 N.4
 N.1
 N.3
 N.4


 N.3
 N.2


 N.2_subclone
 4,000 mutations

 Homozygous TP53
 N235_Y236delNY
 PTEN W111* RNF43 G659fs*41
 PTEN R335* RNF43 225fs*194


 T3.1
 T3.3

 T4.1
 T4.5
 T4.4
 T4.2
 T4.3
 T2.3


 T2.2
 T2.4


 T4.1


 T3.5
 T2.1


 T3.4
 T1.5


 T1.2
 T.1.4


 T5.4


 T3.2
 T2.5

 T5.1


 T1.5


 T2.1
 T5.2
 T5.5


 T4.3


 T2.3
 T2.4
 T2.5
 T2.2
 T6.1
 T6.3
 T6.4
 T6.5


 T1.1
 T6.6


 T4.2


 T1.3
 T1.4
 T1.2
 T1.1
 T1.3


 Clone that has undergone WGS
 Clone that has undergone targeted sequencing
 T6.2


 Signature 1
 Signature 5
 T1.5


 T4.2
 T1.3


 Signature 17
 T3.5


 T3.4
 T3.1
 T1.2


 T6.2subclone


 Signature 18
 T2.1
 T2.2


 Signature 6
 T1.1


 T1.4


 T3.3
 T3.2


 Signature 20
 T4.1


 T4.5


 Signature 26
 New signature
 T4.4
 T4.3


 T2.3
 T2.5


 Indels
 Rearrangements
 T2.4


Fig. 1 | Mutation patterns during colorectal cancer evolution. cells. Organoids underwent whole-genome sequencing (circles) or
Multiregion sampling of each colorectal cancer is illustrated by coloured targeted cancer gene panel sequencing (triangles). The lengths of branches
labels (T) and normal tissue sampling by white labels (N). Phylogenetic are proportional to mutation numbers and each mutation type and
trees from three individuals have been constructed using somatic mutation signature is indicated by a different colour. Driver mutations and
mutations in clonal colorectal organoids derived from normal and cancer a whole genome duplication (WGD) are indicated in the phylogenetic tree.

were identified by comparison with the sequences of DNA extracted in clonal organoids derived from normal colon epithelium from the
from pieces of normal colorectal tissue. The overwhelming majority three patients.
of somatic mutations identified in this way are likely to have occurred
in vivo and not during in vitro culture (Extended Data Fig. 2c). Clonal Mutation load in normal and cancer cells
organoids were also subjected to analysis of DNA methylation state at A mean of 3,792 base substitutions was found in normal organoid
470,000 CpG sites, RNA sequencing (RNA-seq), and were assessed for clones derived from P1, 3,172 from P2 and 3,621 from P3 (Fig. 2),
response to several anticancer therapeutics. as previously reported24. The mean number of base substitutions in
 cancer-derived clones was higher in all three individuals: 72,398 in P1,
Phylogenetic trees of somatic mutations 22,291 in P2 and 14,209 in P3. There were also substantial differences in
Using the catalogues of somatic mutations from clonal organoids, the number of small indels and genome rearrangements. A mean of 227
we derived cell phylogenetic trees for each individual (Fig. 1a–c and small indels was observed in clones derived from normal colorectal epi-
Extended Data Figs. 3–6). The structures of the trees generally reca- thelium from P1, 130 from P2 and 167 from P3. By comparison, the mean
pitulated the geographic origins of the clonal organoids within each number of indels was 27,893 in cancer clones from P1, 1,485 from P2
cancer, with more closely related branches originating from the same and 2,021 from P3. There was a mean of one genome rearrangement in
tumour pieces. However, organoids within each piece continued to clonal organoids derived from normal colorectal epithelial cells contrastexhibit extensive genetic diversification: for example, in organoid clones ing with means in cancer-derived clonal organoids of 71 rearrangements
isolated from tumour section P3.T3, at least 40% of mutations were from P1, 176 from P2 and 67 from P3. As the normal and cancer clones
not shared with other clones from this piece (Extended Data Fig. 1o). are derived from cells obtained from each individual at the same times,
 In the trunk of the cancer cell phylogenetic tree of P1, we identi- increases in somatic base substitution, small indel and genome rearfied likely driver mutations in BRAF (V600E), PIK3CA (E81K) and rangement mutation rates are likely to have occurred in the lineages from
ACVR2A (protein-truncating small indel). All cancer clones from this fertilized egg to cancer cell, including in the two cancers that were proindividual also showed microsatellite instability characteristic of DNA ficient in DNA mismatch repair. Most of the additional mutation loads
mismatch repair deficiency and hypermethylation of the MLH1 pro- in cancer cells were acquired in the branches of the cancer phylogenetic
moter (the likely cause of this instability) (Extended Data Fig. 7). In tree rather than the trunk and therefore occurred following the last
addition, there were likely driver truncating mutations in PTEN and dominant clonal expansion within the cancer cell population.
RNF43 that were restricted to subsets of branches of the tree. In P2,
two protein-truncating APC mutations and a homozygous splice site Mutational signatures
TP53 mutation were present in the cancer trunk. In P3, a KRAS muta- We extracted mutational signatures and estimated the contributions of
tion (A146T) and two truncating APC mutations were present in the each signature to each segment of the phylogenetic trees. Eight base subcancer trunk, and a TP53 in-frame deletion was present in a subset of stitution mutational signatures were found (referred to according to the
the branches. No driver mutations or MLH1 methylation were observed nomenclature in COSMIC http://cancer.sanger.ac.uk/cosmic/signatures).

4 5 8 | N A T U RE | V O L 5 5 6 | 2 6 A P RIL 2 0 1 8
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH

 P1 P1 P2 P2 P3 P3 a b P3 TP53 mutant
 normal tumour normal tumour normal tumour P2 tumour 40
 a 10 P1 PTEN deletion
 P1 tumour


 PC2 POV 15.1%


 PC2 POV 13.3%
 Signature 1 Signature 6 P1 P2 P3 20
 Signature 5 Signature 20 0 normal
 75,000
 Signature 17 Signature 26 P1 RNF43 fs
 P1 normal
 Signature 18 New signature 0 P3 TP53 WT
 P3 TP53 WT P1 tumour


 Subs
 −10
 50,000 P2 normal P1 P2 P3
 P2 tumour −20 normal P2 tumour
 P3 TP53 mutant
 −20 P3 normal
 25,000 P3 tumour
 −40
 −40 −20 0 20 −25 0 25
 0 PC1 POV 71.4% PC1 POV 18.9%
 b c
 Deletion
 Insertion
Number of mutations


 30,000


 20,000


 Methylation trees
 Indels
 10,000


 0
 c Inversion
 200
 Deletion
 Tandem duplication


 Structural variants
 150 Translocation SPR = 5 SPR = 5 SPR = 3

 100


 50 Mutation trees

 0
 P1.N.1
 P1.N.2
 P1.N.3
 P1.N.4

 P1.T1.1
 P1.T1.4
 P1.T2.4
 P1.T3.2
 P1.T3.3
 P1.T4.3
 P1.T4.4

 P2.N.1
 P2.N.2
 P2.N.2_subclone
 P2.N.3
 P2.N.4

 P2.T1.1
 P2.T1.3
 P2.T2.5
 P2.T4.2
 P2.T4.3
 P2.T5.1
 P2.T5.4
 P2.T6.2
 P2.T6.2_subclone
 P2.T6.6

 P3.N.1
 P3.N.2
 P3.N.3
 P3.N.4

 P3.T1.1
 P3.T1.4
 P3.T2.1
 P3.T2.2
 P3.T3.2
 P3.T3.4
 P3.T4.1
 P3.T4.2


 Sample ID
 Fig. 2 | Total mutation burden in normal colorectal and colorectal SPR = 5 SPR = 6 SPR = 4
 cancer cells from three individuals. a, Substitutions have been further
 Expression trees


 subdivided by contributions of mutational signatures. b, Indels have been
 subclassified as short insertions and deletions. c, Structural variations
 have been subdivided into deletions, inversions, tandem duplications and
 translocations.

 These include the previously described signatures 1, 5, 6, 17, 18, 20
 and 26 and a signature that has not been previously encountered32
 (see also Supplementary Notes section 5). Each mutational signa- Fig. 3 | Diversification of methylation and transcriptome state during
 ture can be regarded as the outcome of a mutational process, which expansion of the neoplastic cell population. a, Clustering analysis of
 includes components of DNA damage or modification, DNA repair methylation state in each clonal organoid using 450 K Infinum arrays
 (or absence of it) and DNA replication, with each component poten- (n = 70 clones). PC, principal component; POV, percentage of variance.
 b, Clustering analysis of transcriptome state in each clonal organoid using
 tially influencing the profile of the signature. Signature 1 is likely to
 RNA-seq (n = 73 clones). c. Phylogenetic trees based on methylation data
 result from deamination of 5-methylcytosine to thymine and has (top), mutation data (middle) and expression data (bottom). Distances
 been reported to act in a ‘clock-like’ manner, with mutations accu- between mutation tree and methylation or expression tree topologies are
 mulated continuously over the lifetime of an individual at differ- expressed as subtree prune and regraft distance (SPR).
 ent rates in different tissues. The number of signature 1 mutations
 is proposed to correlate with the number of mitotic divisions33.
 Signature 5 is of uncertain origin and also shows accumulation of A different pattern of signature contributions was seen in the
 mutations in a clock-like manner, with different rates in different tis- branches of the three cancer phylogenetic trees (Fig. 1). In P1, the
 sues, although the rates do not correlate with those of signature 133. mutations were predominantly of signatures 6, 20, 26 and indels; in
 Signatures 1 and 5 are found in most human cancers and probably P2, signatures 5, 17, 18, and indels; and in P3, signatures 5, 18, indels
 in most normal cells24,33. and a new signature predominantly characterized by T > G, T > A and
 Signature 1 dominated and, with signature 5, accounted for the T > C mutations at NTA and NTT trinucleotides (the mutated base is
 large majority of mutations in normal colorectal stem cells24 (Fig. 1). underlined; Extended Data Fig. 2d). The last signature occurred in all
 Signature 1 also dominated in the trunks of the cancer phylogenetic clones carrying a small in-frame deletion in TP53, but its relationship
 trees, presumably reflecting, at least in part, the long segment of to this putative driver mutation is unknown. With regard to structural
 normal cell lineage from the fertilized egg to the cell in which the changes, P1 cancer clones carried deletions, inversions and tandem
 first cancer driver mutation was acquired. However, in each of the duplications, but few translocations, and their copy number profiles
 three cancer trunks, signatures 17 and/or 18 also showed contribu- were relatively flat (Fig. 1 and Extended Data Figs. 5, 6). P2 cancer
 tions (which were not detectable in the normal clonal organoids). clones carried all types of rearrangement accompanied by changes in
 Signatures 17 and 18 have been found in many cancer types and have copy number profiles. In P3, TP53 mutant clones carried abundant
 uncertain mechanisms, although signature 18 may be related to DNA rearrangements of all types resulting in aberrant copy number states,
 damage induced by reactive oxygen species and/or by deficiency of whereas rearrangements were approximately tenfold less common in
 base excision repair. TP53 wild-type clones with few copy number changes. The numbers of

 2 6 A P RIL 2 0 1 8 | V O L 5 5 6 | N A T U RE | 4 5 9
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article

 Patient 1 Patient 2 Patient 3
 ACVR2A
 PIK3CA E81K APC KRAS A146T
 BRAF V600E TP53 APC
 MLH1 hypermethylation TP53


 PTEN RNF43


 P1.T1.1
 P1.T1.2
 P1.T1.3
 P1.T1.4
 P1.T3.1
 P1.T3.2
 P1.T3.5
 P1.T3.3
 P1.T4.2
 P1.T4.3
 P1.T4.4
 P1.T4.5
 P1.T2.1
 P1.T2.3
 P1.T2.4
 P1.T2.5
 P1.T2.2

 P2.T1.1
 P2.T1.4
 P2.T1.5
 P2.T1.3
 P2.T5.2
 P2.T5.5
 P2.T6.1
 P2.T6.6
 P2.T6.4
 P2.T6.3
 P2.T6.2
 P2.T2.1
 P2.T2.5
 P2.T2.4
 P2.T2.2
 P2.T2.3
 P2.T5.1
 P2.T5.4
 P2.T4.1
 P2.T4.2
 P2.T4.3


 P3.T1.1
 P3.T1.5
 P3.T1.2
 P3.T1.3
 P3.T1.4
 P3.T2.1
 P3.T2.4
 P3.T2.2
 P3.T2.3
 P3.T2.5
 P3.T3.4
 P3.T3.1
 P3.T3.2
 P3.T3.5
 P3.T3.3
 P3.T4.1
 P3.T4.4
 P3.T4.2
 P3.T4.3
 Doxo
 SN-38
 5-FU
 Afatinib
 AKT
 MEK
 Nutlin
 Clone that has undergone WGS Clone that has undergone targeted sequencing
 0 Survival (%) 100

Fig. 4 | Individual clones show diverse responses to drugs commonly of irinotecan), 5-FU, afatinib (an EGFR inhibitor), AKT inhibitor VIII
used in colorectal cancer treatment. Phylogenetic trees show the (AKT), MEK1/2 inhibitor III (MEK) and nutlin-3a (nutlin; a stabilizer
genetic structure of each tumour, with branch lengths representing of TP53). Concentrations displayed represent intra- and inter-individual
mutation numbers. Coloured labels correspond to individual tumour variation in the response to each drug; full dose response ranges are shown
segments as in Fig. 1. Mean survival in two independent experiments is in Extended Data Fig. 10a.
displayed for exposure to doxorubicin (doxo), SN-38 (active metabolite


mutations of several signatures differed markedly between individual and Extended Data Fig. 8a). Clonal organoids from each colorectal
branches, indicating varying contributions of mutational processes in cancer clustered together, with the exception of the two TP53 wild-type
different parts of the cancer. clones of P3, but separately from those derived from the other cancers
 There were more signature 1 mutations in each cancer organoid than and from normal organoids. Thus, the methylation states of normal
in normal organoids from the same individuals (Fig. 1 and Extended colorectal stem cells from different individuals were relatively similar,
Data Fig. 2e). Assuming that the clock-like correlation between the but tumours from different individuals had developed divergent epigenumber of signature 1 mutations and number of mitoses undergone netic states. For the P1 tumour, this conformed to the pattern of global
in normal cells is maintained at the same rate during neoplastic cell hypermethylation previously termed CpG island methylator phenoproliferation, we estimate that cancer cells from individual P1 have type (CIMP)25. To investigate intra-tumour diversification of transcripundergone 1.9 (± 0.5) (s.d.) times as many mitoses as normal cells, tome state, we performed RNA-seq of normal colorectal epithelium
cancer cells from individual P2 2.5 (± 0.2) times as many, and from and cancer-derived organoid clones. Clustering by gene expression
individual P3 1.7 (± 0.2) times as many. An alternative explanation for profiles correlated well with clustering by methylation, with normal
the increase in signature 1 mutations in cancer cells is increased DNA organoids from all individuals clustering together, while separate clusmethylation in cancer cells. However, cancer organoids were generally ters existed for each cancer (Fig. 3b and Extended Data Fig. 9a). For
hypomethylated compared to normal cells (Extended Data Fig. 8b). In each cancer we constructed phylogenetic trees based on methylation
the distal branches of the phylogenetic trees (that is, during the most and gene expression (Fig. 3c). The topologies of the methylation and
recent phases of cancer growth) the base substitution mutation rates per expression trees were remarkably similar to the mutation-based trees.
mitosis (as estimated by the total number of mutations divided by the Thus, diversification of methylation and transcriptome state occurred
number of signature 1 mutations) were markedly increased compared within each cancer and this was apparently heritable, stable and indeto normal cells (estimated 100-fold in P1, which is DNA mismatch- pendent of the tumour microenvironment, as it persisted after organoid
repair deficient, and tenfold in P2 and P3, which are mismatch-repair culture in vitro.
proficient). Thus, assuming that these estimates of past mitoses undergone are correct, the increases in base substitution, indel and genome Diversification of drug responses
rearrangement mutation rates over time also represent increases in The clonal cancer organoids were exposed in vitro to a set of drugs used
mutation rates per mitosis. to treat colorectal cancer, including the chemotherapeutic agents 5-
 fluorouracil (5-FU), doxorubicin and 7-ethyl-10-hydroxycamptothecin
Methylome and transcriptome (SN-38, the active metabolite of irinotecan), and the targeted agents
Epigenetic changes may be part of, and contribute to, the biological afatinib (an epidermal growth factor receptor (EGFR) inhibitor),
diversification of intra-tumour cell populations. To explore this possi- nutlin-3a (a stabilizer of TP53), a MEK1/2 inhibitor and an AKT inhibitor.
bility, we examined the methylation status of 470,000 CpG sites in the Different organoids from the same cancer displayed substantial and
normal and tumour-derived clonal organoids. Organoids derived from reproducible differences in IC50 values of up to 1,000-fold (Fig. 4 and
normal stem cells from P1, P2 and P3 clustered together in principal Extended Data Fig. 10a, b), for both chemotherapeutic agents and
component analyses, albeit with normal clones from each individual targeted therapies. Some differences were attributable to particular
closer to each other than to normal clones from other individuals (Fig. 3 somatic mutations. Notably, nutlin-3a exerted much greater growth

4 6 0 | N A T U RE | V O L 5 5 6 | 2 6 A P RIL 2 0 1 8
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH

inhibition of TP53 wild-type than mutant clones in P3 tumour orga- Online content
noids. Additionally, truncating mutations in RNF43, a recessive Any Methods, including any statements of data availability and Nature Research
cancer gene encoding a negative regulator of the WNT pathway34, reporting summaries, along with any additional references and Source Data files,
rendered cells highly sensitive to the WNT secretion/porcupine are available in the online version of the paper at https://doi.org/10.1038/s41586-
 018-0024-3.
inhibitor IWP2 (Extended Data Fig. 10c). The remaining variation
in drug response did not, however, clearly relate to the geographical Received: 26 January 2017; Accepted: 5 March 2018;
zones of origin or to the phylogenetic trees of each cancer. There were Published online 11 April 2018.
several examples of marked differences in drug sensitivity between
closely related clones. For example, P2.T4.1 showed marked resist- 1. Gerlinger, M. et al. Intratumor heterogeneity and branched evolution revealed
ance to SN-38 compared to the other P2.T4 clones, whereas P3.T1.5 by multiregion sequencing. N. Engl. J. Med. 366, 883–892 (2012).
 2. de Bruin, E. C. et al. Spatial and temporal diversity in genomic instability
showed distinct sensitivity to 5-FU compared to all other clones from processes defines lung cancer evolution. Science 346, 251–256 (2014).
this individual (Fig. 4 and Extended Data Fig. 10a). The mechanism 3. Gundem, G. et al. The evolutionary history of lethal metastatic prostate cancer.
underlying this diversification in biological behaviour is unclear, Nature 520, 353–357 (2015).
but there was no obvious correlation with the degree of mutational 4. Sottoriva, A. et al. A Big Bang model of human colorectal tumor growth.
 Nat. Genet. 47, 209–216 (2015).
diversification. 5. Uchi, R. et al. Integrated multiregional analysis proposing a new model of
 colorectal cancer evolution. PLoS Genet. 12, e1005778 (2016).
Discussion 6. Suzuki, Y. et al. Multiregion ultra-deep sequencing reveals early intermixing and
 variable levels of intratumoral heterogeneity in colorectal cancer. Mol. Oncol. 11,
Previous studies have addressed particular aspects of intra-cancer 124–139 (2017).
diversification by profiling the transcriptome, DNA copy number state 7. Navin, N. E. The first five years of single-cell cancer genomics and beyond.
and functional responses of individual cells14–16,35. To our knowledge, Genome Res. 25, 1499–1507 (2015).
 8. Gawad, C., Koh, W. & Quake, S. R. Single-cell genome sequencing: current state
this is the first systematic and integrated analysis at genetic, epigenetic, of the science. Nat. Rev. Genet. 17, 175–188 (2016).
transcriptomic and functional levels of multiple single-cell-derived 9. Leung, M. L. et al. Single-cell DNA sequencing reveals a late-dissemination
clones from human cancers to incorporate high-quality and com- model in metastatic colorectal cancer. Genome Res. 27, 1287–1299 (2017).
 10. Brocks, D. et al. Intratumor DNA methylation heterogeneity reflects clonal
prehensive description of essentially all somatic mutations present in evolution in aggressive prostate cancer. Cell Reports 8, 798–806 (2014).
multiple single cells. All three cancers studied, including the two DNA 11. Oakes, C. C. et al. Evolution of DNA methylation is linked to genetic aberrations
mismatch-repair proficient cases, clearly exhibited higher mutation in chronic lymphocytic leukemia. Cancer Discov. 4, 348–361 (2014).
 12. Mazor, T. et al. DNA methylation and somatic mutations converge on the cell
burdens than normal colorectal stem cells. These are likely to result cycle and define similar evolutionary histories in brain tumors. Cancer Cell 28,
from increased mutation rates experienced during the lineages from 307–317 (2015).
fertilized egg to colorectal cancer cell. More comparisons of normal 13. Caiado, F., Silva-Santos, B. & Norell, H. Intra-tumour heterogeneity — going
and colorectal cancer cells, and similar comparisons for other classes of beyond genetics. FEBS J. 283, 2245–2258 (2016).
 14. Stevens, M. M. et al. Drug sensitivity of single cancer cells is predicted by
cancer, are required for corroboration but it seems likely that increases changes in mass accumulation rate. Nat. Biotechnol. 34, 1161–1167 (2016).
in somatic mutation rates are common during the development of 15. Dubach, J. M. et al. Quantitating drug–target engagement in single cells in vitro
human cancers. These increases are predominantly due to recruit- and in vivo. Nat. Chem. Biol. 13, 168–173 (2017).
 16. Tirosh, I. et al. Single-cell RNA-seq supports a developmental hierarchy in
ment of mutational processes that are inactive or marginally active in human oligodendroglioma. Nature 539, 309–313 (2016).
normal cells, and which dominate at later stages in the evolution of 17. Macaulay, I. C. et al. G&T-seq: parallel sequencing of single-cell genomes and
the cancer cell population. The roles of these processes in generating transcriptomes. Nat. Methods 12, 519–522 (2015).
 18. Li, H. et al. Reference component analysis of single-cell transcriptomes
driver mutations, however, are unclear, as they may have started before elucidates cellular heterogeneity in human colorectal tumors. Nat. Genet. 49,
or after acquisition of the early driver mutations in the trunks of the 708–718 (2017).
cancer phylogenetic trees5. The mechanisms underlying the increases 19. Angermueller, C. et al. Parallel single-cell sequencing links transcriptional and
 epigenetic heterogeneity. Nat. Methods 13, 229–232 (2016).
in mutation rate in the DNA mismatch-repair proficient cancers are, 20. Meyer, M. et al. Single cell-derived clonal analysis of human glioblastoma
for the most part, unknown. These increases may be due to somatic links functional and genomic heterogeneity. Proc. Natl Acad. Sci. USA 112,
genetic or epigenetic changes (although these are not currently obvi- 851–856 (2015).
 21. van de Wetering, M. et al. Prospective derivation of a living organoid biobank of
ous), to metabolic stress attendant upon the elevated mitotic rate and colorectal cancer patients. Cell 161, 933–945 (2015).
other features of the neoplastic state, or to effects of the cancer cell 22. Sato, T. et al. Long-term expansion of epithelial organoids from human colon,
microenvironment. Alongside intra-tumour mutational diversifi- adenoma, adenocarcinoma, and Barrett’s epithelium. Gastroenterology 141,
cation, diversification of methylation state, transcriptome state and 1762–1772 (2011).
 23. Behjati, S. et al. Genome sequencing of normal cells reveals developmental
biological responses to therapeutics occur. While some methylation lineages and mutational processes. Nature 513, 422–425 (2014).
and transcriptome changes that occurred in vivo may have been lost 24. Blokzijl, F. et al. Tissue-specific mutation accumulation in human adult stem
during in vitro growth we were able to capture methylation and tran- cells during life. Nature 538, 260–264 (2016).
 25. Cancer Genome Atlas Network. Comprehensive molecular characterization of
scriptome changes that followed the evolution of the cancer through human colon and rectal cancer. Nature 487, 330–337 (2012).
the mutational phylogenetic tree, which appeared to be stable and, at 26. Tomlinson, I. P., Novelli, M. R. & Bodmer, W. F. The mutation rate and cancer.
least partly, independent of the tumour cell microenvironment, as they Proc. Natl Acad. Sci. USA 93, 14800–14803 (1996).
 27. Loeb, L. A. Human cancers express a mutator phenotype: hypothesis, origin,
persisted after cells were removed from the tumour. Diversification and consequences. Cancer Res. 76, 2057–2059 (2016).
of methylation and transcriptome states and of drug responses are 28. Tomasetti, C. & Vogelstein, B. Variation in cancer risk among tissues can be
likely to result partly from driver mutations in cancer genes, but other, explained by the number of stem cell divisions. Science 347, 78–81 (2015).
 29. Navin, N. E. Cancer genomics: one cell at a time. Genome Biol. 15, 452 (2014).
currently unknown, genetic and/or epigenetic mechanisms may be 30. Sieber, O. M., Heinimann, K. & Tomlinson, I. P. M. Genomic instability—the
involved36. Future studies analysing the genomes, methylomes and engine of tumorigenesis? Nat. Rev. Cancer 3, 701–708 (2003).
transcriptomes of primary cells of a cancer will be needed to reveal all 31. Snippert, H. J. et al. Intestinal crypt homeostasis results from neutral competition
 between symmetrically dividing Lgr5 stem cells. Cell 143, 134–144 (2010).
genetic, epigenetic and transcriptional variation occurring between 32. Alexandrov, L. B. et al. Signatures of mutational processes in human cancer.
cancer cells in vivo. Nevertheless, this study has shown the strength Nature 500, 415–421 (2013).
of the organoid system in stably retaining these characteristics and 33. Alexandrov, L. B. et al. Clock-like mutational processes in human somatic cells.
enabling functional assays on clones derived from individual cells. Nat. Genet. 47, 1402–1407 (2015).
 34. Koo, B.-K. et al. Tumour suppressor RNF43 is a stem-cell E3 ligase that induces
The analysis indicates that all three colorectal cancers contained cells endocytosis of Wnt receptors. Nature 488, 665–669 (2012).
resistant to most of the drugs commonly used to treat the disease. 35. Dalerba, P. et al. Single-cell dissection of transcriptional heterogeneity in human
Differential drug responses between clones that are closely related both colon tumors. Nat. Biotechnol. 29, 1120–1127 (2011).
 36. Landau, D. A. et al. Locally disordered methylation forms the basis of
genetically and epigenetically suggest that resistance mechanisms can intratumor methylome variation in chronic lymphocytic leukemia. Cancer Cell
arise late in tumorigenesis. 26, 813–825 (2014).

 2 6 A P RIL 2 0 1 8 | V O L 5 5 6 | N A T U RE | 4 6 1
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article

Acknowledgements We thank I. Martincorena, R. van Boxtel, J. Truszkowski, expression data. H.L., S.G. and P.J.C. contributed to statistical analyses. T.J.M.
H. Francies and M. Garnett for discussion of our findings. This work was performed phylogeny analysis from the tissue biopsies. S.B. and M.v.d.W.
supported by funding from the Wellcome Trust (098051), Stichting Vrienden contributed to the study design. S.F.R. generated the figures. M.R.S. and H.C.
van het Hubrecht and KWF (SU2C-AACR-DT1213 and HUBR KWF 2014-6917). directed the study. M.R.S. wrote the manuscript with contributions from all
Individual authors were supported as follows: S.F.R., Louis-Jeantet Foundation; authors.
N.S., JSPS Overseas Research Fellowships; H.L.-S., Wellcome Trust Nonclinical PhD Studentship; S.B., Wellcome Trust Intermediate Clinical Research Competing interests The authors declare no competing interests.
Fellowship and St. Baldrick’s Foundation Robert J. Arceci Innovation Award;
P.J.C., Wellcome Trust Senior Research Fellowship in Clinical Science. Additional information
 Extended data is available for this paper at https://doi.org/10.1038/s41586-
Reviewer information Nature thanks M. Lawrence and the other anonymous 018-0024-3.
reviewer(s) for their contribution to the peer review of this work. Supplementary information is available for this paper at https://doi.
 org/10.1038/s41586-018-0024-3.
Author contributions A.P., N.Sm. and J.v.G. provided the samples and Reprints and permissions information is available at http://www.nature.com/
pathology information. N.Sa. generated organoid cultures and performed drug reprints.
sensitivity assays. D.A.E. provided assistance with drug sensitivity assays. E.A., Correspondence and requests for materials should be addressed to M.R.S.
S.J.G. and C.A. provided technical assistance. S.F.R. and H.L.-S. analysed and or H.C.
interpreted the sequencing data. H.L.-S. derived phylogenies. L.B.A. performed Publisher’s note: Springer Nature remains neutral with regard to jurisdictional
signature analysis. S.F.R. and M.D.Y. analysed and interpreted methylation and claims in published maps and institutional affiliations.


4 6 2 | N A T U RE | V O L 5 5 6 | 2 6 A P RIL 2 0 1 8
 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH

Methods developed cancer gene panel (CGPv3) was used, designed to pull down 360 genes
Human tissues. Tissue material was obtained from The Diakonessen Hospital, that are known or suspected to play a role in cancer3,37. The panel targets genes
Utrecht. From the resected colon segment, both normal and tumour tissues were from the Cancer Gene Census (COSMIC), genes recurrently amplified or overisolated. The isolated tumour tissue was subdivided into 4–5 segments. Normal expressed in cancer and candidate cancer genes such as kinases from the MAP
tissue was taken at least 5 cm away from the tumour. All samples were obtained kinase signalling pathway. We performed custom RNA bait design following the
with informed consent and the study was approved by the ethical committee of manufacturer’s guidelines (SureSelect, Agilent) and previously described work-
The Diakonessen Hospital, Utrecht. flows to create pulldown libraries from native genomic DNA3,37. Samples were
 No statistical methods were used to predetermine sample size. The experiments multiplexed on flow cells and subjected to paired end sequencing (75-bp reads)
were not randomized and the investigators were not blinded to allocation during using Illumina HiSeq2000 machines, resulting in more than 700× coverage for
experiments and outcome assessment. the target design for tumour-derived samples and more than 2,000× coverage for
Human organoid culture. Human normal and tumour colon organoids were normal tissue-derived samples. Sequences were aligned to the human reference
established and maintained as described from isolated colonic epithelium21,22. genome (NCBI build37) using BWA-align.
In brief, long-term normal colonic organoid culture required human intestinal RNA sequencing. From each individual, RNA was isolated from all tumour
stem cell medium (HISM) composed of advanced DMEM/F12 (AdMEM) with and normal derived organoid clones and subjected to RNA-seq analysis. RNApenicillin/streptomycin, 10 mM HEPES, 1×GlutaMAX, 1×B27 (Invitrogen) and seq libraries were prepared according to previously described workflows and
1 µM N-acetylcysteine (SIGMA), supplemented with 50 ng ml−1 human recom- sequenced on Illumina HiSeq2000 machines38. Between four and seven barcoded
binant EGF (Peprotech), 0.5 µM A83-01 (Tocris), 3 µM SB202190 (SIGMA), 1 µM samples were pooled per library. Sequenced reads were aligned to the human refnicotinamide (SIGMA), 10 nM prostaglandin E2,Wnt3A-conditioned medium erence genome (NCBI build37) with Bowtie/TopHat.
(CM) (50% final concentration), Noggin-CM (10% final concentration), and Methylation arrays. Infinium HumanMethylation450 BeadChip arrays were used
R-Spondin1-CM (10% final concentration). Tumour organoids were cultured in to characterize the methylation status of more than 450,000 CpG sites for all clones.
medium containing only EGF, Noggin-CM, R-Spondin1-CM and A83-01. Mutation discovery. All somatic changes in whole genome and targeted data were
Establishment of clonal organoids. For clonal organoids from normal crypts, iso- analysed with mutation calling pipelines developed in house (available at https://
lated single crypts were embedded in 10 µl Matrigel and cultured in HISM medium. github.com/cancerit).
For clonal tumour organoid cultures, tumour cell suspensions were cultured for Substitutions. Single-base somatic substitutions were identified using CaVEMan39
7–14 days in HISM without Wnt3A-CM. Then, 10–15 individual organoids were and a number of post-processing filters were applied. For each patient, the only
picked and separately dissociated into single cells by TryPLE express (Thermo germline reference available was healthy colorectal tissue more than 5 cm from the
Fisher), washed and suspended in AdMEM containing propidium iodide (PI). tumour, consisting of epithelial and connective tissue. In order to allow the discov-
Forty-eight single cells were sorted into tumour organoid medium (HISM plus 10 ery of a field effect40,41 that might have spread into the matched normal sample,
μM ROCK inhibitor Y-27632 (Tocris BioScience); no Wnt-CM) from each tumour we ran CaVEMan using an unmatched normal reference. Germline SNPs were
organoid. Sorting was based on FCS area/FCS peak and PIneg/FCS area using a removed by comparison to a panel of 75 unrelated normal samples. Additional
Moflo machine (Beckman Coulter). Sorted cells were spun down at 1,000g at 4 °C post-processing filters were applied to these mutation calls as described42. For
for 5 min, after which single cells were each embedded into 10 µl of basement XTEN/BWA-mem aligned data we added two filters to the pipeline for the median
membrane extract (BME, Amsbio) and seeded into 96-well plates at a ratio of alignment score (ASMD) ≥ 140 and the clipping index (CLPM) = 0, meaning that
1 cell per well. The gel was left to solidify in a 37 °C incubator after HISM (no fewer than half of the reads should be clipped.
Wnt3A-CM) was added. Y-27632 was added to the medium for the first week after We then tabulated the number of mutant and wild-type reads for every mutation
sorting. For each original tumour organoid, a single clonal organoid was selected discovered in every sample, including the adjacent colorectal tissue. We considered
and expanded for further study and for preparing frozen stocks. Culturing times only mutations that were covered by ten reads in all related clones, and mutations
and plating efficiencies are listed for each organoid in Supplementary Datafile S1. that were seen on at least two reads in each direction. As the adjacent normal
Histology procedures. Tissues were fixed in 4% formaldehyde solution overnight colorectal tissue is not entirely composed of epithelium we reasoned that if there
and embedded in paraffin. Sections were subjected to haematoxylin and eosin were a field effect the somatic mutations in this tissue should not be fully clonal.
(H&E) and immunohistochemistry staining. The Ki67 antibody (MONX10283, We therefore deducted germline mutations on the basis that they were fully clonal
Monosan) was used at 1:250 dilution. in the bulk normal, while mutations that were subclonal in the bulk were not
Organoid CellTiter-Glo viability assay. Tumour organoids were cultured for 5–10 removed from the analysis. To define a mutation as subclonal in the bulk, the
days after being trypsinized into single cells in HISM without Wnt-3a-CM. The probability of finding the observed number of mutant reads or fewer given the
organoids were mechanically dissociated by pipetting before being resuspended sequencing coverage had to be less than 0.005, based on the binomial distribution
in 5% BME/growth medium (25 × 103 organoids per ml). Before seeding, 10 µl with a probability of 0.5 for autosomes. Mutations that failed to meet this criterion
BME was dispensed into 384-well plates, and then 30 µl growth medium containing were considered to be germline and were removed.
organoids was dispensed into each plate (at about 750 organoids per well. Drug Indels. Indels were called using Pindel43,44 using the adjacent bulk colorectal tissue
screening was carried out using nutlin-3a, afatinib, MEK1/2 inhibitor III, AKT as a matched normal. Post processing filters were the same as for substitutions
inhibitor VIII, 5-FU, doxorubicin, and SN-38. Drug dilutions were performed in except that ASMD ≥ 140 and CLPM = 0 were not used.
two series: 1) stepwise 2 fold-dilutions from 20 µM to 19.5 nM; and 2) stepwise 2 Copy number. Copy number profiles were constructed for WGS samples by
fold-dilutions from 15 µM to 29.3 nM. The measurements for these two dilution ASCAT45,46, using adjacent healthy colorectal tissue as a matched normal. Copy
series were combined into a single curve. All drugs were dispensed by a HP-D300 number profiles of WGS analysed samples were visualized with the plotHeatmap
automated liquid dispenser (TECAN). Samples were incubated for 6 days at 37 °C, function of the R package ‘copynumber’47.
and cell viability was measured by CellTiter-Glo 3D kit (Promega) on a SpectraMax Rearrangements. Rearrangements were called using healthy adjacent colorectal
M5e (Molecular Devices). Cell viability measurements were performed in duplicate tissue as a matched normal. Abnormally paired read pairs from WGS were grouped
wells for each clone. Survival ratios in drug-treated organoids were normalized and filtered by read remapping using ‘Brass’ (https://github.com/cancerit/BRASS).
to the average survival in a DMSO control. Each experiment was repeated on a Read pair clusters with 50% or more of the reads mapping to microbial sequences
different day. To assess variability between technical and biological replicates we were removed. Candidate breakpoints were matched to copy number breakpoints
calculated the area under the curve (AUC) for each survival curve. AUC values defined by ASCAT within 10 kb. Rearrangements not associated with copy number
are calculated using the trapezoid method and are divided by the area covered by breakpoints or with a copy number change of less than 0.3 were removed.
100% survival on the y-axis and the range of the log10 concentrations on the x-axis Phylogenetic tree construction. The phylogeny of single-cell-derived organoids for
(Extended Data Fig. 10b). each patient was constructed from substitutions called in WGS data. For each
DNA and RNA extraction. DNA and RNA were concomitantly extracted from patient, substitutions that had been discovered by CaVEMan in any organoid from
frozen tissue samples or organoid cultures using AllPrep DNA/RNA minikit that patient were called as present or absent in each organoid using the algorithm
(Qiagen 80204). Shearwater48. This algorithm compares allele frequencies of variants to a back-
Whole-genome sequencing. From each individual, 7–10 tumour-derived clones ground error model derived from sequencing thousands of samples from unrelated
were selected for whole-genome sequencing (WGS), as well as 4–5 normal-derived studies on the same platform. Sequencing errors are known to occur at different
clones. We generated paired end sequencing reads (150 bp) using Illumina XTEN frequencies across different sites of the genome48. By obtaining a comprehensive
machines, resulting in ± 30× coverage per sample. Sequences were aligned to the view of the number of variant calls at each position in unrelated normal genomes,
human reference genome (NCBI build37) using BWA-MEM. Sequencing statistics we built an error model for each nucleotide change for each position. This method
are listed in Supplementary Datafile S2. has previously been used to find variants at a low frequency49. Here, we com-
Cancer gene panel sequencing. All WGS sequenced clones and 40 additional pared the observed frequency of each variant to our error model. After correcting
tumour-derived clones were subjected to targeted sequencing. An in-house for multiple testing, only variants that were significantly mutated over the error


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article

model were kept, using a q value cutoff of 0.05. Although most true variants largely Second, we wanted to time substitutions in regions with a greater range of copy
exceed this threshold, this procedure maximizes the chance of retaining variants in number states for mutational signature analysis. To do this, for every truncal subgenomic regions that have undergone copy number changes, lowering the appar- stitution in every tumour clone from patient 2, the copy number segment (as called
ent variant allele fraction (VAF), since the Shearwater algorithm was designed to by ASCAT) in which that mutation fell was defined. Mutations could be timed only
detect subclonal variants. As a further stringent filter to minimise false positive in samples in which there was a minor copy number of 0 and a major copy number
calls, variants had to be supported by at least three mutant reads to be considered greater than 1. Fortunately, because of the extensive copy number changes in this
by the algorithm. In this way every mutation called in an individual was genotyped tumour, all mutations fell in a region that met these criteria in at least one sample.
as being present or absent in each sample. Phylogenies were constructed using this For a given mutation that fell in such a copy number segment in a given sample, the
binary matrix of mutations present or absent in each sample. Private mutations VAF in that sample of known germline single nucleotide polymorphisms (SNPs)
were discarded from tree building as they are uninformative. A fake outgroup that fell in that segment (that necessarily occurred before the WGD) and the VAF
with no mutations called was generated for each individual. Phylogenies were of somatic mutations assigned to branches further down the tree (that necessarily
constructed using the Phylip suite of tools50. The programme seqboot was used occurred after the WGD) was examined. If, in a given sample, a mutation had a
to generate 100 bootstrap replicates of each dataset by resampling the mutations VAF greater than 90% of the VAFs of the mutations that were known to occur
with replacement. Phylogenies were then reconstructed for each bootstrap replicate further down tree it was considered to have occurred before the WGD, whereas
by maximum parsimony using the Mix programme using the Wagner method, if it had a VAF less than 90% of the VAFs of the SNPs it was considered to have
using the fake outgroup as a root. The jumble = 10 option was used, randomizing occurred after the WGD. If there was any overlap between the 90th percentiles of
the order of the input samples 10 times for each bootstrap replicate. Finally, the the SNPs and the later mutations, or if the mutation fitted neither of these criteria,
programme Consense was used to build a consensus of all the trees that had been it was considered uninformative and was not used in the signature analysis. This
built for each patient, using the majority rule (extended) option. This reports, for accounted for 9,094 mutations (out of a total of 12,623 assigned to the trunk) that
each node in the most parsimonious tree, how many of the trees that had been built were not used in signature analysis. There is no reason to believe that mutations
contain a node that partitions the samples into the same two groups. All nodes in that were excluded for these reasons should be attributable to different mutational
each tree that relate tumour samples to each other were supported by all bootstrap signatures than those that could be included, and indeed their trinucleotide mutareplicates (Supplementary Notes). tion contexts are similar (data not shown). For each mutation, then, the number
Assignment of somatic changes in WGS to the phylogenetic tree. Substitutions. of samples in which it had been counted before and after the WGD was tallied. If
Substitutions were called as present or absent in each organoid as described above. a mutation was called as occurring before the WGD in some samples and after the
To assign these mutations to the tree, each branch of the tree was considered in WGD in others, the mutation was designated as conflicting and excluded from
turn. If a mutation was called in all the organoids that were descendants of a given the analysis. Eighty-two mutations fell into this category, and the remaining 3,447
branch, and in no organoids that were not descendants of the branch, muta- could be timed unambiguously relative to the WGD and used in the signature
tions were assigned to that branch. Ignoring private mutations, which necessarily analysis. In Fig. 1 we extrapolated the preWGD and postWGD fractions and their
fit any tree, 97.7% of shared mutations fitted the tree structure from patient 1 relative signature components to all mutations identified in the clonal trunk of P2.
perfectly, 89.7% fitted the tree from patient 2 perfectly, and 88.1% fitted the tree Mutations that were included in the signature analysis, those that were excluded
from patient 3 perfectly. The lower concordance with the tree for patients 2 and 3 as being uninformative, and those that were excluded as being conflicting, are
reflects the increased copy number changes that have occurred in these phylog- reported in Supplementary Datafile S4.
enies. Examination of the copy number state at loci where there were discordant Indels. For indels, we simply aimed to estimate the proportion that occurred before
mutations showed that the majority could be explained by deletions of those and after the WGD, and so for this analysis we restricted ourselves to regions of the
mutations in a subclone. Substitutions that did not fit the tree perfectly were genome with copy number 2 + 0. An analogous approach to timing substitutions
therefore assigned to the most recent common ancestor of the samples in which was taken, although rather than considering the distribution of germline indels
they were called. and indels further down the tree, a hard VAF cutoff of 0.85 (which separated the
 All substitution calls and their assignment to branches of the tree, as well as bimodal distribution of indel VAFs in these loci) was used to define mutations as
substitutions that did not fit the tree perfectly and their associated copy number occurring before or after the WGD.
states are listed in Supplementary Data file S4. Rearrangements. We timed rearrangements relative to the WGD in patient 2 by
Indels. Indels were called as being present or absent in each sample based on a using the copy number step associated with deletions and tandem duplications
variant allele fraction (the proportion of mutant reads at a locus) cutoff. The in the trunk of this tumour, as determined by inspection of the change in read
variant allele fraction cutoff was chosen for each patient based on a histogram of counts at breakpoints. The ratio of tandem duplications and deletions that had
the variant allele fraction to separate the sequencing noise distribution from the occurred before rather than after the WGD was extrapolated to give a ratio for all
distribution of true mutations. Variant allele fraction cutoffs were chosen as 0.15 the rearrangements in the trunk, assuming that the relative proportion of different
for patients 1 and 3, and 0.11 for patient 2. Indels were then assigned to branches rearrangement classes stayed the same after the WGD.
of the tree that they fitted perfectly. Indels that were assigned to the tree, along Driver mutations. Driver mutations in TP53 and APC were timed relative to the
with their assignments, as well as indels that did not fit the tree are provided in WGD in patient 2. The TP53 mutation was at VAF 1 in a region that was 2 + 0 in
Supplementary Data file S4. all samples, indicating that it occurred before the WGD. There were mutations in
Rearrangements. The same rearrangement may be called in related samples with both alleles (which we will call mutation 1 and mutation 2) of APC. P2.T4.2 and
slightly different breakpoints. To identify rearrangements that had been sequenced P2.T5.1 both had the APC locus called as 2 + 2, and both mutations were at VAF
in related clones as the same, both the upstream and the downstream breakpoints 0.5. P2.T1.1, P2.T1.3, and P2.T6.2 were 2 + 1 in the APC region. Mutation 1 was
had to fall within 500 bp of each other. The majority of rearrangements fitted the at VAF 0.67 and mutation 2 at 0.33. In P2.T2.5 the region was also called as 2 + 1,
tree. Visualization of discordant rearrangements using IGV51 showed that often an but mutation 1 was at VAF 0.33 and mutation 2 at VAF 0.67. This shows biallelic
overlapping rearrangement meant that the rearrangement was lost in a clone. All inactivation of APC before the WGD.
rearrangement calls that could and could not be assigned to the tree can be found Assignment of samples to the tree based on targeted sequencing. Samples for which
in Supplementary Data file S4. both WGS and targeted sequencing were available were used to estimate the sen-
Timing substitutions and indels relative to a whole genome duplication (WGD). A sitivity in the targeted data for finding substitutions that were identified in each
whole genome duplication was observed in the trunk of the tumour for patient 2. branch by the WGS data. The targeted capture was designed against 360 cancer
Substitutions. For substitutions, we aimed first to obtain an accurate estimate genes; in addition, all off-target reads that covered substitutions identified by WGS
of the timing of WGD in molecular time, and second to time as many substi- were considered. For example, in clone P1.T1.1, a fraction of 0.09 of all substitututions as possible relative to the WGD in order to perform signature analysis tions in the ultimate branch P1.T1.1 was found in the targeted data. Samples for
on them. which only targeted sequencing was available were then assigned to the ultimate
 To obtain an estimate of the timing of the WGD, we examined substitutions branch of the tree with which they shared most substitutions. For example, clone
in regions with two copies of one allele and none of the other (as determined by P1.T1.4 shared a fraction of 0.04 with branch P1.T1.1 and negligible fractions
ASCAT). In these regions, if a mutation occurred before the WGD on that allele, with other branches. To estimate the time point at which P1.T1.4 branched off, we
it will be at copy number 2. If it occurred afterwards, it will be at copy number 1. divided the shared fraction 0.04 in clone P1.T1.4 by the sensitivity in clone P1.T1.1
One hundred and eighty substitutions occurred at copy number 2, and 67 at copy 0.09. Thus, we estimated that P1.T1.4 shares 0.04/0.09 = 43% of mutations with
number 1. As at least half of the mutations that occurred before the WGD have branch P1.T1.1. The proportion of mutations shared with each branch are listed
been lost in such regions (as there is loss of one allele), the WGD can be estimated in Supplementary Notes section 2.
to have occurred at 84% ((180 × 2)/(180 × 2 + 67)) of molecular time in the trunk Driver analysis. To classify driver events in substitutions, indels and rearrangeof the tumour (95% confidence interval of 80.8–87.6% calculated by bootstrapping ments we used the following criteria: 1) deleterious mutations in genes iden-
10,000 times). tified in CRC by TCGA25; 2) all other known oncogenes carrying a canonical


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH

activating mutation; and 3) tumour suppressor genes with loss of function, and/ Custom R scripts developed for the analyses and visualizations in this manuor carrying two deleterious mutations. A more inclusive approach for identify- script are available from the authors on request.
ing functional mutations is listed in Supplementary Datafile S3 and described in Data access. Sequencing data have been deposited at the European Genomethe Supplementary Notes. Phenome Archive (http://www.ebi.ac.uk/ega/) under accession numbers
Mutational signature analysis. Signature extraction based on non-negative matrix EGAS00001000869 (targeted sequencing), EGAS00001000985 (RNA-seq) and
factorization was performed as previously described32,52. Mutations in trinucleotide EGAS00001000881 (WGS). RNA sequencing data of these organoid clones has
context were grouped according to branches of the phylogenetic tree or according also been described elsewhere60.
to sample. Datasets were combined with data from 560 breast cancer genomes to
increase performance of the NNMF procedure53. 37. Yates, L. R. et al. Subclonal diversification of primary breast cancer revealed by
Expression analysis. Clustering analyses were based on FPKM values calculated multiregion sequencing. Nat. Med. 21, 751–759 (2015).
 38. Iorio, F. et al. A landscape of pharmacogenomic interactions in cancer. Cell 166,
with the Cufflinks algorithm54. To select informative genes for clustering we applied 740–754 (2016).
the following filters: FPKM > 1; coefficient of variation across all samples > 0.7 or 39. Jones, D. et al. cgpCaVEManWrapper: Simple execution of CaVEMan in order to
absolute difference > 5. Subsequently, FPKM values were log2 transformed and detect somatic single nucleotide variants in NGS data. Curr. Protoc.
normalized. Normalization across samples was applied by subtracting the median Bioinformatics 56, 15.10.1–15.10.18 (2016).
expression value from individual expression values. Normalization across genes 40. Lochhead, P. et al. Etiologic field effect: reappraisal of the field effect concept in
 cancer predisposition and progression. Mod. Pathol. 28, 14–29 (2015).
was applied by subtracting the gene’s median expression from individual expression
 41. Luo, Y., Yu, M. & Grady, W. M. Field cancerization in the colon: a role for aberrant
values. Normalized values were subjected to principle component analysis (PCA). DNA methylation? Gastroenterol. Rep. (Oxf.) 2, 16–20 (2014).
 For each tumour clone we calculated a set of genes differentially expressed 42. Nik-Zainal, S. et al. Mutational processes molding the genomes of 21 breast
compared to all normal clones pooled together. Genes were called as differen- cancers. Cell 149, 979–993 (2012).
tially expressed if they had an FDR-corrected P value less than 0.05, resulting 43. Ye, K., Schulz, M. H., Long, Q., Apweiler, R. & Ning, Z. Pindel: a pattern growth
from a likelihood ratio test using a negative binomial generalized linear model approach to detect break points of large deletions and medium sized insertions
 from paired-end short reads. Bioinformatics 25, 2865–2871 (2009).
fit with the R package ‘edgeR’55. Raw counts were input into the edgeR model, 44. Raine, K. M. et al. cgpPindel: identifying somatically acquired insertion and
along with normalization offsets calculated using the TMM method56. To construct deletion events from paired end sequencing. Curr. Protoc. Bioinformatics 52,
the expression-based phylogenetic trees, we calculated Euclidean distances based 15.7.1–15.7.12 (2015).
on all genes that were differentially expressed in at least one tumour clone from 45. Raine, K. M. et al. ascatNgs: identifying somatically acquired copy-number
that individual. Trees were inferred by the minimum evolution method, with the alterations from whole-genome sequencing data. Curr. Protoc. Bioinformatics 56,
 15.9.1–15.9.17 (2016).
fast-me.bal function in the R-package ‘ape’57. 46. Van Loo, P. et al. Allele-specific copy number analysis of tumors. Proc. Natl Acad.
Methylation analysis. Methylation arrays were processed using the R package Sci. USA 107, 16910–16915 (2010).
minfi58. We excluded three samples that failed standard QC metrics (more than 47. Nilsen, G. et al. Copynumber: Efficient algorithms for single- and multi-track
1,000 failed probes). We then excluded any probe from the analysis if it contained copy number segmentation. BMC Genomics 13, 591 (2012).
a variant identified in one of the samples, had a detection P value > 1 × 10−10 48. Gerstung, M., Papaemmanuil, E. & Campbell, P. J. Subclonal variant calling
 with multiple samples and prior knowledge. Bioinformatics 30, 1198–1204
in > 10% samples or one sample with P > 0.01, occurred at a location known to
 (2014).
cross-hybridize with another genomic location, or where there was a known SNP 49. Martincorena, I. et al. Tumor evolution. High burden and pervasive positive
at the CpG targeted by the probe. The remaining probes were then normalized selection of somatic mutations in normal human skin. Science 348, 880–886
either using the ‘preprocessRaw’ function when comparing all samples together or (2015).
using the SWAN quantile-normalization method when comparing clones from a 50. Felsenstein, J. PHYLIP — Phylogeny Inference Package (Version 3.2). Cladistics
particular tumour59. The latter method is appropriate when the number of meth- 5, 164–166 (1989).
 51. Robinson, J. T. et al. Integrative genomics viewer. Nat. Biotechnol. 29, 24–26 (2011).
ylated probes is expected to be roughly constant across all samples, which was 52. Alexandrov, L. B., Nik-Zainal, S., Wedge, D. C., Campbell, P. J. & Stratton, M. R.
the case for each tumour. For all comparisons, M values (log2 ratio of methylated Deciphering signatures of mutational processes operative in human cancer.
to unmethylated probes) were calculated from the normalized probe intensities. Cell Reports 3, 246–259 (2013).
Samples were clustered using PCA. For computational reasons, we used only the 53. Nik-Zainal, S. et al. Landscape of somatic mutations in 560 breast cancer
1,000 most variable probes for PCA. whole-genome sequences. Nature 534, 47–54 (2016).
 54. Trapnell, C. et al. Differential gene and transcript expression analysis of
 Probes that were differentially methylated between tumour and normal cells RNA-seq experiments with TopHat and Cufflinks. Nat. Protocols 7, 562–578
were identified using an F-test with variance shrinking and a false discovery rate (2012).
of 0.01 via the ‘dmpFinder’ function comparing each tumour clone to all normal 55. Robinson, M. D., McCarthy, D. J. & Smyth, G. K. edgeR: a Bioconductor package
derived clones58. To construct the methylation-based phylogenetic trees, we cal- for differential expression analysis of digital gene expression data.
culated Euclidean distances based on probes that were differentially methylated Bioinformatics 26, 139–140 (2010).
 56. Robinson, M. D. & Oshlack, A. A scaling normalization method for differential
in at least one tumour clone from that individual. For computational reasons, we
 expression analysis of RNA-seq data. Genome Biol. 11, R25 (2010).
used a q-value cutoff of 1 × 10−8 for selection of informative probes. Trees were 57. Desper, R. & Gascuel, O. Fast and accurate phylogeny reconstruction
inferred by the minimum evolution method, with the fast-me.bal function in the algorithms based on the minimum-evolution principle. J. Comput. Biol. 9,
R-package ‘ape’57. 687–705 (2002).
Reporting summary. Further information on experimental design is available in 58. Aryee, M. J. et al. Minfi: a flexible and comprehensive Bioconductor package for
the Nature Research Reporting Summary linked to this paper. the analysis of Infinium DNA methylation microarrays. Bioinformatics 30,
 1363–1369 (2014).
Code availability. Mutation calling pipelines developed in house are available at 59. Maksimovic, J., Gordon, L. & Oshlack, A. SWAN: Subset-quantile within array
https://github.com/cancerit. The Shearwater algorithm for deriving a background normalization for illumina infinium HumanMethylation450 BeadChips.
error model is available at: https://www.bioconductor.org/packages/devel/bioc/ Genome Biol. 13, R44 (2012).
vignettes/deepSNV/inst/doc/shearwaterML.html. The software for signature 60. Borten, M. A., Bajikar, S. S., Sasaki, N., Clevers, H. & Janes, K. A. Automated
analysis used in this manuscript is available at: https://www.mathworks.com/ brightfield morphometry of 3D organoid populations by OrganoSeg. Sci. Rep.
 (in the press).
matlabcentral/fileexchange/38724-wtsi-mutational-signature-framework.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article


Extended Data Fig. 1 | Origin of clonal organoids analysed in this study. tumour, 4–6 segments were resected (sized 5 × 5 × 3–5 mm. All sections
Specimens were derived from the ascending colon of a 66-year-old woman except T3 from P2 resulted in viable clonal organoids. b–f, h–n, p–t,
(a–f), sigmoid rectum of a 65-year-old woman (g–n) and ascending Haematoxylin and eosin staining and Ki67 immunohistochemistry show
transverse colon of a 56-year-old man (o–t), respectively. From each cell morphology for individual tumour sections. Scale bars: 200 µm.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH


Extended Data Fig. 2 | Substitution analysis. a, Comparison of phylogeny signature identified in this study in tumour organoid samples from P3,
reconstructions from WGS analysis of clonal organoids (left) and characterized by T > G, T > A and T > C mutations at NTA and NTT
subclonal analysis of the original tissue biopsies (right) from individuals trinucleotides (mutated bases underlined). e, Contribution of each of the
P1–P3. The analysis of clonal organoids allows a very detailed phylogeny, identified mutation signatures to individual samples. Top (by_sample),
exact placement of driver mutations and analysis of cell-to-cell differences. results of signature extraction from all substitutions identified in each
b, Venn diagrams depicting overlap between substitutions identified by sample (Supplementary Notes). Bottom, proportion in each sample
the organoid approach and the tissue biopsy approach. c, Venn diagrams derived by adding up proportions in the branches of the phylogenetic
depicting overlaps between clones P2.N3 and P2.T6.2 and their respective tree that make up that sample (identical to Fig. 1). f, Numbers of C > T
subclones (see Methods). Only a small proportion of the total mutations mutations by CpG context. g, Signature analysis of substitutions identified
is added during culturing in both normal and tumour organoids. d, New in the original tissue biopsies.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article


Extended Data Fig. 3 | Phylogenetic trees for clones that have numbers; labels of nodes and tips in the tree correspond with labels in
been analysed by WGS. Branch lengths represent total mutation Supplementary Data files S3–S5.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH


Extended Data Fig. 4 | Phylogenetic trees for indels. Phylogenies for number of indels in this patient, who displays microsatellite instability
three individuals with branch lengths representing indel numbers, further (MSI) in all tumour clones in a different scale.
subdivided in insertions and deletions. Boxed area for P1 shows the high


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article


Extended Data Fig. 5 | Phylogenetic trees for rearrangements. rearrangement numbers, further subdivided into deletions, inversions,
Phylogenies for three individuals with branch lengths representing tandem duplications and translocations.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH


Extended Data Fig. 6 | Copy number analysis. Copy number profiles (amplification in red, loss in blue). The structures of the phylogenetic trees
of all clones that have been WGS analysed, displayed as a heatmap are displayed on the left; branch lengths are not scaled.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article


Extended Data Fig. 7 | MLH1 hypermethylation in P1. a–c, Methylation start site (TSS) for P1 tumour clones compared to normal clones.
pattern of the MLH1 gene for tumour and normal clones for three d, Expression of MLH1 in all clones; MLH1 transcript could not be
individuals, showing hypermethylation in proximity to the transcription detected in tumour clones from P1.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH


Extended Data Fig. 8 | Methylation analysis. a, Clustering of methylation based on expression data (as in Fig. 3b) with the main branches used for
data by PCA showing normal-derived organoids from three individuals our methylation analysis indicated. c, P1, n = 20 biologically independent
(n = 12 biologically independent samples). b, Global methylation change samples. d, P2, n = 21 biologically independent samples. e, P3, n = 17
in each tumour clone, expressed as the ratio of hypermethylated probes biologically independent samples. f–h, Direction of methylation changes
to hypomethylated probes. Hyper- and hypomethylation are assessed during tumour development. Methylation changes were assigned to either
by comparing to the baseline methylation levels in the normal-derived the branch of the tumour or the main subclonal branches (indicated in the
clones (indicated with line at y = 1). c–e, Left, clustering of methylation phylogenetic trees in e). i–k, Relative proportion of probes in CpG islands,
data by PCA of tumour organoids from each individual, displaying the shores, shelves and seas that were differentially methylated in different
first two principal components. Clones from different segments are shown branches (Supplementary Notes section 6).
in different colours as in Extended Data Fig. 2. Right, phylogenetic trees


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

RESEARCH Article


Extended Data Fig. 9 | Expression analysis. a, PCA based on expression samples. e–g, Global analysis of expression changes attributed to the trunk
pattern of normal organoids from each individual, displaying the first of the tree, the main branches or subclonal variation. h, Venn diagram
two principal components (n = 13). A subclone and its ancestral clone displaying the differentially expressed genes that were attributed to the
are circled. b–d, Left, PCA of tumour clones from each individual. trunk of each tumour. Differentially expressed genes determined by a
Clones derived from different segments are shown in different colours likelihood ratio test using a negative binomial generalized linear model fit
as in Figs. 2–4. A subclone derived from a tumour clone from P2 and its (FDR < 0.05). i–k, Comparison of differentially expressed genes identified
ancestor clone are circled. Right, phylogenetic trees based on expression in the organoid clones of each patient versus the original tissue sections.
data (as in Fig. 4b) with the main branches used for our expression analysis Only genes that were significantly altered in all clones or all biopsies from
indicated. b, P1, n = 20 biologically independent samples. c, P2, n = 22 each individual are considered.
biologically independent samples. d, P3, n = 17 biologically independent


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

Article RESEARCH


Extended Data Fig. 10 | Drug response data. Dose response data for in duplicate (biological replicate). For each biological or technical replicate
seven drugs, tested on organoid clones from three individuals. Twenty-one the area under the curve (AUC) is shown. c, Dose–response curves after
concentrations were tested for each drug, ranging from 14.7 nm to 20 μM. 6 days of treatment with IWP2 (Wnt secretion inhibitor) for clonal tumour
Mean survival from two duplicate experiments is displayed in a heatmap. organoids derived from P1. RNF43 mutant clones are responsive, whereas
The concentration displayed in Fig. 4 is outlined with a black box in each RNF43 wild-type (WT) clones are resistant. Data points and error bars
panel. b, Reproducibility of drug response data. Each measurement was represent the mean and s.d. of four independent technical replicates from
performed twice (technical replicate) and each experiment was performed two independent experiments.


 © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.

nature research | life sciences reporting summary
 Michael R Stratton(mrs@sanger.ac.uk);
 Corresponding author(s): Hans Clevers (h.clevers@hubrecht.eu)
 Initial submission Revised version Final submission

Life Sciences Reporting Summary
Nature Research wishes to improve the reproducibility of the work that we publish. This form is intended for publication with all accepted life
science papers and provides structure for consistency and transparency in reporting. Every life science submission will use this form; some list
items might not apply to an individual manuscript, but all fields must be completed for clarity.
For further information on the points included in this form, see Reporting Life Sciences Research. For further information on Nature Research
policies, including our data availability policy, see Authors & Referees and the Editorial Policy Checklist.


` Experimental design
1. Sample size
 Describe how sample size was determined. No statistical methods were used to predetermine sample size.

2. Data exclusions
 Describe any data exclusions. We excluded one normal derived clone from P1 from our analysis. Although all
 characteristics (mutation numbers and signatures) were in the range of the other
 normals, we could not confirm that this clone was an independent sample or a
 subsample from P1.N.2. None of our conclusions would be affected by either
 including or excluding this sample.
3. Replication
 Describe whether the experimental findings were Drug response testing has been replicated and reliably reproduced (extended data
 reliably reproduced. figure 10)
4. Randomization
 Describe how samples/organisms/participants were Not relevant to this study; we describe each case on itself and do not make
 allocated into experimental groups. assumptions on groups that they represent.
5. Blinding
 Describe whether the investigators were blinded to Investigators were blinded to each cloneID, but not individual's ID during data
 group allocation during data collection and/or analysis. collection and analysis. The reason for this is that samples from the three
 individuals were collected at different timepoints - ie after they underwent surgery.
 Note: all studies involving animals and/or human research participants must disclose whether blinding and randomization were used.

6. Statistical parameters
 For all figures and tables that use statistical methods, confirm that the following items are present in relevant figure legends (or in the
 Methods section if additional space is needed).

n/a Confirmed

 The exact sample size (n) for each experimental group/condition, given as a discrete number and unit of measurement (animals, litters, cultures, etc.)
 A description of how samples were collected, noting whether measurements were taken from distinct samples or whether the same
 sample was measured repeatedly
 A statement indicating how many times each experiment was replicated
 The statistical test(s) used and whether they are one- or two-sided (note: only common tests should be described solely by name; more
 complex techniques should be described in the Methods section)
 A description of any assumptions or corrections, such as an adjustment for multiple comparisons
 June 2017


 The test results (e.g. P values) given as exact values whenever possible and with confidence intervals noted
 A clear description of statistics including central tendency (e.g. median, mean) and variation (e.g. standard deviation, interquartile range)
 Clearly defined error bars

 See the web collection on statistics for biologists for further resources and guidance.


 1

` Software


 nature research | life sciences reporting summary
Policy information about availability of computer code
7. Software
 Describe the software used to analyze the data in this alignment:
 study. BWA-aln version 0.5.9-r16+rugo (targeted data)
 BWA-mem version 0.7.12-r1039 (whole genome data)
 variant calling:
 Caveman 1.11.0 (available from https://github.com/cancerit)
 Pindel 2.1.0 (available from https://github.com/cancerit)
 Brass 3.0.4 (available from https://github.com/cancerit)
 ASCAT 1.5.1 (available from https://github.com/cancerit)
 copynumber 1.16.0 (R package available from https://bioconductor.org/packages/
 release/bioc/html/copynumber.html)
 ShearwaterML: R package deepSNV version 1.21.4 available from https://
 www.bioconductor.org/packages/devel/bioc/vignettes/deepSNV
 Phylogeny analysis:
 phylip suite of tools: phylip-3.695 (available from http://
 evolution.genetics.washington.edu/phylip.html)
 ape 4.1 (R package available from https://cran.r-project.org/web/packages/ape/
 index.html)
 Signature extraction: available from https://www.mathworks.com/matlabcentral/
 fileexchange/38724-wtsi-mutational-signature-framework
 RNAseq analysis:
 Bowtie 0.12.7
 TopHat 1.3.3
 Cufflinks 1.0.2
 GoSeq 1.30.0 (Rpackage available from https://bioconductor.org/packages/
 release/bioc/html/goseq.html)
 edgeR 3.20.2 (R package available from http://bioconductor.org/packages/release/
 bioc/html/edgeR.html)
 Methylation analysis:
 minfi 1.24.0 (R package available from https://bioconductor.org/packages/release/
 bioc/html/minfi.html)

 Custom Rscripts to create the figures of this manuscript have been developed in
 R-3.1 for this manuscript and are available upon request from the authors).
 For manuscripts utilizing custom algorithms or software that are central to the paper but not yet described in the published literature, software must be made
 available to editors and reviewers upon request. We strongly encourage code deposition in a community repository (e.g. GitHub). Nature Methods guidance for
 providing algorithms and software for publication provides further information on this topic.

` Materials and reagents
Policy information about availability of materials
8. Materials availability
 Indicate whether there are restrictions on availability of All unique materials are available from the authors upon request.
 unique materials or if these materials are only available
 for distribution by a for-profit company.
9. Antibodies
 Describe the antibodies used and how they were validated Ki67 antibody (MONX10283, Monosan) was used and extensively validated for use
 for use in the system under study (i.e. assay and species). in human colorectal tissue in previous work (eg Drost et al, Nature 2015)

10. Eukaryotic cell lines
 a. State the source of each eukaryotic cell line used. No eukaryotic cell lines were used.

 b. Describe the method of cell line authentication used. No eukaryotic cell lines were used
 June 2017


 c. Report whether the cell lines were tested for no eukaryotic cell lines were used
 mycoplasma contamination.

 d. If any of the cell lines used are listed in the database no commonly misidentified cell lines were used
 of commonly misidentified cell lines maintained by
 ICLAC, provide a scientific rationale for their use.


 2

` Animals and human research participants


 nature research | life sciences reporting summary
Policy information about studies involving animals; when reporting animal research, follow the ARRIVE guidelines
11. Description of research animals
 Provide details on animals and/or animal-derived No animals were used
 materials used in the study.

Policy information about studies involving human research participants
12. Description of human research participants
 Describe the covariate-relevant population Samples from 3 individuals have been studied:
 characteristics of the human research participants. P1 is a 66 yo male with a tumour in the ascending colon
 P2 is a 65 yo male with a tumour in the sigmoid rectum
 P3 is a 56 yo female with a tumour in the ascending - transverse colon


 June 2017


 3

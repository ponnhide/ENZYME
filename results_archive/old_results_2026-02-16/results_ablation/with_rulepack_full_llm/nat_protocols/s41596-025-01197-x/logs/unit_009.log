[2026-02-14T11:17:46.968615+00:00] stdout: Compiled Core-IR to 
results_ablation/with_rulepack_full_llm/nat_protocols/s41596-025-01197-x/enzyme/
unit_009.core.json
[2026-02-14T11:17:47.912238+00:00] stderr: ╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /users/hideto/Project/ENZYME/src/enzyme/cli.py:65 in validate_cmd            │
│                                                                              │
│    62 ) -> None:                                                             │
│    63 │   core_ir = io.load_json(input_path)                                 │
│    64 │   registry = Registry.from_file(REGISTRY_PATH)                       │
│ ❱  65 │   validation = validate_core(core_ir, str(SCHEMA_CORE), registry)    │
│    66 │   io.write_json(output_path, validation)                             │
│    67 │   console.print(f"Validation results written to {output_path}")      │
│    68                                                                        │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │     core_ir = {                                                          │ │
│ │               │   'ir_kind': 'core',                                     │ │
│ │               │   'metadata': {                                          │ │
│ │               │   │   'source': {                                        │ │
│ │               │   │   │   'id': 's41596-025-01197-x.pdf',                │ │
│ │               │   │   │   'type': 'paper'                                │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'title': 'Slice patch‑clamp electrophysiology      │ │
│ │               (Option\u202fD)'                                           │ │
│ │               │   },                                                     │ │
│ │               │   'protocol': {                                          │ │
│ │               │   │   'detail_level': 0,                                 │ │
│ │               │   │   'edges': [                                         │ │
│ │               │   │   │   {'from': 's1', 'to': 's2'},                    │ │
│ │               │   │   │   {'from': 's2', 'to': 's3'},                    │ │
│ │               │   │   │   {'from': 's3', 'to': 's4'},                    │ │
│ │               │   │   │   {'from': 's4', 'to': 's5'},                    │ │
│ │               │   │   │   {'from': 's5', 'to': 's6'},                    │ │
│ │               │   │   │   {'from': 's6', 'to': 's7'},                    │ │
│ │               │   │   │   {'from': 's7', 'to': 's8'},                    │ │
│ │               │   │   │   {'from': 's8', 'to': 's9'},                    │ │
│ │               │   │   │   {'from': 's9', 'to': 's10'},                   │ │
│ │               │   │   │   {'from': 's10', 'to': 's11'},                  │ │
│ │               │   │   │   ... +12                                        │ │
│ │               │   │   ],                                                 │ │
│ │               │   │   'start_step_id': 's1',                             │ │
│ │               │   │   'steps': [                                         │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {},                         │ │
│ │               │   │   │   │   'id': 's1',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'organoid_initial',          │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'transfer',                          │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {                                │ │
│ │               │   │   │   │   │   'amount': {                            │ │
│ │               │   │   │   │   │   │   'unit': 'count',                   │ │
│ │               │   │   │   │   │   │   'value': 1                         │ │
│ │               │   │   │   │   │   },                                     │ │
│ │               │   │   │   │   │   'container': {'ref': 'dish_6cm'},      │ │
│ │               │   │   │   │   │   'medium': {'ref': 'cutting_ACSF'},     │ │
│ │               │   │   │   │   │   'tool': {                              │ │
│ │               │   │   │   │   │   │   'description': 'P1000 tip cut to   │ │
│ │               avoid damaging organoid',                                  │ │
│ │               │   │   │   │   │   │   'type': 'pipette_tip'              │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   }                                          │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'action': 'Wipe vibratome chamber with │ │
│ │               Kimwipes'                                                  │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's2',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │               │   │   │   │   │   │   'kind': 'equipment'                │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'annotate',                          │ │
│ │               │   │   │   │   'outputs': [],                             │ │
│ │               │   │   │   │   'params': {}                               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'action': 'Coat post with a thin layer │ │
│ │               of superglue'                                              │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's3',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │               │   │   │   │   │   │   'kind': 'equipment'                │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'annotate',                          │ │
│ │               │   │   │   │   'outputs': [],                             │ │
│ │               │   │   │   │   'params': {}                               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'action': 'Dip spatula into PBS        │ │
│ │               containing 0.5% BSA before use'                            │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's4',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'plastic_spatula',           │ │
│ │               │   │   │   │   │   │   'kind': 'material'                 │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'annotate',                          │ │
│ │               │   │   │   │   'outputs': [],                             │ │
│ │               │   │   │   │   'params': {}                               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'action': 'Mount organoid on           │ │
│ │               glue‑coated post using the spatula'                        │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's5',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   },                                     │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'plastic_spatula',           │ │
│ │               │   │   │   │   │   │   'kind': 'material'                 │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'annotate',                          │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {}                               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {},                         │ │
│ │               │   │   │   │   'id': 's6',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'cutting_ACSF',              │ │
│ │               │   │   │   │   │   │   'kind': 'material'                 │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'transfer',                          │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'vibratome_chamber',         │ │
│ │               │   │   │   │   │   │   'kind': 'container'                │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {                                │ │
│ │               │   │   │   │   │   'amount': {                            │ │
│ │               │   │   │   │   │   │   'unit': None,                      │ │
│ │               │   │   │   │   │   │   'value': None                      │ │
│ │               │   │   │   │   │   },                                     │ │
│ │               │   │   │   │   │   'tool': {                              │ │
│ │               │   │   │   │   │   │   'description': 'wide Pasteur       │ │
│ │               pipette',                                                  │ │
│ │               │   │   │   │   │   │   'type': 'pipette'                  │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   }                                          │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {},                         │ │
│ │               │   │   │   │   'id': 's7',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │               │   │   │   │   │   │   'kind': 'equipment'                │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'run_device',                        │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {'id': 'slice', 'kind': 'sample'}      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {                                │ │
│ │               │   │   │   │   │   'device_kind': 'vibratome',            │ │
│ │               │   │   │   │   │   'program': {                           │ │
│ │               │   │   │   │   │   │   'amplitude': {                     │ │
│ │               │   │   │   │   │   │   │   'unit': 'mm',                  │ │
│ │               │   │   │   │   │   │   │   'value': 1.2                   │ │
│ │               │   │   │   │   │   │   },                                 │ │
│ │               │   │   │   │   │   │   'frequency': {                     │ │
│ │               │   │   │   │   │   │   │   'unit': 'Hz',                  │ │
│ │               │   │   │   │   │   │   │   'value': 100                   │ │
│ │               │   │   │   │   │   │   },                                 │ │
│ │               │   │   │   │   │   │   'slice_thickness': {               │ │
│ │               │   │   │   │   │   │   │   'unit': 'µm',                  │ │
│ │               │   │   │   │   │   │   │   'value': 350                   │ │
│ │               │   │   │   │   │   │   },                                 │ │
│ │               │   │   │   │   │   │   'velocity': 'very slow forward     │ │
│ │               movement'                                                  │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   }                                          │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'action': 'Stop vibratome after each   │ │
│ │               slice; under a magnifying glass, use a bent insulin ne'+48 │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's8',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │               │   │   │   │   │   │   'kind': 'equipment'                │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'annotate',                          │ │
│ │               │   │   │   │   'outputs': [],                             │ │
│ │               │   │   │   │   'params': {}                               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {},                         │ │
│ │               │   │   │   │   'id': 's9',                                │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {'id': 'slice', 'kind': 'sample'}      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'transfer',                          │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {                                │ │
│ │               │   │   │   │   │   'amount': {                            │ │
│ │               │   │   │   │   │   │   'unit': 'slice',                   │ │
│ │               │   │   │   │   │   │   'value': 1                         │ │
│ │               │   │   │   │   │   },                                     │ │
│ │               │   │   │   │   │   'container': {                         │ │
│ │               │   │   │   │   │   │   'ref': 'maintenance_beaker'        │ │
│ │               │   │   │   │   │   },                                     │ │
│ │               │   │   │   │   │   'orientation': 'upside‑down            │ │
│ │               (blade‑facing upward)',                                    │ │
│ │               │   │   │   │   │   'tool': {                              │ │
│ │               │   │   │   │   │   │   'description': 'wide Pasteur       │ │
│ │               pipette',                                                  │ │
│ │               │   │   │   │   │   │   'type': 'pipette'                  │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   }                                          │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'annotations': {                           │ │
│ │               │   │   │   │   │   'lowered_from': 'incubate'             │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'id': 's10',                               │ │
│ │               │   │   │   │   'inputs': [                                │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'op': 'run_device',                        │ │
│ │               │   │   │   │   'outputs': [                               │ │
│ │               │   │   │   │   │   {                                      │ │
│ │               │   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │               │   │   │   │   │   │   'kind': 'sample'                   │ │
│ │               │   │   │   │   │   }                                      │ │
│ │               │   │   │   │   ],                                         │ │
│ │               │   │   │   │   'params': {                                │ │
│ │               │   │   │   │   │   'device_kind': 'incubator',            │ │
│ │               │   │   │   │   │   'program': {'program_name': None}      │ │
│ │               │   │   │   │   }                                          │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   ... +13                                        │ │
│ │               │   │   ]                                                  │ │
│ │               │   },                                                     │ │
│ │               │   'resources': {                                         │ │
│ │               │   │   'containers': [                                    │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'dish_6cm',                          │ │
│ │               │   │   │   │   'name': '6\u202fcm dish',                  │ │
│ │               │   │   │   │   'type': 'container'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'vibratome_chamber',                 │ │
│ │               │   │   │   │   'name': 'vibratome chamber',               │ │
│ │               │   │   │   │   'type': 'container'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'maintenance_beaker',                │ │
│ │               │   │   │   │   'name': 'maintenance beaker',              │ │
│ │               │   │   │   │   'type': 'container'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'recording_chamber',                 │ │
│ │               │   │   │   │   'name': 'recording chamber',               │ │
│ │               │   │   │   │   'type': 'container'                        │ │
│ │               │   │   │   }                                              │ │
│ │               │   │   ],                                                 │ │
│ │               │   │   'data': [],                                        │ │
│ │               │   │   'equipment': [                                     │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'vibratome',                         │ │
│ │               │   │   │   │   'name': 'vibratome',                       │ │
│ │               │   │   │   │   'type': 'equipment'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'microscope',                        │ │
│ │               │   │   │   │   'name': 'microscope',                      │ │
│ │               │   │   │   │   'type': 'equipment'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'water_bath',                        │ │
│ │               │   │   │   │   'name': 'water bath',                      │ │
│ │               │   │   │   │   'type': 'equipment'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'harp_grid',                         │ │
│ │               │   │   │   │   'name': 'harp slice grid',                 │ │
│ │               │   │   │   │   'type': 'equipment'                        │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'recording_chamber',                 │ │
│ │               │   │   │   │   'name': 'recording_chamber'                │ │
│ │               │   │   │   }                                              │ │
│ │               │   │   ],                                                 │ │
│ │               │   │   'materials': [                                     │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'cutting_ACSF',                      │ │
│ │               │   │   │   │   'name': 'ice‑cold, oxygenated cutting      │ │
│ │               ACSF',                                                     │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'PBS_BSA',                           │ │
│ │               │   │   │   │   'name': 'PBS containing 0.5% BSA',         │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'superglue',                         │ │
│ │               │   │   │   │   'name': 'superglue',                       │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'Kimwipes',                          │ │
│ │               │   │   │   │   'name': 'Kimwipes',                        │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'plastic_spatula',                   │ │
│ │               │   │   │   │   'name': 'plastic spatula',                 │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'insulin_needle',                    │ │
│ │               │   │   │   │   'name': 'bent insulin needle',             │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'wide_Pasteur_pipette',              │ │
│ │               │   │   │   │   'name': 'wide Pasteur pipette',            │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'oxygenated_ACSF',                   │ │
│ │               │   │   │   │   'name': 'oxygenated ACSF for perfusion',   │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'thin_walled_glass',                 │ │
│ │               │   │   │   │   'name': 'thin‑walled borosilicate glass    │ │
│ │               tube',                                                     │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'intracellular_solution',            │ │
│ │               │   │   │   │   'name': 'standard potassium‑based          │ │
│ │               intracellular solution',                                   │ │
│ │               │   │   │   │   'type': 'material'                         │ │
│ │               │   │   │   }                                              │ │
│ │               │   │   ],                                                 │ │
│ │               │   │   'samples': [                                       │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'organoid_initial',                  │ │
│ │               │   │   │   │   'name': '5‑month‑old organoid',            │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'organoid_on_post',                  │ │
│ │               │   │   │   │   'name': 'organoid mounted on glue‑coated   │ │
│ │               post',                                                     │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'slice',                             │ │
│ │               │   │   │   │   'name': '350‑µm‑thick organoid slice',     │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'slice_in_beaker',                   │ │
│ │               │   │   │   │   'name': 'slice in maintenance beaker',     │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'slice_in_recording',                │ │
│ │               │   │   │   │   'name': 'slice in recording chamber',      │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   {                                              │ │
│ │               │   │   │   │   'id': 'patch_pipette',                     │ │
│ │               │   │   │   │   'name': 'patch pipette (5–8\u202fMΩ)',     │ │
│ │               │   │   │   │   'type': 'sample'                           │ │
│ │               │   │   │   }                                              │ │
│ │               │   │   ]                                                  │ │
│ │               │   },                                                     │ │
│ │               │   'schema_version': '0.4'                                │ │
│ │               }                                                          │ │
│ │  input_path = PosixPath('results_ablation/with_rulepack_full_llm/nat_pr… │ │
│ │ output_path = PosixPath('results_ablation/with_rulepack_full_llm/nat_pr… │ │
│ │    registry = Registry(                                                  │ │
│ │               │   core_ops={                                             │ │
│ │               │   │   'annotate',                                        │ │
│ │               │   │   'dispose',                                         │ │
│ │               │   │   'transfer',                                        │ │
│ │               │   │   'observe',                                         │ │
│ │               │   │   'allocate',                                        │ │
│ │               │   │   'manipulate',                                      │ │
│ │               │   │   'run_device'                                       │ │
│ │               │   },                                                     │ │
│ │               │   action_kinds={                                         │ │
│ │               │   │   'mix': {                                           │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'mix by human hand (generic)'   │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'mix_gently': {                                    │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'gentle mixing by human hand'   │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'resuspend': {                                     │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'resuspend pellet or cells'     │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'rinse': {                                         │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'rinse/wash vessel manually'    │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'spread_on_plate': {                               │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'spread sample on plate         │ │
│ │               manually'                                                  │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'pick_colony': {                                   │ │
│ │               │   │   │   'required_settings_keys': ['pick_target'],     │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'pick_target': {'type': 'string'}      │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['pick_target'],               │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'pick colony from plate         │ │
│ │               manually'                                                  │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'dislodge_cells': {                                │ │
│ │               │   │   │   'required_settings_keys': [],                  │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'dislodge/detach cells by       │ │
│ │               gentle tapping/pipetting etc (manual)'                     │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'label': {                                         │ │
│ │               │   │   │   'required_settings_keys': ['text'],            │ │
│ │               │   │   │   'settings_schema': {                           │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'text': {'type': 'string'}             │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['text'],                      │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'label container/sample'        │ │
│ │               │   │   }                                                  │ │
│ │               │   },                                                     │ │
│ │               │   device_kinds={                                         │ │
│ │               │   │   'incubator': {                                     │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'incubator run'                 │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'thermocycler': {                                  │ │
│ │               │   │   │   'required_program_keys': ['profile_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'profile_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['profile_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'thermocycler run'              │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'centrifuge': {                                    │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'centrifuge run'                │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'plate_reader': {                                  │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'plate reader run'              │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'imager': {                                        │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'imaging device run'            │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'cell_counter': {                                  │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'cell counter run'              │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'dna_delivery_device': {                           │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'DNA delivery device run        │ │
│ │               (abstract)'                                                │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'amplicon_readout_system': {                       │ │
│ │               │   │   │   'required_program_keys': ['program_name'],     │ │
│ │               │   │   │   'program_schema': {                            │ │
│ │               │   │   │   │   'type': 'object',                          │ │
│ │               │   │   │   │   'properties': {                            │ │
│ │               │   │   │   │   │   'program_name': {'type': 'string'}     │ │
│ │               │   │   │   │   },                                         │ │
│ │               │   │   │   │   'required': ['program_name'],              │ │
│ │               │   │   │   │   'additionalProperties': True               │ │
│ │               │   │   │   },                                             │ │
│ │               │   │   │   'description': 'amplicon readout system run    │ │
│ │               (abstract)'                                                │ │
│ │               │   │   }                                                  │ │
│ │               │   },                                                     │ │
│ │               │   modalities={                                           │ │
│ │               │   │   'instrument_readout',                              │ │
│ │               │   │   'microscope',                                      │ │
│ │               │   │   'visual'                                           │ │
│ │               │   },                                                     │ │
│ │               │   observation_features={                                 │ │
│ │               │   │   'confluency': {                                    │ │
│ │               │   │   │   'value_type': 'number',                        │ │
│ │               │   │   │   'constraints': {'min': 0, 'max': 100},         │ │
│ │               │   │   │   'description': 'confluency percentage'         │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'morphology': {                                    │ │
│ │               │   │   │   'value_type': 'string',                        │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'cell morphology category'      │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'detached_enough': {                               │ │
│ │               │   │   │   'value_type': 'bool',                          │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'cells detached sufficiently'   │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'colonies_present': {                              │ │
│ │               │   │   │   'value_type': 'bool',                          │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'colonies present on plate'     │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'approx_count': {                                  │ │
│ │               │   │   │   'value_type': 'integer',                       │ │
│ │               │   │   │   'constraints': {'min': 0},                     │ │
│ │               │   │   │   'description': 'approximate count'             │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'pass_fail': {                                     │ │
│ │               │   │   │   'value_type': 'bool',                          │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'pass/fail judgement'           │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'cell_count': {                                    │ │
│ │               │   │   │   'value_type': 'number',                        │ │
│ │               │   │   │   'constraints': {'min': 0},                     │ │
│ │               │   │   │   'description': 'cell count'                    │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'viability': {                                     │ │
│ │               │   │   │   'value_type': 'number',                        │ │
│ │               │   │   │   'constraints': {'min': 0, 'max': 1},           │ │
│ │               │   │   │   'description': 'viability fraction'            │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'band_pattern': {                                  │ │
│ │               │   │   │   'value_type': 'string',                        │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'band pattern category or       │ │
│ │               description'                                               │ │
│ │               │   │   },                                                 │ │
│ │               │   │   'candidate_colonies': {                            │ │
│ │               │   │   │   'value_type': 'string',                        │ │
│ │               │   │   │   'constraints': {},                             │ │
│ │               │   │   │   'description': 'candidate colony locations     │ │
│ │               (encoded)'                                                 │ │
│ │               │   │   }                                                  │ │
│ │               │   }                                                      │ │
│ │               )                                                          │ │
│ ╰──────────────────────────────────────────────────────────────────────────╯ │
│                                                                              │
│ /users/hideto/Project/ENZYME/src/enzyme/validator.py:316 in validate_core    │
│                                                                              │
│   313 │                                                                      │
│   314 │   issues.extend(_check_core_ops(protocol, registry))                 │
│   315 │   for step in protocol.get("steps", []):                             │
│ ❱ 316 │   │   issues.extend(_check_registry(step, detail_level, registry, cu │
│   317 │   issues.extend(_check_refs(data))                                   │
│   318 │   issues.extend(_check_graph(protocol))                              │
│   319 │   issues.extend(_check_units(data))                                  │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │ custom_registry = {                                                      │ │
│ │                   │   'action_kinds': {},                                │ │
│ │                   │   'device_kinds': {},                                │ │
│ │                   │   'modalities': set(),                               │ │
│ │                   │   'observation_features': {}                         │ │
│ │                   }                                                      │ │
│ │            data = {                                                      │ │
│ │                   │   'ir_kind': 'core',                                 │ │
│ │                   │   'metadata': {                                      │ │
│ │                   │   │   'source': {                                    │ │
│ │                   │   │   │   'id': 's41596-025-01197-x.pdf',            │ │
│ │                   │   │   │   'type': 'paper'                            │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'title': 'Slice patch‑clamp electrophysiology  │ │
│ │                   (Option\u202fD)'                                       │ │
│ │                   │   },                                                 │ │
│ │                   │   'protocol': {                                      │ │
│ │                   │   │   'detail_level': 0,                             │ │
│ │                   │   │   'edges': [                                     │ │
│ │                   │   │   │   {'from': 's1', 'to': 's2'},                │ │
│ │                   │   │   │   {'from': 's2', 'to': 's3'},                │ │
│ │                   │   │   │   {'from': 's3', 'to': 's4'},                │ │
│ │                   │   │   │   {'from': 's4', 'to': 's5'},                │ │
│ │                   │   │   │   {'from': 's5', 'to': 's6'},                │ │
│ │                   │   │   │   {'from': 's6', 'to': 's7'},                │ │
│ │                   │   │   │   {'from': 's7', 'to': 's8'},                │ │
│ │                   │   │   │   {'from': 's8', 'to': 's9'},                │ │
│ │                   │   │   │   {'from': 's9', 'to': 's10'},               │ │
│ │                   │   │   │   {'from': 's10', 'to': 's11'},              │ │
│ │                   │   │   │   ... +12                                    │ │
│ │                   │   │   ],                                             │ │
│ │                   │   │   'start_step_id': 's1',                         │ │
│ │                   │   │   'steps': [                                     │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {},                     │ │
│ │                   │   │   │   │   'id': 's1',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'organoid_initial',      │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'transfer',                      │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'organoid_on_post',      │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {                            │ │
│ │                   │   │   │   │   │   'amount': {                        │ │
│ │                   │   │   │   │   │   │   'unit': 'count',               │ │
│ │                   │   │   │   │   │   │   'value': 1                     │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'container': {'ref': 'dish_6cm'},  │ │
│ │                   │   │   │   │   │   'medium': {                        │ │
│ │                   │   │   │   │   │   │   'ref': 'cutting_ACSF'          │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'tool': {                          │ │
│ │                   │   │   │   │   │   │   'description': 'P1000 tip cut  │ │
│ │                   to avoid damaging organoid',                           │ │
│ │                   │   │   │   │   │   │   'type': 'pipette_tip'          │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'action': 'Wipe vibratome chamber  │ │
│ │                   with Kimwipes'                                         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's2',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'vibratome',             │ │
│ │                   │   │   │   │   │   │   'kind': 'equipment'            │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'annotate',                      │ │
│ │                   │   │   │   │   'outputs': [],                         │ │
│ │                   │   │   │   │   'params': {}                           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'action': 'Coat post with a thin   │ │
│ │                   layer of superglue'                                    │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's3',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'vibratome',             │ │
│ │                   │   │   │   │   │   │   'kind': 'equipment'            │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'annotate',                      │ │
│ │                   │   │   │   │   'outputs': [],                         │ │
│ │                   │   │   │   │   'params': {}                           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'action': 'Dip spatula into PBS    │ │
│ │                   containing 0.5% BSA before use'                        │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's4',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'plastic_spatula',       │ │
│ │                   │   │   │   │   │   │   'kind': 'material'             │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'annotate',                      │ │
│ │                   │   │   │   │   'outputs': [],                         │ │
│ │                   │   │   │   │   'params': {}                           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'action': 'Mount organoid on       │ │
│ │                   glue‑coated post using the spatula'                    │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's5',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'organoid_on_post',      │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'plastic_spatula',       │ │
│ │                   │   │   │   │   │   │   'kind': 'material'             │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'annotate',                      │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'organoid_on_post',      │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {}                           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {},                     │ │
│ │                   │   │   │   │   'id': 's6',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'cutting_ACSF',          │ │
│ │                   │   │   │   │   │   │   'kind': 'material'             │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'transfer',                      │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'vibratome_chamber',     │ │
│ │                   │   │   │   │   │   │   'kind': 'container'            │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {                            │ │
│ │                   │   │   │   │   │   'amount': {                        │ │
│ │                   │   │   │   │   │   │   'unit': None,                  │ │
│ │                   │   │   │   │   │   │   'value': None                  │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'tool': {                          │ │
│ │                   │   │   │   │   │   │   'description': 'wide Pasteur   │ │
│ │                   pipette',                                              │ │
│ │                   │   │   │   │   │   │   'type': 'pipette'              │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {},                     │ │
│ │                   │   │   │   │   'id': 's7',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'vibratome',             │ │
│ │                   │   │   │   │   │   │   'kind': 'equipment'            │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'run_device',                    │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'slice',                 │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {                            │ │
│ │                   │   │   │   │   │   'device_kind': 'vibratome',        │ │
│ │                   │   │   │   │   │   'program': {                       │ │
│ │                   │   │   │   │   │   │   'amplitude': {                 │ │
│ │                   │   │   │   │   │   │   │   'unit': 'mm',              │ │
│ │                   │   │   │   │   │   │   │   'value': 1.2               │ │
│ │                   │   │   │   │   │   │   },                             │ │
│ │                   │   │   │   │   │   │   'frequency': {                 │ │
│ │                   │   │   │   │   │   │   │   'unit': 'Hz',              │ │
│ │                   │   │   │   │   │   │   │   'value': 100               │ │
│ │                   │   │   │   │   │   │   },                             │ │
│ │                   │   │   │   │   │   │   'slice_thickness': {           │ │
│ │                   │   │   │   │   │   │   │   'unit': 'µm',              │ │
│ │                   │   │   │   │   │   │   │   'value': 350               │ │
│ │                   │   │   │   │   │   │   },                             │ │
│ │                   │   │   │   │   │   │   'velocity': 'very slow forward │ │
│ │                   movement'                                              │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'action': 'Stop vibratome after    │ │
│ │                   each slice; under a magnifying glass, use a bent       │ │
│ │                   insulin ne'+48                                         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's8',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'vibratome',             │ │
│ │                   │   │   │   │   │   │   'kind': 'equipment'            │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'annotate',                      │ │
│ │                   │   │   │   │   'outputs': [],                         │ │
│ │                   │   │   │   │   'params': {}                           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {},                     │ │
│ │                   │   │   │   │   'id': 's9',                            │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'slice',                 │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'transfer',                      │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'slice_in_beaker',       │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {                            │ │
│ │                   │   │   │   │   │   'amount': {                        │ │
│ │                   │   │   │   │   │   │   'unit': 'slice',               │ │
│ │                   │   │   │   │   │   │   'value': 1                     │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'container': {                     │ │
│ │                   │   │   │   │   │   │   'ref': 'maintenance_beaker'    │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'orientation': 'upside‑down        │ │
│ │                   (blade‑facing upward)',                                │ │
│ │                   │   │   │   │   │   'tool': {                          │ │
│ │                   │   │   │   │   │   │   'description': 'wide Pasteur   │ │
│ │                   pipette',                                              │ │
│ │                   │   │   │   │   │   │   'type': 'pipette'              │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'annotations': {                       │ │
│ │                   │   │   │   │   │   'lowered_from': 'incubate'         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'id': 's10',                           │ │
│ │                   │   │   │   │   'inputs': [                            │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'slice_in_beaker',       │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'op': 'run_device',                    │ │
│ │                   │   │   │   │   'outputs': [                           │ │
│ │                   │   │   │   │   │   {                                  │ │
│ │                   │   │   │   │   │   │   'id': 'slice_in_beaker',       │ │
│ │                   │   │   │   │   │   │   'kind': 'sample'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   ],                                     │ │
│ │                   │   │   │   │   'params': {                            │ │
│ │                   │   │   │   │   │   'device_kind': 'incubator',        │ │
│ │                   │   │   │   │   │   'program': {                       │ │
│ │                   │   │   │   │   │   │   'program_name': None           │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   ... +13                                    │ │
│ │                   │   │   ]                                              │ │
│ │                   │   },                                                 │ │
│ │                   │   'resources': {                                     │ │
│ │                   │   │   'containers': [                                │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'dish_6cm',                      │ │
│ │                   │   │   │   │   'name': '6\u202fcm dish',              │ │
│ │                   │   │   │   │   'type': 'container'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'vibratome_chamber',             │ │
│ │                   │   │   │   │   'name': 'vibratome chamber',           │ │
│ │                   │   │   │   │   'type': 'container'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'maintenance_beaker',            │ │
│ │                   │   │   │   │   'name': 'maintenance beaker',          │ │
│ │                   │   │   │   │   'type': 'container'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'recording_chamber',             │ │
│ │                   │   │   │   │   'name': 'recording chamber',           │ │
│ │                   │   │   │   │   'type': 'container'                    │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   ],                                             │ │
│ │                   │   │   'data': [],                                    │ │
│ │                   │   │   'equipment': [                                 │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'vibratome',                     │ │
│ │                   │   │   │   │   'name': 'vibratome',                   │ │
│ │                   │   │   │   │   'type': 'equipment'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'microscope',                    │ │
│ │                   │   │   │   │   'name': 'microscope',                  │ │
│ │                   │   │   │   │   'type': 'equipment'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'water_bath',                    │ │
│ │                   │   │   │   │   'name': 'water bath',                  │ │
│ │                   │   │   │   │   'type': 'equipment'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'harp_grid',                     │ │
│ │                   │   │   │   │   'name': 'harp slice grid',             │ │
│ │                   │   │   │   │   'type': 'equipment'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'recording_chamber',             │ │
│ │                   │   │   │   │   'name': 'recording_chamber'            │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   ],                                             │ │
│ │                   │   │   'materials': [                                 │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'cutting_ACSF',                  │ │
│ │                   │   │   │   │   'name': 'ice‑cold, oxygenated cutting  │ │
│ │                   ACSF',                                                 │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'PBS_BSA',                       │ │
│ │                   │   │   │   │   'name': 'PBS containing 0.5% BSA',     │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'superglue',                     │ │
│ │                   │   │   │   │   'name': 'superglue',                   │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'Kimwipes',                      │ │
│ │                   │   │   │   │   'name': 'Kimwipes',                    │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'plastic_spatula',               │ │
│ │                   │   │   │   │   'name': 'plastic spatula',             │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'insulin_needle',                │ │
│ │                   │   │   │   │   'name': 'bent insulin needle',         │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'wide_Pasteur_pipette',          │ │
│ │                   │   │   │   │   'name': 'wide Pasteur pipette',        │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'oxygenated_ACSF',               │ │
│ │                   │   │   │   │   'name': 'oxygenated ACSF for           │ │
│ │                   perfusion',                                            │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'thin_walled_glass',             │ │
│ │                   │   │   │   │   'name': 'thin‑walled borosilicate      │ │
│ │                   glass tube',                                           │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'intracellular_solution',        │ │
│ │                   │   │   │   │   'name': 'standard potassium‑based      │ │
│ │                   intracellular solution',                               │ │
│ │                   │   │   │   │   'type': 'material'                     │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   ],                                             │ │
│ │                   │   │   'samples': [                                   │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'organoid_initial',              │ │
│ │                   │   │   │   │   'name': '5‑month‑old organoid',        │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'organoid_on_post',              │ │
│ │                   │   │   │   │   'name': 'organoid mounted on           │ │
│ │                   glue‑coated post',                                     │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'slice',                         │ │
│ │                   │   │   │   │   'name': '350‑µm‑thick organoid slice', │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'slice_in_beaker',               │ │
│ │                   │   │   │   │   'name': 'slice in maintenance beaker', │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'slice_in_recording',            │ │
│ │                   │   │   │   │   'name': 'slice in recording chamber',  │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   {                                          │ │
│ │                   │   │   │   │   'id': 'patch_pipette',                 │ │
│ │                   │   │   │   │   'name': 'patch pipette (5–8\u202fMΩ)', │ │
│ │                   │   │   │   │   'type': 'sample'                       │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   ]                                              │ │
│ │                   │   },                                                 │ │
│ │                   │   'schema_version': '0.4'                            │ │
│ │                   }                                                      │ │
│ │    detail_level = 0                                                      │ │
│ │          issues = [                                                      │ │
│ │                   │   Issue(                                             │ │
│ │                   │   │   code='SCHEMA_INVALID',                         │ │
│ │                   │   │   severity='error',                              │ │
│ │                   │   │   path='/resources/equipment/4',                 │ │
│ │                   │   │   message="'type' is a required property",       │ │
│ │                   │   │   suggested_fix=None                             │ │
│ │                   │   ),                                                 │ │
│ │                   │   Issue(                                             │ │
│ │                   │   │   code='UNKNOWN_DEVICE_KIND',                    │ │
│ │                   │   │   severity='warn',                               │ │
│ │                   │   │   path='/protocol/steps/s7/params/device_kind',  │ │
│ │                   │   │   message='Unknown registry value: vibratome',   │ │
│ │                   │   │   suggested_fix='Declare custom vocabulary or    │ │
│ │                   use a registry term.'                                  │ │
│ │                   │   ),                                                 │ │
│ │                   │   Issue(                                             │ │
│ │                   │   │   code='UNKNOWN_DEVICE_KIND',                    │ │
│ │                   │   │   severity='warn',                               │ │
│ │                   │   │   path='/protocol/steps/s13/params/device_kind', │ │
│ │                   │   │   message='Unknown registry value:               │ │
│ │                   perfusion_system',                                     │ │
│ │                   │   │   suggested_fix='Declare custom vocabulary or    │ │
│ │                   use a registry term.'                                  │ │
│ │                   │   )                                                  │ │
│ │                   ]                                                      │ │
│ │        protocol = {                                                      │ │
│ │                   │   'detail_level': 0,                                 │ │
│ │                   │   'edges': [                                         │ │
│ │                   │   │   {'from': 's1', 'to': 's2'},                    │ │
│ │                   │   │   {'from': 's2', 'to': 's3'},                    │ │
│ │                   │   │   {'from': 's3', 'to': 's4'},                    │ │
│ │                   │   │   {'from': 's4', 'to': 's5'},                    │ │
│ │                   │   │   {'from': 's5', 'to': 's6'},                    │ │
│ │                   │   │   {'from': 's6', 'to': 's7'},                    │ │
│ │                   │   │   {'from': 's7', 'to': 's8'},                    │ │
│ │                   │   │   {'from': 's8', 'to': 's9'},                    │ │
│ │                   │   │   {'from': 's9', 'to': 's10'},                   │ │
│ │                   │   │   {'from': 's10', 'to': 's11'},                  │ │
│ │                   │   │   ... +12                                        │ │
│ │                   │   ],                                                 │ │
│ │                   │   'start_step_id': 's1',                             │ │
│ │                   │   'steps': [                                         │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {},                         │ │
│ │                   │   │   │   'id': 's1',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'organoid_initial',          │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'transfer',                          │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {                                │ │
│ │                   │   │   │   │   'amount': {                            │ │
│ │                   │   │   │   │   │   'unit': 'count',                   │ │
│ │                   │   │   │   │   │   'value': 1                         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'container': {'ref': 'dish_6cm'},      │ │
│ │                   │   │   │   │   'medium': {'ref': 'cutting_ACSF'},     │ │
│ │                   │   │   │   │   'tool': {                              │ │
│ │                   │   │   │   │   │   'description': 'P1000 tip cut to   │ │
│ │                   avoid damaging organoid',                              │ │
│ │                   │   │   │   │   │   'type': 'pipette_tip'              │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'action': 'Wipe vibratome chamber with │ │
│ │                   Kimwipes'                                              │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's2',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │                   │   │   │   │   │   'kind': 'equipment'                │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'annotate',                          │ │
│ │                   │   │   │   'outputs': [],                             │ │
│ │                   │   │   │   'params': {}                               │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'action': 'Coat post with a thin layer │ │
│ │                   of superglue'                                          │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's3',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │                   │   │   │   │   │   'kind': 'equipment'                │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'annotate',                          │ │
│ │                   │   │   │   'outputs': [],                             │ │
│ │                   │   │   │   'params': {}                               │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'action': 'Dip spatula into PBS        │ │
│ │                   containing 0.5% BSA before use'                        │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's4',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'plastic_spatula',           │ │
│ │                   │   │   │   │   │   'kind': 'material'                 │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'annotate',                          │ │
│ │                   │   │   │   'outputs': [],                             │ │
│ │                   │   │   │   'params': {}                               │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'action': 'Mount organoid on           │ │
│ │                   glue‑coated post using the spatula'                    │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's5',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'plastic_spatula',           │ │
│ │                   │   │   │   │   │   'kind': 'material'                 │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'annotate',                          │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'organoid_on_post',          │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {}                               │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {},                         │ │
│ │                   │   │   │   'id': 's6',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'cutting_ACSF',              │ │
│ │                   │   │   │   │   │   'kind': 'material'                 │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'transfer',                          │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'vibratome_chamber',         │ │
│ │                   │   │   │   │   │   'kind': 'container'                │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {                                │ │
│ │                   │   │   │   │   'amount': {                            │ │
│ │                   │   │   │   │   │   'unit': None,                      │ │
│ │                   │   │   │   │   │   'value': None                      │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'tool': {                              │ │
│ │                   │   │   │   │   │   'description': 'wide Pasteur       │ │
│ │                   pipette',                                              │ │
│ │                   │   │   │   │   │   'type': 'pipette'                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {},                         │ │
│ │                   │   │   │   'id': 's7',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │                   │   │   │   │   │   'kind': 'equipment'                │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'run_device',                        │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {'id': 'slice', 'kind': 'sample'}      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {                                │ │
│ │                   │   │   │   │   'device_kind': 'vibratome',            │ │
│ │                   │   │   │   │   'program': {                           │ │
│ │                   │   │   │   │   │   'amplitude': {                     │ │
│ │                   │   │   │   │   │   │   'unit': 'mm',                  │ │
│ │                   │   │   │   │   │   │   'value': 1.2                   │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'frequency': {                     │ │
│ │                   │   │   │   │   │   │   'unit': 'Hz',                  │ │
│ │                   │   │   │   │   │   │   'value': 100                   │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'slice_thickness': {               │ │
│ │                   │   │   │   │   │   │   'unit': 'µm',                  │ │
│ │                   │   │   │   │   │   │   'value': 350                   │ │
│ │                   │   │   │   │   │   },                                 │ │
│ │                   │   │   │   │   │   'velocity': 'very slow forward     │ │
│ │                   movement'                                              │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'action': 'Stop vibratome after each   │ │
│ │                   slice; under a magnifying glass, use a bent insulin    │ │
│ │                   ne'+48                                                 │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's8',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'vibratome',                 │ │
│ │                   │   │   │   │   │   'kind': 'equipment'                │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'annotate',                          │ │
│ │                   │   │   │   'outputs': [],                             │ │
│ │                   │   │   │   'params': {}                               │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {},                         │ │
│ │                   │   │   │   'id': 's9',                                │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {'id': 'slice', 'kind': 'sample'}      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'transfer',                          │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {                                │ │
│ │                   │   │   │   │   'amount': {                            │ │
│ │                   │   │   │   │   │   'unit': 'slice',                   │ │
│ │                   │   │   │   │   │   'value': 1                         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'container': {                         │ │
│ │                   │   │   │   │   │   'ref': 'maintenance_beaker'        │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'orientation': 'upside‑down            │ │
│ │                   (blade‑facing upward)',                                │ │
│ │                   │   │   │   │   'tool': {                              │ │
│ │                   │   │   │   │   │   'description': 'wide Pasteur       │ │
│ │                   pipette',                                              │ │
│ │                   │   │   │   │   │   'type': 'pipette'                  │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   {                                              │ │
│ │                   │   │   │   'annotations': {                           │ │
│ │                   │   │   │   │   'lowered_from': 'incubate'             │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'id': 's10',                               │ │
│ │                   │   │   │   'inputs': [                                │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'op': 'run_device',                        │ │
│ │                   │   │   │   'outputs': [                               │ │
│ │                   │   │   │   │   {                                      │ │
│ │                   │   │   │   │   │   'id': 'slice_in_beaker',           │ │
│ │                   │   │   │   │   │   'kind': 'sample'                   │ │
│ │                   │   │   │   │   }                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'params': {                                │ │
│ │                   │   │   │   │   'device_kind': 'incubator',            │ │
│ │                   │   │   │   │   'program': {'program_name': None}      │ │
│ │                   │   │   │   }                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   ... +13                                        │ │
│ │                   │   ]                                                  │ │
│ │                   }                                                      │ │
│ │        registry = Registry(                                              │ │
│ │                   │   core_ops={                                         │ │
│ │                   │   │   'annotate',                                    │ │
│ │                   │   │   'dispose',                                     │ │
│ │                   │   │   'transfer',                                    │ │
│ │                   │   │   'observe',                                     │ │
│ │                   │   │   'allocate',                                    │ │
│ │                   │   │   'manipulate',                                  │ │
│ │                   │   │   'run_device'                                   │ │
│ │                   │   },                                                 │ │
│ │                   │   action_kinds={                                     │ │
│ │                   │   │   'mix': {                                       │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'mix by human hand          │ │
│ │                   (generic)'                                             │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'mix_gently': {                                │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'gentle mixing by human     │ │
│ │                   hand'                                                  │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'resuspend': {                                 │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'resuspend pellet or cells' │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'rinse': {                                     │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'rinse/wash vessel          │ │
│ │                   manually'                                              │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'spread_on_plate': {                           │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'spread sample on plate     │ │
│ │                   manually'                                              │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'pick_colony': {                               │ │
│ │                   │   │   │   'required_settings_keys': [                │ │
│ │                   │   │   │   │   'pick_target'                          │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'pick_target': {                   │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['pick_target'],           │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'pick colony from plate     │ │
│ │                   manually'                                              │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'dislodge_cells': {                            │ │
│ │                   │   │   │   'required_settings_keys': [],              │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'dislodge/detach cells by   │ │
│ │                   gentle tapping/pipetting etc (manual)'                 │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'label': {                                     │ │
│ │                   │   │   │   'required_settings_keys': ['text'],        │ │
│ │                   │   │   │   'settings_schema': {                       │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'text': {'type': 'string'}         │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['text'],                  │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'label container/sample'    │ │
│ │                   │   │   }                                              │ │
│ │                   │   },                                                 │ │
│ │                   │   device_kinds={                                     │ │
│ │                   │   │   'incubator': {                                 │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'incubator run'             │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'thermocycler': {                              │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'profile_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'profile_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['profile_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'thermocycler run'          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'centrifuge': {                                │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'centrifuge run'            │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'plate_reader': {                              │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'plate reader run'          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'imager': {                                    │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'imaging device run'        │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'cell_counter': {                              │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'cell counter run'          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'dna_delivery_device': {                       │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'DNA delivery device run    │ │
│ │                   (abstract)'                                            │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'amplicon_readout_system': {                   │ │
│ │                   │   │   │   'required_program_keys': [                 │ │
│ │                   │   │   │   │   'program_name'                         │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   'program_schema': {                        │ │
│ │                   │   │   │   │   'type': 'object',                      │ │
│ │                   │   │   │   │   'properties': {                        │ │
│ │                   │   │   │   │   │   'program_name': {                  │ │
│ │                   │   │   │   │   │   │   'type': 'string'               │ │
│ │                   │   │   │   │   │   }                                  │ │
│ │                   │   │   │   │   },                                     │ │
│ │                   │   │   │   │   'required': ['program_name'],          │ │
│ │                   │   │   │   │   'additionalProperties': True           │ │
│ │                   │   │   │   },                                         │ │
│ │                   │   │   │   'description': 'amplicon readout system    │ │
│ │                   run (abstract)'                                        │ │
│ │                   │   │   }                                              │ │
│ │                   │   },                                                 │ │
│ │                   │   modalities={                                       │ │
│ │                   │   │   'instrument_readout',                          │ │
│ │                   │   │   'microscope',                                  │ │
│ │                   │   │   'visual'                                       │ │
│ │                   │   },                                                 │ │
│ │                   │   observation_features={                             │ │
│ │                   │   │   'confluency': {                                │ │
│ │                   │   │   │   'value_type': 'number',                    │ │
│ │                   │   │   │   'constraints': {'min': 0, 'max': 100},     │ │
│ │                   │   │   │   'description': 'confluency percentage'     │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'morphology': {                                │ │
│ │                   │   │   │   'value_type': 'string',                    │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'cell morphology category'  │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'detached_enough': {                           │ │
│ │                   │   │   │   'value_type': 'bool',                      │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'cells detached             │ │
│ │                   sufficiently'                                          │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'colonies_present': {                          │ │
│ │                   │   │   │   'value_type': 'bool',                      │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'colonies present on plate' │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'approx_count': {                              │ │
│ │                   │   │   │   'value_type': 'integer',                   │ │
│ │                   │   │   │   'constraints': {'min': 0},                 │ │
│ │                   │   │   │   'description': 'approximate count'         │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'pass_fail': {                                 │ │
│ │                   │   │   │   'value_type': 'bool',                      │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'pass/fail judgement'       │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'cell_count': {                                │ │
│ │                   │   │   │   'value_type': 'number',                    │ │
│ │                   │   │   │   'constraints': {'min': 0},                 │ │
│ │                   │   │   │   'description': 'cell count'                │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'viability': {                                 │ │
│ │                   │   │   │   'value_type': 'number',                    │ │
│ │                   │   │   │   'constraints': {'min': 0, 'max': 1},       │ │
│ │                   │   │   │   'description': 'viability fraction'        │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'band_pattern': {                              │ │
│ │                   │   │   │   'value_type': 'string',                    │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'band pattern category or   │ │
│ │                   description'                                           │ │
│ │                   │   │   },                                             │ │
│ │                   │   │   'candidate_colonies': {                        │ │
│ │                   │   │   │   'value_type': 'string',                    │ │
│ │                   │   │   │   'constraints': {},                         │ │
│ │                   │   │   │   'description': 'candidate colony locations │ │
│ │                   (encoded)'                                             │ │
│ │                   │   │   }                                              │ │
│ │                   │   }                                                  │ │
│ │                   )                                                      │ │
│ │     schema_path = '/users/hideto/Project/ENZYME/enzyme_ir/schema_core.j… │ │
│ │            step = {                                                      │ │
│ │                   │   'annotations': {},                                 │ │
│ │                   │   'id': 's15',                                       │ │
│ │                   │   'inputs': [                                        │ │
│ │                   │   │   {'id': 'microscope', 'kind': 'equipment'}      │ │
│ │                   │   ],                                                 │ │
│ │                   │   'op': 'observe',                                   │ │
│ │                   │   'outputs': [],                                     │ │
│ │                   │   'params': {                                        │ │
│ │                   │   │   'features': 'Identify area with clear          │ │
│ │                   lamination using 10× objective',                       │ │
│ │                   │   │   'modality': 'microscope'                       │ │
│ │                   │   }                                                  │ │
│ │                   }                                                      │ │
│ ╰──────────────────────────────────────────────────────────────────────────╯ │
│                                                                              │
│ /users/hideto/Project/ENZYME/src/enzyme/validator.py:123 in _check_registry  │
│                                                                              │
│   120 │   │   ):                                                             │
│   121 │   │   │   issues.append(unknown_issue("UNKNOWN_MODALITY", f"/protoco │
│   122 │   │   features = step.get("params", {}).get("features", {})          │
│ ❱ 123 │   │   for feature_key in features.keys():                            │
│   124 │   │   │   if feature_key not in registry.observation_features and no │
│   125 │   │   │   │   custom, "observation_features", feature_key            │
│   126 │   │   │   ):                                                         │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │       custom = {                                                         │ │
│ │                │   'action_kinds': {},                                   │ │
│ │                │   'device_kinds': {},                                   │ │
│ │                │   'modalities': set(),                                  │ │
│ │                │   'observation_features': {}                            │ │
│ │                }                                                         │ │
│ │ detail_level = 0                                                         │ │
│ │     features = 'Identify area with clear lamination using 10× objective' │ │
│ │       issues = []                                                        │ │
│ │     modality = 'microscope'                                              │ │
│ │     registry = Registry(                                                 │ │
│ │                │   core_ops={                                            │ │
│ │                │   │   'annotate',                                       │ │
│ │                │   │   'dispose',                                        │ │
│ │                │   │   'transfer',                                       │ │
│ │                │   │   'observe',                                        │ │
│ │                │   │   'allocate',                                       │ │
│ │                │   │   'manipulate',                                     │ │
│ │                │   │   'run_device'                                      │ │
│ │                │   },                                                    │ │
│ │                │   action_kinds={                                        │ │
│ │                │   │   'mix': {                                          │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'mix by human hand (generic)'  │ │
│ │                │   │   },                                                │ │
│ │                │   │   'mix_gently': {                                   │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'gentle mixing by human hand'  │ │
│ │                │   │   },                                                │ │
│ │                │   │   'resuspend': {                                    │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'resuspend pellet or cells'    │ │
│ │                │   │   },                                                │ │
│ │                │   │   'rinse': {                                        │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'rinse/wash vessel manually'   │ │
│ │                │   │   },                                                │ │
│ │                │   │   'spread_on_plate': {                              │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'spread sample on plate        │ │
│ │                manually'                                                 │ │
│ │                │   │   },                                                │ │
│ │                │   │   'pick_colony': {                                  │ │
│ │                │   │   │   'required_settings_keys': ['pick_target'],    │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'pick_target': {'type': 'string'}     │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['pick_target'],              │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'pick colony from plate        │ │
│ │                manually'                                                 │ │
│ │                │   │   },                                                │ │
│ │                │   │   'dislodge_cells': {                               │ │
│ │                │   │   │   'required_settings_keys': [],                 │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'dislodge/detach cells by      │ │
│ │                gentle tapping/pipetting etc (manual)'                    │ │
│ │                │   │   },                                                │ │
│ │                │   │   'label': {                                        │ │
│ │                │   │   │   'required_settings_keys': ['text'],           │ │
│ │                │   │   │   'settings_schema': {                          │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'text': {'type': 'string'}            │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['text'],                     │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'label container/sample'       │ │
│ │                │   │   }                                                 │ │
│ │                │   },                                                    │ │
│ │                │   device_kinds={                                        │ │
│ │                │   │   'incubator': {                                    │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'incubator run'                │ │
│ │                │   │   },                                                │ │
│ │                │   │   'thermocycler': {                                 │ │
│ │                │   │   │   'required_program_keys': ['profile_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'profile_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['profile_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'thermocycler run'             │ │
│ │                │   │   },                                                │ │
│ │                │   │   'centrifuge': {                                   │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'centrifuge run'               │ │
│ │                │   │   },                                                │ │
│ │                │   │   'plate_reader': {                                 │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'plate reader run'             │ │
│ │                │   │   },                                                │ │
│ │                │   │   'imager': {                                       │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'imaging device run'           │ │
│ │                │   │   },                                                │ │
│ │                │   │   'cell_counter': {                                 │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'cell counter run'             │ │
│ │                │   │   },                                                │ │
│ │                │   │   'dna_delivery_device': {                          │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'DNA delivery device run       │ │
│ │                (abstract)'                                               │ │
│ │                │   │   },                                                │ │
│ │                │   │   'amplicon_readout_system': {                      │ │
│ │                │   │   │   'required_program_keys': ['program_name'],    │ │
│ │                │   │   │   'program_schema': {                           │ │
│ │                │   │   │   │   'type': 'object',                         │ │
│ │                │   │   │   │   'properties': {                           │ │
│ │                │   │   │   │   │   'program_name': {'type': 'string'}    │ │
│ │                │   │   │   │   },                                        │ │
│ │                │   │   │   │   'required': ['program_name'],             │ │
│ │                │   │   │   │   'additionalProperties': True              │ │
│ │                │   │   │   },                                            │ │
│ │                │   │   │   'description': 'amplicon readout system run   │ │
│ │                (abstract)'                                               │ │
│ │                │   │   }                                                 │ │
│ │                │   },                                                    │ │
│ │                │   modalities={                                          │ │
│ │                │   │   'instrument_readout',                             │ │
│ │                │   │   'microscope',                                     │ │
│ │                │   │   'visual'                                          │ │
│ │                │   },                                                    │ │
│ │                │   observation_features={                                │ │
│ │                │   │   'confluency': {                                   │ │
│ │                │   │   │   'value_type': 'number',                       │ │
│ │                │   │   │   'constraints': {'min': 0, 'max': 100},        │ │
│ │                │   │   │   'description': 'confluency percentage'        │ │
│ │                │   │   },                                                │ │
│ │                │   │   'morphology': {                                   │ │
│ │                │   │   │   'value_type': 'string',                       │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'cell morphology category'     │ │
│ │                │   │   },                                                │ │
│ │                │   │   'detached_enough': {                              │ │
│ │                │   │   │   'value_type': 'bool',                         │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'cells detached sufficiently'  │ │
│ │                │   │   },                                                │ │
│ │                │   │   'colonies_present': {                             │ │
│ │                │   │   │   'value_type': 'bool',                         │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'colonies present on plate'    │ │
│ │                │   │   },                                                │ │
│ │                │   │   'approx_count': {                                 │ │
│ │                │   │   │   'value_type': 'integer',                      │ │
│ │                │   │   │   'constraints': {'min': 0},                    │ │
│ │                │   │   │   'description': 'approximate count'            │ │
│ │                │   │   },                                                │ │
│ │                │   │   'pass_fail': {                                    │ │
│ │                │   │   │   'value_type': 'bool',                         │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'pass/fail judgement'          │ │
│ │                │   │   },                                                │ │
│ │                │   │   'cell_count': {                                   │ │
│ │                │   │   │   'value_type': 'number',                       │ │
│ │                │   │   │   'constraints': {'min': 0},                    │ │
│ │                │   │   │   'description': 'cell count'                   │ │
│ │                │   │   },                                                │ │
│ │                │   │   'viability': {                                    │ │
│ │                │   │   │   'value_type': 'number',                       │ │
│ │                │   │   │   'constraints': {'min': 0, 'max': 1},          │ │
│ │                │   │   │   'description': 'viability fraction'           │ │
│ │                │   │   },                                                │ │
│ │                │   │   'band_pattern': {                                 │ │
│ │                │   │   │   'value_type': 'string',                       │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'band pattern category or      │ │
│ │                description'                                              │ │
│ │                │   │   },                                                │ │
│ │                │   │   'candidate_colonies': {                           │ │
│ │                │   │   │   'value_type': 'string',                       │ │
│ │                │   │   │   'constraints': {},                            │ │
│ │                │   │   │   'description': 'candidate colony locations    │ │
│ │                (encoded)'                                                │ │
│ │                │   │   }                                                 │ │
│ │                │   }                                                     │ │
│ │                )                                                         │ │
│ │         step = {                                                         │ │
│ │                │   'annotations': {},                                    │ │
│ │                │   'id': 's15',                                          │ │
│ │                │   'inputs': [                                           │ │
│ │                │   │   {'id': 'microscope', 'kind': 'equipment'}         │ │
│ │                │   ],                                                    │ │
│ │                │   'op': 'observe',                                      │ │
│ │                │   'outputs': [],                                        │ │
│ │                │   'params': {                                           │ │
│ │                │   │   'features': 'Identify area with clear lamination  │ │
│ │                using 10× objective',                                     │ │
│ │                │   │   'modality': 'microscope'                          │ │
│ │                │   }                                                     │ │
│ │                }                                                         │ │
│ ╰──────────────────────────────────────────────────────────────────────────╯ │
╰──────────────────────────────────────────────────────────────────────────────╯
AttributeError: 'str' object has no attribute 'keys'
[2026-02-15T04:54:50.709524+00:00] HL generation failed: LLM request failed: <urlopen error [Errno 1] Operation not permitted>
[2026-02-15T04:55:05.911790+00:00] HL generation failed: LLM request failed: <urlopen error [Errno 1] Operation not permitted>
[2026-02-15T04:55:15.564547+00:00] HL generation failed: LLM request failed: <urlopen error [Errno 1] Operation not permitted>

{
  "units": [
    {
      "title": "Protocol",
      "text": "Protocol\n Dataset\n 1.0\n\n 0.8\nProportion\n\n\n 0.6\n\n 0.4\n\n 0.2\n Age (days) Protocol type\n Guided\n 0 7 56 450\n Age Unguided\n\n h i Dorsal telen. j k\n NPC and neurons 15 SOX2 STMN2\n ExN (HOXB2/NEUROD6+) InN (TFAP2A+)\n SLC17A6 Max.–Min.\n Early neuron normalized\n Ranked InN (HOXB2+) SLC32A1\n (HOXB2+) SLC18A3\n DC1 (0,1] 0\n SLC18A3+ neuron\n expression\n ExN (HOXB2+) HOXB2\n 1 (HOXB2+) TFAP2A 1\n 0 1.0\n ExN (ISL1+) InN (ISL1+) ISL1\n BCL11B SATB2\n 6 6 LHX9\n InN (LHX9+)\n LHX5\n ExN (LHX9/TCF7L2+) TCF7L2\n InN (TTR+) TTR 0\n 0 0 0\n ExN (LHX9/LHX5+)\n 0 1.0 0 1.0\n Pseudotime (ranked DC1)\n\nFig. 1 | Integrated HNOCA. a, Overview of HNOCA construction pipeline. between cells. The stream arrows visualize the inferred flow of cell states\nb, Metadata of biological samples included in HNOCA. c–f, UMAP of the toward more mature cells. i, Marker gene expression profiles along cortical\nintegrated HNOCA, coloured by level 2 cell type annotations (c), gene pseudotime. j, UMAP of non-telencephalic neurons, coloured and labelled by\nexpression profiles of selected markers (d), sample ages (e) and differentiation clusters. k, Heatmap showing relative expression of selected genes across\nprotocol types (f). g, Proportions of cells assigned to different cell types in different non-telencephalic neuron clusters. Coloured dots show cluster\nthe HNOCA. Every stacked bar represents one biological sample, grouped by identities as shown in j. Cb, cerebellum; ChP, choroid plexus; CP, choroid\ndatasets and ordered by increasing sample ages. Top bars show 36 datasets, plexus; Hy, hypothalamus; max., maximum; MB, midbrain; MH, medulla; min.,\norganoid differentiation protocols, protocol types. Bottom bars show the minimum; Oligo, oligodendrocyte; OPC, oligodendrocyte progenitor cell; PSC,\nsample age. h, UMAP of the integrated HNOCA coloured by top-ranked pluripotent stem cell; telen., telencephalon; Th, thalamus; vTelen, ventral\ndiffusion component (DC1) on the real-time-informed transition matrix telencephalon.\n\n\norganoids. We estimate transcriptomic fidelity of neurons in neural biological metadata from 36 datasets, including 34 published1–26 and\norganoids, and identify previously described cell stress3,10,23,24 as a uni- two as yet unpublished ones (Supplementary Table 1), accounting for\nversal factor distinguishing metabolic states of in vitro neurons from 1.77 million cells after consistent preprocessing and quality control\nprimary neurons without strongly affecting core identities of neuronal (Fig. 1a). The HNOCA represents cell types and states generated with\ncell types. We map the data of a neural organoid morphogen screen44 26 distinct neural organoid differentiation protocols, including three\nto the integrated atlas to assess regional specificity and generation of unguided and 23 guided ones, at time points ranging from 7 to 450 days\nnew states. We also collect 11 scRNA-seq datasets modelling 10 different (Fig. 1b). To remove batch effects, we implemented a three-step inteneural diseases, and map the integrated data to the neural organoid gration pipeline. First, we projected the HNOCA to a single-cell atlas\natlas for cell type annotation and differential expression (DE) analysis. of the developing human brain27 using reference similarity spectrum\nFinally, we show that the atlas can be expanded by projecting new data (RSS)3. Then, we developed snapseed (Methods) to perform prelimito the current atlas. Together, our work provides a rich resource and a nary marker-based hierarchical cell type annotation. Last, we used\nnew framework to assess the fidelity of neural organoids, characterize scPoli45 for label-aware data integration based on the snapseed annoperturbed and diseased states and streamline protocol development. tations. Evaluation of different integration approaches using a previ-\n ously established benchmarking pipeline46 showed that scPoli had\n the best performance for these datasets (Extended Data Fig. 1). We\nData curation, harmonization and integration performed clustering on the basis of the scPoli representation and\nTo build a transcriptomic human neural organoid cell atlas (HNOCA), annotated clusters on the basis of canonical marker gene expression,\nwe collected scRNA-seq data and detailed, harmonized technical and organoid sample age and the auto-generated cell type labels. A uniform\n\n\n Nature | Vol 635 | 21 November 2024 | 691\n\nArticle\na d hOligoO hStrO\n hMidOrg Organoid datasets\n 80 Dorsal telen. [ Unguided ]\n\n\n Percentage of\n 40\n\n\n Percentage of\n telen cells\n Ventral telen.\n\n\n MB cells\n 27\n Braun et al. 40 Dorsal midbrain\n 20\n Ventral midbrain\n 0 0\n Cell class hHyThaOrg hCerebOrg hSpO\n Radial glia Hypothalamus 80 hMidOrg\n\n\n Percentage of\n hChPO\n\n\n Percentage of\n Neuronal IPC 80 Cerebellum\n 60\n\n\n HB cells\n Thalamus\n\n\n dien cells\n Neuroblast hThaOrg\n Region Neuron hSO 40 Pons\n 40\n Forebrain Thalamus Glioblast Medulla\n NTT neuronal 20\n Telencephalon Midbrain Oligo\n subtype Cortex Placodes 0 0\n Midbrain dorsal\n Glutamatergic Subcortex Midbrain ventral Immune\n GABAergic Striatum Hindbrain Vascular\n Glycinergic Hippocampus Cerebellum Erythrocyte e Max.-presence f\n Cholinergic Neural crest 1.0\n Diencephalon Pons score\n Serotonergic Hypothalamus Medulla Fibroblast Enriched\n (in ≥1 dataset) 0.2\n 1 0\n Brain regions\n\n\n Max.-presence score\nb\n\n\n Im .\n Va .\n G s.\n F- ast\n\n O st\n o\n C\n\n .\n yt\n m\n\n\n ac\n Region\n\n\n lig\n N\n a\n (RG, IPC, N-blast, N)\n\n\n Er\n g\n\n\n l\n bl\n\n\n Pl\n -b\n (NPC, IP, Neuron) 1.0\n 0\n Depleted 0.8\n (in all datasets)\n\n h 0.6\n NTT subtype Under-represented\n (neuron) 0.4\n Other cells from the same region\n 0.2\n Thalamus Midbrain Hindbrain\nc Primary dev. stages Prop. 0 1 (dMB, vMB) (CB, pons, medulla)\n Pons 0\n First trimester 1 0.995 0.95 0.575 0.627 0.507 0.533 0.553 TRN m1 GABA-N Clusters\n GABA-N\nWang et al.30 Second trimester 0 0.003 0.042 0.41 0.352 0.4 0.428 0.414 GABA-N Neuronal\n Third trimester 0 0.001 0.004 0.014 0.015 0.078 0.032 0.032 dA2 Cell class\n Infant 0 0.001 0.004 0.002 0.005 0.014 0.007 0 ExN Region\n Adolescence 0 0 0 0 0 0.001 0 0 GLUT-TCN dTel. vTel. Th dMB CB Pons\n RG/IPC m1/m2 Purkinje (cortex)\n 0 1 2 3 4 5 6 7 10 Hipp HyTh vMB Medulla\n GLUT-N cell\n Organoid age (months)\n\nFig. 2 | Projection of HNOCA to primary developing human brain cell types. e, UMAP of the human developing brain cell atlas27 coloured by cell\natlases assists organoid neural cell type annotation and estimation of population presence within HNOCA datasets (max presence score). A low score\nprimary cell type representation. a, UMAP of a human developing brain cell denotes under-representation of cell state in HNOCA datasets. f, Distribution\natlas27, coloured by NTT subtypes (left), region (middle) and annotated cell of max presence scores of different cell classes in the human reference atlas27.\nclasses (right). b, UMAP of HNOCA, coloured by the mapped neuron NTT Eryt., erythrocyte; Imm., immune; Vas., vascular; G-blast, glioblast; F-blast,\nsubtypes (left) and regional labels of NPCs, intermediate progenitor cells (IP) fibroblast; NC, neural crest; Plac., placodes; RG, radial glia; IPC, intermediate\nand neurons. c, Heatmap showing proportions of cells from organoids of progenitor cell; N-blast, neuroblast; N, neuron. g, Box plots showing distribution\ndifferent ages matched to cells from different primary developmental (dev.) of max presence scores in different primary reference cell clusters. Bottom\nstages. d, Percentages of neural cells representing different regions side bars show neuronal versus non-neuronal, cell class, region information of\n(telencephalon, diencephalon, midbrain and hindbrain) in different datasets. primary reference. h, UMAP of human developing brain atlas showing primary\nThe x axes show datasets, descendingly ordered by the total proportions (bar neural cell types or states under-represented in HNOCA (in red). Hippo,\nheight). Datasets based on unguided differentiation protocols are marked by hippocampus; HyTh, hypothalamus; d, dorsal; v, ventral; CB, cerebellum.\ndots underneath. The bars at the bottom of each panel show organoid protocol\n\n\nmanifold approximation and projection (UMAP) embedding high- the HNOCA to the same latent space. The shared latent space allowed\nlighted three neuronal differentiation trajectories corresponding to us to reconstruct a bipartite weighted k-nearest-neighbour (wkNN)\ndorsal telencephalic, ventral telencephalic and non-telencephalic graph between cells in the HNOCA and the primary reference atlas,\npopulations as well as trajectories leading from progenitors to glial cell which was used to transfer the ‘CellClass’ and ‘Subregion’ labels, as well\ntypes such as astrocytes and oligodendrocytes precursors (Fig. 1c–e and as the neurotransmitter transporter (NTT) information of neuroblasts\nExtended Data Fig. 2). Cells from both unguided and guided protocols and neurons to the HNOCA. The transferred labels are strongly conwere distributed across all trajectories (Fig. 1f). sistent with our assigned labels (Extended Data Fig. 3) and allowed us\n To elucidate the dynamics and transitions of cell states and types, we to refine the regional annotation of HNOCA non-telencephalic NPCs\nreconstructed a real-age-informed pseudotime of HNOCA cells on the and neurons, as well as the NTT annotation of the non-telencephalic\nbasis of neural optimal transport47 using moscot48 (Fig. 1h). Focusing neurons (Fig. 2b), resulting in the final hierarchical HNOCA cell type\non the dorsal telencephalic neural trajectory, we observed consistent annotation (Extended Data Fig. 3).\npseudotemporal expression profiles of marker genes such as SOX2 We also sought to compare organoid cells to stages of human brain\n(neural progenitor cells (NPCs)), BCL11B (deeper layer cortical neurons) development beyond the first trimester. Focusing on dorsal telenand SATB2 (upper layer cortical neurons) (Fig. 1i). To further resolve cephalon, we compared the transcriptomic profile of HNOCA NPCs\nheterogeneity among non-telencephalic neurons, we performed sub- and neurons with cells in a primary atlas of human cortex development\nclustering of this population, which revealed numerous neuronal popu- spanning the first trimester to adolescence30. We observed a transition\nlations characterized by distinct marker gene expression (Fig. 1j,k). from cell states observed in the first trimester to more mature states\n observed in the second-trimester cortex (Fig. 2c), and did not detect\n substantial matching to later stages. We extended the comparison to\nHNOCA projection to a human developing brain atlas other brain regions using two primary atlases27,29 representing the first\nTo assess our cell type annotation, and more precisely annotate the and second trimester, respectively. We confirmed increased similarheterogeneous non-telencephalic neuronal populations, we com- ity to second-trimester cell states in older organoids for other brain\npared the HNOCA to a recently published single-cell transcriptomic regions (Extended Data Fig. 3).\natlas of the developing human brain27 (Fig. 2a). We applied scVI49 and We evaluated the capacity of each neural organoid protocol to generscANVI50 to the primary reference atlas, and used scArches51 to project ate neural cells of different brain regions (Fig. 2d, Extended Data Figs. 3\n\n\n692 | Nature | Vol 635 | 21 November 2024\n\na b c e f\n HNOCA Primary Fraction of protocols (f)\n\n\n Common DEGs\n Ubiquitous Inconsistent\n\n\n number (×10 )\n 2 Axongenesis Regulation of dendrite Protein\n\n\n 3\n 0 0.2 0.4 0.6 0.8 1.0 DEGs across change (59) adj –5 development phosphorylation\n (P = 3.4 × 10 )\n 0 1 neuron subtypes adj\n = 4.5 × 10–5)\n (Padj = 1.2 × 10–4)\n (P\n Neuron cell–cell adhesion\n\n\n (DE in \u001e f of protocols)\n (n = 920)\n\n\n Fraction of DEGs\n N-VGLUT (Padj = 3.4 × 10–5)\n Regulation of neuron Regulation\n Neuron region/NTT separated 0.2 Down- projection dev. (P = 1.5 × 10–4) of cation\n adj\n 0 channel\n 1 8 16 regulated Synapse organization activity\n 1.0 Nervous system development\n Pseudo-bulk Pseudo-bulk 0.4 in organoid adj\n (P = 3.4 × 10 )\n –5 adj –4 adj –3\n (P = 3 × 10 ) (P = 10 )\n\n\n (DE in \u001e f of protocols)\n Number of neuron subtypes\n\n\n Fraction of DEGs\n (673)\n 0.8 d with common DE\n Protocols\n\n\n P1 0.6 Mitochondrial ATP Negative regulation of\n \u001f DEG 8 synthesis coupled release of sequestered\n\n\n Number of pairs\n P2 0.8 0.6\n 6\n electron transport\n (Padj = 2.6 × 10–5)\n calcium ion into cytosol\n adj\n (P = 7.4 × 10 )\n –3\n g Primary P = 0.001\n Upregulated\n Regions 0.4\n\n\n (×10 )\n 1.0 Neutrophil\n\n\n 3\n 4 in organoid Canonical glycolysis Organoid\n degranulation\n Dorsal telen. Dorsal MB (363) (Padj = 3.7 × 10–4) adj\n 0.2 2 (P = 8.0 × 10–3)\n Ventral telen. Ventral MB –1 0 1 2 3\n N-GABA 0 Glycolysis scores\n Hypothalamus Cerebellum 0 Electron transport score (s1)\n Thalamus Pons\n 1.0 0.8 0.6 0.4 0.2 0\n −1.0 −0.5 0 0.5 1.0\n h Primary\n P = 5.5 × 10 –7\n i s1 s2 s3\n Medulla Correlation between subtype*protocol\n Fraction of protocols (f) (across logFC of ubiquitous DEGs) P = 2.5 × 10–8 Organoid s1 Corr.\n s2 1\n 0 1 2 0 0.5\n s3 0\n Canonical\nj glycolysis (s2)\n Hallmark glycolysis (s3)\n k\n (dorsal telen. VGLUT-N)\n\n\n Guided\nGlycolysis score\n\n\n 1.0 Unguided\n\n\n d\n To cortex Telencephalon\n\n\n de\n 0.5 To others\n\n\n ui\n Dorsal\n\n\n ng\n Transcriptomic\n\n\n U\n 0 Matrigel Ventral\n similarity\n No use Diencephalon\n\n\n Organoid datasets\n −0.5 Embedded Hypothalamus\n Desolved Thalamus\n\n\n Guided\n Primary Organoid datasets Mat. media Midbrain\n No use Spearman correlation Midbrain dorsal\n Guided Used (366 variable TFs) Midbrain ventral\n Matrigel Sliced/cut 0.93 Hindbrain\n Mat. media No Cerebellum\n Sliced/cut Yes Pons\n Medulla Neural\n Shaken/spun Shaken/spun 0.32 cell type\n No Choroid plexus\n Protocol 4 10 16 2419 8 7 6 15 7 5 9 3 12 6 1 9 6 6 11 1 7 13 1 5 14 17 <20 cells in\n Yes Oligodendrocyte Regions\n Publication 2516 8 1 5 22 3 2 18 1110 27 23 2 14 9 4 23 24 2 6 20 3 7 15 13 26 the dataset NTT\n Targeting\n region Glutamatergic GABAergic\n\n\nFig. 3 | Transcriptomic comparison between organoid neurons and their electron transport module scores (g), canonical glycolysis module scores\nprimary counterpart reveals universal cell stress in organoids. a, Schematic (h, left) and the Molecular Signatures Database hallmark glycolysis module\nof DE analysis comparing neural cell types in different protocols in HNOCA scores (h, right), in primary neural cell types (upper, dark) and organoid\nto their primary counterparts27. b, Proportions of expressed genes in different counterparts (lower, light). P values, significance of a two-sided Wilcoxon test.\nneural cell types that show DE in certain fractions of protocols that generate i, Heatmap shows pairwise correlation (corr.) of the three module scores.\nthe corresponding subtypes. Top left, glutamatergic neurons; bottom j, Hallmark glycolysis score of dorsal telencephalic excitatory neurons (dTelen\nright, GABAergic neurons. Colour shows the brain region. c, Numbers of VGLUT-N), split by the three primary developing human brains and 27 organoid\nprotocol-common DEGs (DE in at least half of protocols), grouped by the datasets with at least 20 dTelen VGLUT-N. The lower panel shows selected\nnumber of neural cell types in which a gene is DE. d, Distribution of expression features of differentiation protocols that may be relevant to cell stress. The\nlog-fold-change (logFC) correlation of ubiquitous DEGs among different neuron protocol and publication indices are shown in Extended Data Fig. 1. Mat. media,\nsubtype*protocol (that is, each of the neural cell types generated by each of maturation media. k, Spearman correlations between gene expression profiles\nthe different protocols). e, Numbers of DEGs per category. f, Gene ontology of neural cell types in HNOCA and those in the human developing brain atlas27,\nenrichment analysis of downregulated (upper, blue) and upregulated (lower, across the variable transcription factors (TFs). Datasets are in the same order as\nred) ubiquitous DEGs. Sizes of the squares correlate with −log-transformed in Supplementary Table 1.\nadjusted P values. g,h, Distribution of the mitochondrial ATP synthesis-coupled\n\n\nand 4 and Supplementary Table 2). Datasets of unguided neural orga- dorsal midbrain m1-derived GABAergic neurons and m1/m2-derived\nnoids contain cells across all brain regions with proportions varying glutamatergic neurons, and cerebellar Purkinje cells (Fig. 2f,g). It is\nacross datasets, indicating the capacity of unguided protocols to gener- worth noting that, even though these cell types are less abundant in\nate many brain regions but with high variability. By contrast, datasets HNOCA datasets than in the primary atlas, certain organoid protocols\nderived from guided organoid protocols are strongly enriched for cells can generate some of these under-represented cell types (for example,\nof the targeted brain region, but often show an increased proportion Purkinje cells in posterior brain organoid protocols).\nof cells of the brain regions neighbouring the targeted regions. For\nexample, several datasets derived from midbrain organoid protocols\nalso show high proportions of hindbrain neurons, indicating an impre- Transcriptomic fidelity organoid cell types\ncision of morphogen guidance. We next aimed to understand the transcriptomic similarities and dif-\n To comprehensively evaluate how well organoid protocols repre- ferences between organoids generated by distinct differentiation\nsented by the HNOCA generate primary brain cell types, we estimated protocols as well as between organoids and primary brain tissue. We\npresence scores for every primary cell type in each HNOCA dataset identified differentially expressed genes (DEGs), comparing neural\n(Methods). A large presence score indicates high frequency and likeli- cell types in the HNOCA with their primary counterparts27 (Fig. 3a and\nhood that cells of a similar type are observed in the HNOCA dataset. By Supplementary Table 4). We found that for most neural cell types,\nnormalizing the scores per organoid dataset (Extended Data Fig. 5 and more than one-third (mean 34.4%, standard deviation 12.1%) of DEGs\nSupplementary Table 3), we obtained a metric to describe how well each were shared across at least half of the protocols (protocol-common\nprimary cell type is represented in at least one HNOCA dataset (Fig. 2d). DEGs), suggesting that many transcriptomic differences between\nThis analysis confirmed the absence of erythrocytes, immune cells organoid and primary cells were independent of organoid protocol\nand vascular endothelial cells in the HNOCA, all of which are derived (Fig. 3b). We verified our results using an extra primary human cortex\nfrom non-neuroectodermal germ layers (Fig. 2e). As expected, tel- scRNA-seq dataset28 (Extended Data Fig. 6 and Supplementary Table 5).\nencephalic cell types are most strongly represented in HNOCA. By We next assessed differential transcriptomic programmes that were\ncontrast, cell types of the thalamus, midbrain and cerebellum are least shared across regional neural cell types, and identified a total of 920\nrepresented, including thalamic reticular nucleus GABAergic neurons, ubiquitous, protocol-common DEGs (uDEGs) that were differentially\n\n\n Nature | Vol 635 | 21 November 2024 | 693\n\nArticle\na b c\n Neural organoid Project to primary/HNOCA\n\n\n Annotated region\n CHIR, SAG SAG CHIR BMP FGF Other\n morphogen screen Forebrain\n 44\n (Amin et al. ) Midbrain\n\n\n Fraction\n Hindbrain\n Non-specific\n Un-annotated\n scRNA-seq Annotated Compare with\n\n\n yp ub at s\n\n\n er Prain\n Th ph us\n\n\n M ellu s\n H S Stri pux\n Di ot co um\n\n\n la\n M lamon\n ce lamex\n\n\n b s\n\n\n ed m\n (50 conditions) region organoid atlas\n\n\n n\n me\n\n\n id u\n\n\n ul\n ca rt\n\n\n eb o\n en ha rt\n\n a al\n Condition\n\n\n po Co\n Forebrain • Annotation\n Condition groups Midbrain Brain region\n Fraction\n\n\n C\n ip\n SAG BMP Hindbrain • Protocol matching Cortex Diencephalon Cerebellum\n\n\n H\n CHIR, SAG FGF Non-specific • Novelty assessment of predicted Hippocampus Hypothalamus Pons\n CHIR Other Un-annotated Predicted region Subcortex Thalamus Medulla\n Striatum Midbrain\n 0 1\n\nd Cell class e Brain region\n Radial glia\n Neuronal IPC\n Neuroblast\nProtocol/condition\n\n\n Neuron\n Glioblast\n Oligo\n Placodes\n Immune\n Vascular\n Erythrocyte\n Neural crest\n Fibroblast\n Presence score\n Max.-presence\n esence\n Depleted Enriched sscore (Amin et al.44)\n Non-neural Subregion\nOrigin Cell class Depleted\n Dep Enriched\n 27\n HNOCA Protocol: Guided Unguided Clusters (primary (Braun et al. )) (in all conditions)\n c (in \u001f1 condition)\n Amin et al.44 Condition group\n\nf g h Subpallial Midbrain\n 364 GABAergic DA neuron\n neuron LHX6 TH\n in NOMS over HNOCA\n\n\n Cluster 364 Cluster 443 Cluster 385 Cluster 448\n Gained coverage\n\n\n 1.00 ACKR3 EN1\n\n\n Primary\n Inhib. neuron Inhib. neuron DA neuron Inhib. neuron MPPED1\n 0.75 (LHX6, ACKR3, (LHX8, CA10) (TH1, EN1) (GATA3, CDH8) Co-expression\n MPPED1) (min. gene expression)\n 0.50\n\n 0.25 0 Max.\n Conditions Conditions\n\n\n 44\n Amin et al.\n 0\n 385\n Telencephalon Diencephalon Midbrain Pons Cereb. Medulla\n Gained clusters\n Clusters (primary (Braun et al.27))\n\nFig. 4 | Projection of neural organoid morphogen screen scRNA-seq data to The heatmap shows average presence scores per cluster in the primary\nHNOCA and human developing brain atlas allows cell type annotation and reference (columns). e, UMAP of primary reference coloured by the dissected\norganoid protocol evaluation. a, Schematic of projecting neural organoid regions (right) and the maximum presence scores across the screen conditions\nmorphogen screen44 scRNA-seq data to the HNOCA, and a human developing (left). f, Gain of cell cluster coverage of screen conditions relative to HNOCA\nbrain reference atlas27. UMAPs show screen condition groups (left, using datasets, with negative values trimmed to zero. The grey horizontal line shows\nmorphogens SAG (sonic hedgehog signaling agonist), CHIR, BMP and FGF) the threshold (0.3) to define gained clusters in screen data. g, UMAP of the\nand regional annotation of screen data (right). b, Comparison of regional primary reference, with gained clusters highlighted in shades of blue. Dashed\nannotation of screen data (rows) and scArches-transferred regional labels from circles highlight two clusters with highest gain of coverage in telencephalon\nthe primary reference. c, Proportions of cells assigned to different regions on and midbrain, respectively. h, Coexpression scores of cluster marker genes of\nthe basis of reference projection. Every stacked bar represents one screen the two clusters highlighted in g, in the primary reference (upper) and screen\ncondition. d, Clustering of HNOCA datasets with conditions in the screen data dataset (lower). DA, dopaminergic.\non the basis of average presence scores of clusters in the primary reference.\n\n\nexpressed in at least 14 out of the 16 neural cell types (Fig. 3c). These cells (Fig. 3g,h). Using the datasets from refs. 3 and 27 as representauDEGs showed consistent fold changes (r > 0.8) across neuron types tive examples, we identified a similar distribution of glycolysis scores\nand protocols (Fig. 3d), and represent consistent molecular differences across all neural cell types with an overall increased score in organoid\nbetween neurons in organoids and those in primary tissues regardless cells (Extended Data Fig. 7). Focusing on dorsal telencephalic neurons,\nof protocol or neuronal cell type. Out of all 920 uDEGs, 363 genes were we compared the distribution of glycolysis scores across organoid difconsistently upregulated and 673 genes were consistently downregu- ferentiation protocols and identified several protocol features that corlated, with only 59 genes (6%) inconsistently differentially expressed related with metabolic cell stress. For instance, the usage of maturation\nacross subtypes or protocols (Fig. 3e). media, slicing or cutting of organoids and, to a lesser extent, shaking\n Using gene ontology enrichment analysis52,53 on the uDEGs, we found or spinning of organoids led to overall lower glycolysis scores (Fig. 3h).\ndownregulated uDEGs enriched in neurodevelopmental processes Mean glycolysis score and transcriptomic similarity of organoid and\nincluding neuron cell–cell adhesion and synapse organization (Fig. 3f). primary reference cell types27 across differentiation protocols were\nUpregulated uDEGs were enriched in many metabolism-associated negatively correlated10,24. The correlation was significantly reduced\nterms including mitochondrial ATP synthesis-coupled electron trans- when considering only variable transcription factors, indicating that\nport (electron transport in short) and canonical glycolysis (Fig. 3f). the metabolic changes in organoids have limited impact on the core\nAn enrichment of energy-associated pathways has previously been molecular identity of neuronal cell types (Extended Data Fig. 7). This\nassociated with metabolic changes caused by the limitations of cur- observation is consistent with previous studies23,24 of distinct metabolic\nrent culture conditions10,24. Also, the Molecular Signatures Database states of cells in neural organoids relative to the primary tissue, which\ngene set hallmark glycolysis54,55 has previously been used to define were shown to not affect neuron fate specification and maturation.\nmetabolic states in neural organoids23. Scoring mitochondrial elec- Next, we focused on the expression of 366 variable transcription\ntron transport, canonical glycolysis and hallmark glycolysis gene sets factors to calculate the correlation between corresponding neuronal\nacross the HNOCA and the primary reference atlas27, we found that all cell types in the HNOCA datasets and the primary reference atlas27.\nthree terms showed significant separation of organoid and primary We found that both guided and unguided organoid differentiation\n\n\n694 | Nature | Vol 635 | 21 November 2024\n\na UMAP manifold b c Region\n 409,000 cells Astrocyte Ventral\n Cell type and regional Dorsal telencephalon\n OPC telen. Dorsal telen.\n annotation Ventral telencephalon\n NPC glutamatergic\n Matched HNOCA Hypothalamus\n metacell neuron Thalamus\n Primary\n 11 publications 27\n (Braun et al. ) Differential Glioblast Dorsal midbrain\n 10 diseases HNOCA expression Ventral midbrain\n Dorsal Cerebellum\n Microglia telen. Pons\n Mapping NPC Medulla\n g Ventral telen.\n NE NPC IP Neuron Glioblast Astrocyte OPC CP GABAergic\n 1.0 Microglia\n MC neuron d e Control\n Disease\n Cell type prop.\n\n\n 0.8 NC-D\n 0.6 EC Neuro-\n MC epithelium Non-telen.\n 0.4 Non-telen. neuron\n 0.2 NPC\n Control\n 0 Status Disease-modelling\n h 1.0\n publication Publications Status\n NH-2022 SZ-2022\nRegion prop.\n\n\n 0.8\n f\n of neurons\n\n\n GBM-2019 PTHS-2022\n SOX2 MAP2 GFAP OLIG1 EMX1\n 0.6 FXS-2021 ALS-2021\n\n\n Expression\n 0.4 NH-2019 AD-2023 Max.\n ASD-2023 MC-2020\n 0.2\n DM1-2022\n 0\n Telencephalon Diencephalon Midbrain Hindbrain 0\n Dorsal Hypothalamus Dorsal Cerebellum\n Ventral Thalamus Ventral Pons\n Medulla SFARI enrichment\n (log2(OR))\n i j k l Pseudobulk samples m −1 0 1\n Control Disease-\n modelling Expr P = 0.004\n Transcriptomic similarity\n\n\n Publications Max. P = 0.996\n Query\n to HNOCA metacells\n\n\n 1.0 XRCC6 FMR1 MEIS2\n Celli 0.94\n Comparison ACTB RBM27 SFARI\n\n\n Top DEGs\n 0.8 No\n Min.\n 10 Yes\n\n\n −log10(Adjusted P)\n CHD2\n 0.6 GNAS\n kNNs Wi RBM25 GTF2I\n Average CALD1\n FABP5 KMT2A\n 0.4 HNRNPU PABPC1 DYNC1H1 DE\n Metacelli 5 KMT2E Non-DE\n 0.2 SPARC Up\n 0 Down\n 0\n Reference 0\n GBM FXS GBM Matched Control HNOCA −1.0 −0.5 0 0.5 1.0\n HNOCA astrocytes astrocytes\n metacells in diseases logFC(FXS − HNOCA)\n\nFig. 5 | The HNOCA as a control cohort to facilitate cell type annotation and publication. Left, distribution in control cells and right, distribution in disease\ntranscriptomic comparison for neural organoid disease-modelling data. cells. l, Heatmap showing expression of top DEGs between the AQP4+ population\na, Overview of disease-modelling neural organoid atlas construction, and in the GBM-2019 dataset and their matched HNOCA metacells. Rows show\nprojection to primary atlas27 and HNOCA for downstream analysis. b–f, UMAP DEGs with the ten strongest decreased and increased expressions. Columns\nof integrated disease-modelling neural organoid atlas coloured by predicted show average expression in the AQP4+ population of disease-modelling samples\ncell type annotation (b), predicted regional identities of NPCs, intermediate (first panel), the matched HNOCA metacells per sample (second panel), all\nprogenitor cells and neurons (c), publications (d), disease status (e) and marker predicted control astrocytes and all astrocytes in HNOCA. m, Volcano plot\ngene expression (f). g,h, Proportions (prop.) of cells assigned to different cell shows DE analysis between dorsal telencephalic cells in the FXS-2021 dataset\nclasses (g) and regions (h). Every stacked bar represents one biological sample. and their matched HNOCA metacells. DEGs coloured in red (increased in\nSide bars show disease status and publication. i, Schematic of reconstructing FXS) and blue (decreased in FXS). Encircled dots show DEGs annotated in\nmatched HNOCA metacell for each cell in the disease-modelling neural SFARI database. Top bars show the log-transformed odds ratio of SFARI gene\norganoid atlas. j, UMAP of disease-modelling neural organoid atlas, coloured enrichment in the increased (red) and decreased (blue) DEGs. GBM,\nby transcriptomic similarity with the matched HNOCA metacells. k, Violin plot glioblastoma.\nindicates distribution of estimated transcriptomic similarities, split by\n\n\nprotocols generated neuronal cell types with comparable similarity to are deficient in these processes. Of note, these differences are observed\nthe corresponding primary reference cell types. However, we observed across organoid protocols, and highlight areas of consistent transcripbrain region-dependent differences in transcriptomic similarity. For tomic divergence between in vitro and primary counterparts.\nexample, organoid neurons from the dorsal parts of most brain regions\nshowed higher similarity to their primary counterparts across organoid\ndatasets than cell types derived from the ventral parts of most brain HNOCA facilitates organoid protocol evaluation\nregions (Fig. 3i). The HNOCA, as well as the analytical pipeline we established, provides\n To identify molecular features other than metabolic state that a framework to query new neural organoid scRNA-seq datasets not\ndecreased organoid fidelity, we incorporated dorsal telencephalic gluta- included in the HNOCA. To showcase this application, we retrieved\nmatergic neurons from four different primary developing human brain scRNA-seq data from a recently published multiplexed neural organoid\natlases27–30 as an integrated primary reference, and identified neuron morphogen screen44 and projected them to the HNOCA and primary refsubtype and maturation state heterogeneity (Extended Data Fig. 8). erence27 latent spaces (Fig. 4a, Extended Data Fig. 9 and Supplementary\nProjection of dorsal telencephalic neurons in the HNOCA to the pri- Table 7). We transferred regional labels and found high consistency with\nmary atlases revealed the corresponding heterogeneity in neural orga- the provided regional annotation, but with higher resolution within\nnoids. Considering metabolic state, maturation state and cell subtype each of the broad brain sections of forebrain, midbrain and hindbrain\nas covariates during DE analysis3 significantly reduced the number of (Fig. 4b). Our transferred annotation therefore allowed a more compre-\nDEGs, supporting the idea that these are the major factors differentiating hensive assessment of the effects of different morphogen conditions\norganoid and primary brain cells (Extended Data Fig. 8 and Supplemen- on generating neurons of different brain regions (Fig. 4c). We further\ntary Table 6). We observed enriched biological processes that included calculated presence scores for reference cells in each screen condition\nsynaptic vesicle cycle and negative regulation of high voltage-gated cal- and compared the data of the different screen conditions with the 36\ncium channel activity (Extended Data Fig. 8), suggesting that organoids HNOCA datasets. Using hierarchical clustering on average presence\n\n\n Nature | Vol 635 | 21 November 2024 | 695\n\nArticle\na b 72 73\n Bertucci et al. Caporale et al. Dony et al.\n 75 c\n Predicted cell type\n HNOCA\n core PSC NPC\n NE Dorsal telen.\n Community NC-D Ventral telen.\n MC Non-telen.\n edition EC\n Giandomenico Lopez-Tobon Wang et al.71 Neuron\n et al.\n 70\n et al.\n 74 CP Dorsal telen.\n Glioblast Ventral telen.\n Astrocyte Non-telen.\n OPC\n HNOCA core\n Extension\n\n\nd e Transcriptomic similarity\n f\n Scaled Percentage\n expression expressed 20 40 60 80100 to HNOCA core metacells HNOCA Browsing Cell type\n 0 1 0.4 0.8\n core data transfer\n Neuroepithelium Neuroepithelium\n Dorsal telen. NPC Dorsal telen. NPC Community\n Dorsal telen. IP Dorsal telen. IP edition DE General label Matched DE\nDorsal telen. neuron Dorsal telen. neuron analysis transfer analysis\n Ventral telen. NPC Ventral telen. NPC\nVentral telen. neuron Ventral telen. neuron\n Non-telen. NPC Primary\n Non-telen. NPC Non-telen. neuron reference Reference Presence\n Non-telen. neuron CP mapping scores\n CP Glioblast\n Glioblast OPC\n Astrocyte Astrocyte Query Marker-based Cell Transcriptomic\n OPC NC derivatives dataset annotation matching similarity\n NC derivatives MC\n MC Interface\n i le y o n g\n Percentage of cc ra on nic bo an CELLxGENE\n cells rtu apo D me -To W Web Python HNOCA tools\n Be\n SOX2\n NES\n MAPT\n TTR\n HOPX\n AQP4\n OLIG1\n SOX10\n DCN\n FOXG1\n EMX1\n EOMES\n SLC17A7\n DLX2\n GAD1\n LHX5\n\n\n C d o ez interface ArchMap API\n 20 40 60 an Lop\n Gi\n\n\nFig. 6 | Extending the HNOCA by means of projection of extra datasets. a, selected cell type and regional markers across projected cell types in the\nSchematic of projecting further scRNA-seq data by the community to extend extended HNOCA datasets. e, Dot plot shows cell type composition and\nthe HNOCA. b, UMAP shows the dataset composition of the current extended average similarity to the matched HNOCA metacells of the extended datasets.\nHNOCA. c, UMAP shows the projected cell type annotation of cells in the five f, Schematic shows the analytical pipelines and varied interfaces to facilitate\nextended datasets. NE, neuroepithelium; NC-D, neural crest derivatives; analysing scRNA-seq data of neural organoids for the community.\nMC, mesenchymal cell; EC, endothelial cell. d, Dot plot shows the expression of\n\n\nscores revealed distinct presence score profiles for many screen condi- We developed a wkNN-based strategy to generate matched HNOCA\ntions (Fig. 4d), suggesting regional cell type composition distinct from metacells for every cell in each disease model organoid scRNA-seq\nthe HNOCA datasets. Next, we summarized the max presence scores dataset (Fig. 5i), and quantified their transcriptomic similarity (Fig. 5j).\nfor the whole morphogen screen data (Fig. 4e), and compared them The dataset of glioblastoma organoids64 showed substantially lower\nto those for the HNOCA data to identify primary reference cell types similarity to their primary counterpart than the other disease models\nwith increased presence in the screen (Fig. 4f). This analysis highlighted (Fig. 5k). To assess these transcriptomic differences, we performed\nseveral reference cell clusters with significant abundance increase DE analysis between glioblastoma and matched control metacells.\nunder certain screen conditions (Fig. 4g) such as LHX6/ACKR3/MPPED1 Focusing on the AQP4+ population (Extended Data Fig. 10), we identitriple-positive GABAergic neurons in the ventral telencephalon and fied 1,951 DEGs in glioblastoma cells compared to matched HNOCA\ndopaminergic neurons in ventral midbrain. In summary, the projection metacells (Supplementary Table 9) and found increased expression of\nof the morphogen screen query data to HNOCA and primary reference genes such as RBM25 (ref. 65) CALD1 (ref. 66), HNRNPU67 and SPARC68\nallowed a refined annotation of the morphogen screen data, as well (Fig. 5l), all of which have been reported to be relevant to glioblastoma.\nas a comprehensive and quantitative evaluation of the value of new Next, we focused on the organoid model of FXS58, in which NPCs\ndifferentiation protocols to generate neuronal cell types previously and neurons in the control organoids were of non-telencephalic\nunder-represented or lacking in neural organoids. identities whereas the disease model organoids mainly contained\n telencephalic cells (Fig. 5h and Extended Data Fig. 10). The integrated\n HNOCA provides the opportunity to perform DE analysis for FXS neo-\nHNOCA facilitates disease model interpretation cortical neurons with matched HNOCA metacells, which identified 444\nWe next tested whether the integrated HNOCA can serve as a control DEGs. DEGs higher expressed in FXS cells (122 genes) were enriched\ncohort for assessing organoid models of neural disease. We collected for autism-associated genes annotated in the Simons Foundation\n11 scRNA-seq datasets from 10 neural organoid disease models and Autism Research Initiative (SFARI) database. One such gene, CHD2,\ntheir respective controls (microcephaly56, amyotrophic lateral scle- was reported in the original publication58 as a key regulator of FXS\nrosis43, Alzheimer’s disease57, autism42, fragile-X syndrome (FXS)58, with increased protein level, but its expression change on messenger\nschizophrenia59, neuronal heterotopia60,61, Pitt–Hopkins syndrome62, RNA (mRNA) level change could not be detected in a bulk RNA-seq\nmyotonic dystrophy63 and glioblastoma64) (Fig. 5a, Extended Data Fig. 10 experiment. We also detected decreased expression of FMR1, whose\nand Supplementary Table 8). We projected the data to the HNOCA and loss-of-function mutation causes FXS69.\nthe primary reference atlas to transfer annotations (Fig. 5b–f). We\nfound differences in cell type and brain regional composition between\ndisease model organoids and their respective, study-specific control Extending the HNOCA through data projection\norganoids for most studies (Fig. 5g,h). These differences might repre- New scRNA-seq datasets of human neural organoids continue to be\nsent disease phenotypes, but could also be the consequence of cell line generated, and it will be important to continuously extend and update\nvariability. It is therefore important to properly annotate the cell type the HNOCA with this extra data. We therefore established a computaand regional composition of disease and control organoids to identify tional toolkit to project new scRNA-seq data to the HNOCA (Fig. 6a).\ndisease phenotypes, particularly when analysing disease-associated We demonstrate the use of the toolkit by incorporating scRNA-seq data\ntranscriptomic alterations in a given cell type. from six more studies70–75 into the HNOCA (HNOCA-extended; Fig. 6b\n\n\n696 | Nature | Vol 635 | 21 November 2024\n\nand Supplementary Table 10), using query-to-reference mapping. We annotation and provides a large control cohort of single-cell transcripharmonized cell type annotations using wkNN-based label transfer, tomes for comparison. For example, we observed discrepancy of cell\nand placed the cells in the context of the existing organoid single-cell type and regional composition between control and disease model\ntranscriptomic landscape as represented by the HNOCA (Fig. 6c–e). samples in many studies. At the same time, the HNOCA provides the\nMapping further datasets to the HNOCA using our approach enhances opportunity to identify disease-specific molecular features against a\nthe atlas by increasing its coverage over existing neural organoid pro- multi-line multi-protocol large-scale control cohort.\ntocols and neural cell types generated in organoids. We demonstrate how the HNOCA can be extended and updated by\n To enable researchers to use the HNOCA in their own analysis, we projecting extra single-cell transcriptomic data of neural organoids\nprovide various options for exploration and interaction with the atlas to the atlas. Further, we have developed a computational toolkit,\n(Fig. 6f). The HNOCA can be browsed through an online portal76, ena- HNOCA-tools, which will enable other researchers to recapitulate the\nbling visualization of gene expression and discovery of marker genes. analytic framework applied in our study. Together, we imagine that the\nWe also provide the HNOCA through an online interface (http://www. HNOCA will be kept up to date and continue to reflect the landscape\narchmap.bio/) for the interactive mapping of new datasets, enabling of human neural cell states generated in organoids in vitro, serving as\nlabel transfer, presence score computation and metabolic scoring of a living resource for the neural organoid community that enables the\ncell states. Finally, we have developed HNOCA-tools, a Python pack- assessment of organoid fidelity, the characterization of perturbed and\nage implementing all central analysis approaches presented in this diseased states and the development of new protocols.\npaper, such as annotation, reference mapping, label transfer and DE\ntesting methods.\n Online content\n Any methods, additional references, Nature Portfolio reporting summa-\nDiscussion ries, source data, extended data, supplementary information, acknowl-\nIn this study, we built a large-scale integrated cell atlas of human neural edgements, peer review information; details of author contributions\norganoids, the HNOCA, by integrating 1.8 million cells spanning 36 and competing interests; and statements of data and code availability\nscRNA-seq datasets generated by 15 different laboratories worldwide are available at https://doi.org/10.1038/s41586-024-08172-8.\nusing 26 different differentiation protocols as well as diverse scRNAseq technologies. The resulting atlas revealed the high complexity 1. Birey, F. et al. Assembly of functionally integrated human forebrain spheroids. Nature\nof neuronal, glial and non-neural cell types that can develop in neu- 545, 54–59 (2017).\nral organoids grown under existing protocol conditions. Mapping 2. Sloan, S. A. et al. Human astrocyte maturation captured in 3D cerebral cortical spheroids\n derived from pluripotent stem cells. Neuron 95, 779–790.e6 (2017).\nthe HNOCA data to various human developing brain cell reference 3. Kanton, S. et al. Organoid single-cell genomic atlas uncovers human-specific features of\natlases27–30 allowed comprehensive evaluation of neural organoid pro- brain development. Nature 574, 418–422 (2019).\n 4. Marton, R. M. et al. Differentiation and maturation of oligodendrocytes in human threetocols to generate cell types of different brain regions. We found that\n dimensional neural cultures. Nat. Neurosci. 22, 484–491 (2019).\norganoids in the first 3 months of culture best match to first-trimester 5. Trujillo, C. A. et al. Complex oscillatory waves emerging from cortical organoids model\nprimary data, whereas organoids around 3 months of culture and older early human brain network development. Cell Stem Cell 25, 558–569.e7 (2019).\n 6. Velasco, S. et al. Individual brain organoids reproducibly form cell diversity of the human\nbest match second-trimester primary cell states. We did not observe\n cerebral cortex. Nature 570, 523–527 (2019).\nsignificant neuronal maturation and diversification signatures match- 7. Xiang, Y. et al. hESC-derived thalamic organoids form reciprocal projections when fused\ning older developmental stages, suggesting a limitation of neuronal with cortical organoids. Cell Stem Cell 24, 487–497.e7 (2019).\n 8. Yoon, S.-J. et al. Reliability of human cortical organoid generation. Nat. Methods 16, 75–78\nmaturation in current neural organoid protocols.\n (2019).\n We performed DE analysis between organoid neuron types and their 9. Andersen, J. et al. Generation of functional human 3D cortico-motor assembloids. Cell\nprimary counterparts to evaluate transcriptomic fidelity, and identi- 183, 1913–1929.e26 (2020).\n 10. Bhaduri, A. et al. Cell stress in cortical organoids impairs molecular subtype specification.\nfied metabolic changes related to the glycolysis pathway as a main\n Nature 578, 142–148 (2020).\nfactor that distinguishes organoid and primary cell states, consistent 11. Miura, Y. et al. Generation of human striatal organoids and cortico-striatal assembloids\nwith previous reports. Despite the negative effects of metabolic stress from human pluripotent stem cells. Nat. Biotechnol. 38, 1421–1430 (2020).\n 12. Pellegrini, L. et al. Human CNS barrier-forming organoids with cerebrospinal fluid\non overall transcriptomic fidelity, the molecular identity of regional\n production. Science 369, eaaz5626 (2020).\ncell types is maintained as evidenced by transcription factor coexpres- 13. Qian, X. et al. Sliced human cortical organoids for modeling distinct cortical layer\nsion patterns that are highly consistent with primary counterparts. formation. Cell Stem Cell 26, 766–781.e9 (2020).\n 14. Sawada, T. et al. Developmental excitation-inhibition imbalance underlying psychoses\n We showcased the mapping of query data, a recently published revealed by single-cell analyses of discordant twins-derived cerebral organoids. Mol.\nsingle-cell transcriptomic neural organoid morphogen screen, to the Psychiatry 25, 2695–2711 (2020).\nHNOCA and the primary reference, which enabled a refined cell type 15. Khan, T. A. et al. Neuronal defects in a human cellular model of 22q11.2 deletion syndrome.\n Nat. Med. 26, 1888–1898 (2020).\nannotation, as well as a compositional comparison with existing neural 16. Bowles, K. R. et al. ELAVL4, splicing, and glutamatergic dysfunction precede neuron loss\norganoid datasets. Our powerful framework will facilitate quantitative in MAPT mutation cerebral organoids. Cell 184, 4547–4563.e17 (2021).\nand comparative analysis of scRNA-seq data of human neural organoids, 17. Fiorenzano, A. et al. Single-cell transcriptomics captures features of human midbrain\n development and dopamine neuron diversity in brain organoids. Nat. Commun. 12, 7302\nand for the benchmarking of new neural organoid protocols. (2021).\n Consistent with earlier reports3,77, we find that unguided protocols 18. Huang, W.-K. et al. Generation of hypothalamic arcuate organoids from human induced\ngenerate neural cells with high brain regional variability, which is useful pluripotent stem cells. Cell Stem Cell 28, 1657–1670.e10 (2021).\n 19. Samarasinghe, R. A. et al. Identification of neural oscillations and epileptiform changes in\nwhen studying broader fate determination during neurodevelopment. human brain organoids. Nat. Neurosci. 24, 1488–1500 (2021).\nGuided protocols resulted in a strong enrichment of the targeted 20. Fleck, J. S. et al. Inferring and perturbing cell fate regulomes in human brain organoids.\nbrain regions. We also note that some guided protocols, particularly Nature https://doi.org/10.1038/s41586-022-05279-8 (2022).\n 21. He, Z. et al. Lineage recording in human cerebral organoids. Nat. Methods 19, 90–99 (2022).\nthose targeting midbrain, show relatively low specificity and generate 22. Kelava, I., Chiaradia, I., Pellegrini, L., Kalinka, A. T. & Lancaster, M. A. Androgens increase\nneural cells from the nearby brain regions. This issue may be due to a excitatory neurogenic potential in human brain organoids. Nature 602, 112–116 (2022).\ndifferential response of neural stem cells in the organoid to the same 23. Uzquiano, A. et al. Proper acquisition of cell class identity in organoids allows definition of\n fate specification programs of the human cerebral cortex. Cell 185, 3770–3788.e27 (2022).\nmorphogen cue, or to the lack of a full understanding of the timing, 24. Vértesy, Á. et al. Gruffi: an algorithm for computational removal of stressed cells from\nconcentration and combinations of morphogens required to precisely brain organoid transcriptomic datasets. EMBO J. 41, e111118 (2022).\ndefine cells of the deeper regions in the central nervous system. 25. Atamian, A. et al. Human cerebellar organoids with functional Purkinje cells. Cell Stem\n Cell 31, 39–51.e6 (2024).\n The integrated HNOCA is also an excellent resource for analysis 26. Paulsen, B. et al. Autism genes converge on asynchronous development of shared\nof disease-modelling neural organoid data. It facilitates cell type neuron classes. Nature 602, 268–273 (2022).\n\n\n Nature | Vol 635 | 21 November 2024 | 697\n\nArticle\n27. Braun, E. et al. Comprehensive cell atlas of the first-trimester developing human brain. 61. Klaus, J. et al. Altered neuronal migratory trajectories in human cerebral organoids\n Science 382, eadf1226 (2023). derived from individuals with neuronal heterotopia. Nat. Med. 25, 561–568 (2019).\n28. Eze, U. C., Bhaduri, A., Haeussler, M., Nowakowski, T. J. & Kriegstein, A. R. Single-cell atlas 62. Papes, F. et al. Transcription Factor 4 loss-of-function is associated with deficits in\n of early human brain development highlights heterogeneity of human neuroepithelial progenitor proliferation and cortical neuron content. Nat. Commun. 13, 2387\n cells and early radial glia. Nat. Neurosci. 24, 584–594 (2021). (2022).\n29. Bhaduri, A. et al. An atlas of cortical arealization identifies dynamic molecular signatures. 63. Morelli, K. H. et al. MECP2-related pathways are dysregulated in a cortical organoid\n Nature 598, 200–204 (2021). model of myotonic dystrophy. Sci. Transl. Med. 14, eabn2375 (2022).\n30. Wang, L. et al. Molecular and cellular dynamics of the developing human neocortex at 64. Jacob, F. et al. A patient-derived glioblastoma organoid model and biobank recapitulates\n single-cell resolution. Preprint at bioRxiv https://doi.org/10.1101/2024.01.16.575956 (2024). inter- and intra-tumoral heterogeneity. Cell 180, 188–204.e22 (2020).\n31. Velasco, S., Paulsen, B. & Arlotta, P. 3D Brain organoids: studying brain development and 65. Brennan, C. W. et al. The somatic genomic landscape of glioblastoma. Cell 155, 462–477\n disease outside the embryo. Annu. Rev. Neurosci. 43, 375–389 (2020). (2013).\n32. Sidhaye, J. & Knoblich, J. A. Brain organoids: an ensemble of bioassays to investigate 66. Cheng, Q. et al. CALD1 modulates gliomas progression via facilitating tumor angiogenesis.\n human neurodevelopment and disease. Cell Death Differ. 28, 52–67 (2020). Cancers 13, 2705 (2021).\n33. Pașca, S. P. et al. A nomenclature consensus for nervous system organoids and 67. Pavlyukov, M. S. et al. Apoptotic cell-derived extracellular vesicles promote malignancy\n assembloids. Nature 609, 907–910 (2022). of glioblastoma via intercellular transfer of splicing factors. Cancer Cell 34, 119–135.e10\n34. Paşca, A. M. et al. Functional cortical neurons and astrocytes from human pluripotent (2018).\n stem cells in 3D culture. Nat. Methods 12, 671–678 (2015). 68. Rich, J. N. et al. Gene expression profiling and genetic markers in glioblastoma survival.\n35. Jo, J. et al. Midbrain-like organoids from human pluripotent stem cells contain functional Cancer Res. 65, 4051–4058 (2005).\n dopaminergic and neuromelanin-producing neurons. Cell Stem Cell 19, 248–257 (2016). 69. Mila, M., Alvarez-Mora, M. I., Madrigal, I. & Rodriguez-Revenga, L. Fragile X syndrome: an\n36. Lancaster, M. A. et al. Cerebral organoids model human brain development and overview and update of the FMR1 gene. Clin. Genet. 93, 197–205 (2018).\n microcephaly. Nature 501, 373–379 (2013). 70. Giandomenico, S. L. et al. Cerebral organoids at the air-liquid interface generate diverse\n37. Quadrato, G. et al. Cell diversity and network dynamics in photosensitive human brain nerve tracts with functional output. Nat. Neurosci. 22, 669–679 (2019).\n organoids. Nature 545, 48–53 (2017). 71. Wang, M. et al. Morphological diversification and functional maturation of human\n38. Pollen, A. A. et al. Establishing cerebral organoids as models of human-specific brain astrocytes in glia-enriched cortical organoid transplanted in mouse brain. Nat. Biotechnol.\n evolution. Cell 176, 743–756.e17 (2019). https://doi.org/10.1038/s41587-024-02157-8 (2024).\n39. Camp, J. G. et al. Human cerebral organoids recapitulate gene expression programs of 72. Bertucci, T. et al. Improved protocol for reproducible human cortical organoids reveals\n fetal neocortex development. Proc. Natl Acad. Sci. USA 112, 15672–15677 (2015). early alterations in metabolism with mutations. Preprint at bioRxiv https://doi.org/10.1101/\n40. Mora-Bermúdez, F. et al. Differences and similarities between human and chimpanzee 2023.07.11.548571 (2023).\n neural progenitors during cerebral cortex development. eLife 5, e18683 (2016). 73. Caporale, N. et al. Multiplexing cortical brain organoids for the longitudinal dissection of\n41. Benito-Kwiecinski, S. et al. An early cell shape transition drives evolutionary expansion of developmental traits at single cell resolution. Preprint at bioRxiv https://doi.org/10.1101/\n the human forebrain. Cell 184, 2084–2102.e19 (2021). 2023.08.21.553507 (2023).\n42. Li, C. et al. Single-cell brain organoid screening identifies developmental defects in 74. López-Tobón, A. et al. dosage regulates neuronal differentiation and social behavior in\n autism. Nature 621, 373–380 (2023). 7q11.23 neurodevelopmental disorders. Sci. Adv. 9, eadh2726 (2023).\n43. Szebényi, K. et al. Human ALS/FTD brain organoid slice cultures display distinct early 75. Dony, L. et al. Chronic exposure to glucocorticoids amplifies inhibitory neuron cell fate\n astrocyte and targetable neuronal pathology. Nat. Neurosci. 24, 1542–1554 (2021). during human neurodevelopment in organoids. Preprint at bioRxiv https://doi.org/10.1101/\n44. Amin, N. D. et al. Generating human neural diversity with a multiplexed morphogen 2024.01.21.576532 (2024).\n screen in organoids. Preprint at bioRxiv https://doi.org/10.1101/2023.05.31.541819 (2023). 76. CZI Single-Cell Biology Program et al. CZ CELL×GENE Discover: a single-cell data\n45. De Donno, C. et al. Population-level integration of single-cell datasets enables multi-scale platform for scalable exploration, analysis and modeling of aggregated data. Preprint at\n analysis across samples. Nat. Methods 20, 1683–1692 (2023). bioRxiv https://doi.org/10.1101/2023.10.30.563174 (2023).\n46. Luecken, M. D. et al. Benchmarking atlas-level data integration in single-cell genomics. 77. Qian, X., Song, H. & Ming, G.-L. Brain organoids: advances, applications and challenges.\n Nat. Methods 19, 41–50 (2022). Development 146, dev166074 (2019).\n47. Eyring, L. et al. Unbalancedness in neural monge maps improves unpaired domain\n translation. In Proc. Twelfth International Conference on Learning Representations Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in\n https://iclr.cc/virtual/2024/poster/19548 (2024). published maps and institutional affiliations.\n48. Klein, D. et al. Mapping cells through time and space with moscot. Preprint at bioRxiv\n https://doi.org/10.1101/2023.05.11.540374 (2023). Open Access This article is licensed under a Creative Commons Attribution-\n49. Lopez, R., Regier, J., Cole, M. B., Jordan, M. I. & Yosef, N. Deep generative modeling for NonCommercial-NoDerivatives 4.0 International License, which permits any\n single-cell transcriptomics. Nat. Methods 15, 1053–1058 (2018). non-commercial use, sharing, distribution and reproduction in any medium or\n50. Xu, C. et al. Probabilistic harmonization and annotation of single-cell transcriptomics format, as long as you give appropriate credit to the original author(s) and the source, provide\n data with deep generative models. Mol. Syst. Biol. 17, e9620 (2021). a link to the Creative Commons licence, and indicate if you modified the licensed material.\n51. Lotfollahi, M. et al. Mapping single-cell data to reference atlases by transfer learning. You do not have permission under this licence to share adapted material derived from this\n Nat. Biotechnol. 40, 121–130 (2022). article or parts of it. The images or other third party material in this article are included in the\n52. Ashburner, M. et al. Gene Ontology: tool for the unification of biology. Nat. Genet. 25, article’s Creative Commons licence, unless indicated otherwise in a credit line to the material.\n 25–29 (2000). If material is not included in the article’s Creative Commons licence and your intended use is\n53. Aleksander, S. A. et al. The Gene Ontology knowledgebase in 2023. Genetics 224, not permitted by statutory regulation or exceeds the permitted use, you will need to obtain\n iyad031 (2023). permission directly from the copyright holder. To view a copy of this licence, visit http://\n54. Subramanian, A. et al. Gene set enrichment analysis: a knowledge-based approach creativecommons.org/licenses/by-nc-nd/4.0/.\n for interpreting genome-wide expression profiles. Proc. Natl Acad. Sci. USA 102,\n 15545–15550 (2005). © The Author(s) 2024, corrected publication 2024\n55. Liberzon, A. et al. The Molecular Signatures Database (MSigDB) hallmark gene set\n collection. Cell Syst. 1, 417–425 (2015). Human Cell Atlas Organoid Biological Network\n56. Wang, L. et al. Loss of NARS1 impairs progenitor proliferation in cortical brain organoids\n and leads to microcephaly. Nat. Commun. 11, 4038 (2020).\n57. Vanova, T. et al. Cerebral organoids derived from patients with Alzheimer’s disease with Neal D. Amin10,11, Kevin W. Kelley10,11, Taylor Bertucci13, Sally Temple13, Kathryn R. Bowles14,15,\n PSEN1/2 mutations have defective tissue patterning and altered development. Cell Rep. Nicolò Caporale16,17, Emanuele Villa16, Giuseppe Testa16,17, Cristiana Cruceanu3,18 &\n 42, 113310 (2023). Elisabeth B. Binder3\n58. Kang, Y. et al. A human forebrain organoid model of fragile X syndrome exhibits altered\n neurogenesis and highlights new treatment strategies. Nat. Neurosci. 24, 1377–1391 (2021). 13\n Neural Stem Cell Institute, Albany, NY, USA. 14UK Dementia Research Institute at the\n59. Notaras, M. et al. Schizophrenia is defined by cell-specific neuropathology and multiple University of Edinburgh, Edinburgh Bioquarter, Edinburgh, UK. 15Centre for Discovery Brain\n neurodevelopmental mechanisms in patient-derived cerebral organoids. Mol. Psychiatry Sciences, School of Biomedical Sciences, College of Medicine and Veterinary Medicine,\n 27, 1416–1434 (2022). The University of Edinburgh, Edinburgh, UK. 16Human Technopole, Milan, Italy. 17Department of\n60. Jabali, A. et al. Human cerebral organoids reveal progenitor pathology in EML1-linked Oncology and Hemato-Oncology, University of Milan, Milan, Italy. 18Department of Physiology\n cortical malformation. EMBO Rep. 23, e54027 (2022). and Pharmacology, Karolinska Institutet, Stockholm, Sweden.\n\n\n698 | Nature | Vol 635 | 21 November 2024",
      "rationale": "heuristic fallback",
      "detected_categories": [
        {
          "id": "dna_rna_extraction",
          "hits": 38,
          "confidence": 1.0,
          "matched_patterns": [
            "lysis"
          ]
        },
        {
          "id": "cell_culture",
          "hits": 10,
          "confidence": 1.0,
          "matched_patterns": [
            "\\bwell\\b"
          ]
        },
        {
          "id": "microscopy_imaging",
          "hits": 2,
          "confidence": 0.5,
          "matched_patterns": [
            "\\bimag"
          ]
        },
        {
          "id": "molecular_cloning",
          "hits": 2,
          "confidence": 0.286,
          "matched_patterns": [
            "transform"
          ]
        },
        {
          "id": "purification_cleanup",
          "hits": 2,
          "confidence": 0.333,
          "matched_patterns": [
            "column"
          ]
        },
        {
          "id": "animal_experiment",
          "hits": 1,
          "confidence": 0.2,
          "matched_patterns": [
            "\\bmouse\\b"
          ]
        },
        {
          "id": "sequencing_library_prep",
          "hits": 1,
          "confidence": 0.125,
          "matched_patterns": [
            "sequenc"
          ]
        }
      ],
      "split_audit": {
        "char_count": 58604,
        "word_count": 9018,
        "sentence_count": 886,
        "category_count": 7,
        "flags": [
          "UNIT_CATEGORY_OVERMIXED"
        ]
      }
    },
    {
      "title": "Methods",
      "text": "Methods\n Hierarchical auto-annotation with snapseed\nMetadata curation and harmonization of human neural Snapseed is a scalable auto-annotation strategy, which annotates cells\norganoid scRNA-seq datasets on the basis of a provided hierarchy of cell types and the corresponding\nWe included 33 human neural organoid data from a total of 25 publica- cell type markers. It is based on enrichment of marker gene exprestions1–24,26 plus three unpublished datasets in our atlas (Supplementary sion in cell clusters (high-resolution clustering is preferred), and data\nTable 1). We curated all neural organoid datasets used in this study integration is not necessarily required.\nthrough the sfaira78 framework (GitHub dev branch, 18 April 2023). For In this study, we used snapseed to obtain initial annotations for\nthis, we obtained scRNA-seq count matrices and associated metadata label-aware integration. First, we constructed a hierarchy of cell types\nfrom the location provided in the data availability section for every including progenitor, neuron and non-neural types, each defined by\nincluded publication or directly from the authors in case of unpub- a set of marker genes (Supplementary Data 1). Next, we represented\nlished data. We harmonized metadata according to the sfaira stand- the data by the RSS3 to average expression profiles of cell clusters in\nards (https://sfaira.readthedocs.io/en/latest/adding_datasets.html) the recently published human developing brain cell atlas27. We then\nand manually curated an extra metadata column organoid_age_days, constructed a kNN graph (k = 30) in the RSS space and clustered the\nwhich described the number of days the organoid had been in culture dataset using the Leiden algorithm83 (resolution 80). For both steps, we\nbefore collection. used the graphical processing unit (GPU)-accelerated RAPIDS imple-\n We next removed any non-applicable subsets of the published data- mentation that is provided through scanpy81,84.\nsets: diseased samples or samples expressing disease-associated muta- For all cell type marker genes on a given level in the hierarchy, we\ntions (refs. 14–16,18,19,26), fused organoids (ref. 1), primary fetal data computed the area under the receiver operating characteristic curve\n(refs. 10,23), hormone-treated samples (ref. 22), data collected before (AUROC) as well as the detection rate across clusters. For each cell type,\nneural induction (refs. 3,20) and share-seq data (ref. 23). We harmonized a score was computed by multiplying the maximum AUROC with the\nall remaining datasets to a common feature space using any genes of maximum detection rate among its marker genes. Each cluster was\nthe biotype ‘protein_coding’ or ‘lncRNA’ from ensembl79 release 104 then assigned to the cell type with the highest score. This procedure\nwhile filling any genes missing in a dataset with zero counts. On aver- was performed recursively for all levels of the hierarchy. The same\nage, 50% of the full gene space (36,842 genes) was reported in each of procedure was carried out using the fine (resolution 80) clustering of\nthe constituent datasets. We then concatenated all remaining datasets the unintegrated data to obtain cell type labels for the unintegrated\nto create a single AnnData80 object. dataset that were used downstream as a ground-truth input for bench-\n marking integration methods.\nPreprocessing of the HNOCA scRNA-seq data This auto-annotation strategy was implemented in the snapseed\nAll processing and analyses were carried out using scanpy81 (v.1.9.3) Python package and is available on GitHub (https://github.com/dev­\nunless indicated otherwise. For quality control and filtering of HNOCA, systemslab/snapseed). Snapseed is a light-weight package to enable\nwe removed any cells with fewer than 200 genes expressed. We next scalable marker-based annotation for atlas-level datasets in which\nremoved outlier cells in terms of two quality control metrics: the manual annotation is not readily feasible. The package implements\nnumber of expressed genes and percentage mitochondrial counts. three main functions: annotate() for non-hierarchical annotation of\nTo define outlier cells on the basis of each quality control metric, a list of cell types with defined marker genes, annotate_hierarchy()\nz-transformation is first applied to values across all cells. Cells with for annotating more complex, manually defined cell type hierarchies\nany z-transformed metric less than −1.96 or greater than 1.96 are defined and find_markers() for fast discovery of cluster-specific features. All\nas outliers. For any dataset collected using the v.3 chemistry by 10X functions are based on a GPU-accelerated implementation of AUROC\nGenomics, which contains more than 500 cells after the filtering, we scores using JAX (https://github.com/google/jax).\nfitted a Gaussian distribution to the histogram denoting the number\nof expressed genes per cell. If a bimodal distribution was detected, Label-aware data integration with scPoli\nwe removed any cell with fewer genes expressed than defined by the We performed integration of the organoid datasets for HNOCA using\nvalley between the two maxima of the distribution. We then normal- the scPoli45 model from the scArches51 package. We defined the batch\nized the raw read counts for all Smart-seq2 data by dividing it by the covariate for integration as a concatenation of the dataset identifier\nmaximum gene length for each gene obtained from BioMart. We next (annotation column ‘id’), the annotation of biological replicates (annomultiplied these normalized read counts by the median gene length tation column ‘bio_sample’) as well as technical replicates (annotation\nacross all genes in the datasets and treated those length-normalized column ‘tech_sample’). This resulted in 396 individual batches. The\ncounts equivalently to raw counts from the datasets obtained with batch covariate is represented in the model as a learned vector of size\nthe help of unique molecular identifiers in our downstream analyses. five. We used the top three levels of the RSS-based snapseed cell type\n As a next step we generated a log-normalized expression matrix by annotation as the cell type label input for the scPoli prototype loss.\nfirst dividing the counts for each cell by the total counts in that cell and We chose the hidden layer size of the one-layer scPoli encoder and\nmultiplying by a factor of 1,000,000 before taking the natural loga- decoder as 1,024, and the latent embedding dimension as ten. We used\nrithm of each count + 1. We computed 3,000 highly variable features a value of 100 for the ‘alpha_epoch_anneal’ parameter. We did not use\nin a batch-aware manner using the scanpy highly_variable_genes func- the unlabelled prototype pretraining. We trained the model for a total\ntion (flavor = ‘seurat_v3’, batch_key = ‘bio_sample’). Here, bio_sample of seven epochs, five of which were pretraining epochs.\nrepresents biological samples as provided in the original metadata of\nthe datasets. On average, 72% of the 3,000 highly variable genes were Benchmark of data integration methods\nreported in each of the constituent HNOCA datasets. We used these To quantitatively compare the organoid atlas integration results from\n3,000 features to compute a 50-dimensional representation of the several tools, we used the GPU-accelerated scib-metrics46,85 Python\ndata using principal component analysis (PCA), which in turn we used package (v.0.3.3) and used the embedding with the highest overall\nto compute a k-nearest-neighbour (kNN) graph (n_neighbors = 30, performance for all downstream analyses. We compared the data intemetric = ‘cosine’). Using the neighbour graph we computed a gration performance across the following latent representations of the\ntwo-dimensional representation of the data using UMAP82 and a coarse data: unintegrated PCA, RSS3 integration, scVI49 (default parameters\n(resolution 1) and fine (resolution 80) clustering of the unintegrated except for using two layers, latent space of size 30 and negative binomial\ndata using Leiden83 clustering. likelihood) integration, scANVI50 (default parameters) integrations\n\nArticle\nusing snapseed level 1, 2 or 3 annotation as cell type label input, scPoli45\n(parameters shown above) integrations using either snapseed level 1, 2 Reference mapping of the organoid atlas to the primary atlas\nor 3 annotation or all three annotation levels at once as the cell type label To compare our organoid atlas with data from the primary developing\ninput, scPoli45 integrations of metacells aggregated with the aggrecell human brain, we used scArches51 to project it to the above mentioned\nalgorithm (first used as ‘pseudocell’3) using either snapseed level 1 or 3 primary human brain scRNA-seq atlas27. We first pretrained a scVI\nannotation as the cell type label input to scPoli. We used the following model49 on the primary atlas with ‘Donor’ as the batch key. The model\nscores for determining integration quality (each described in ref. 46): was constructed with following parameters: n_latent = 20, n_layers = 2,\nLeiden normalized mutual information score, Leiden adjusted rand n_hidden = 256, use_layer_norm = ‘both’, use_batch_norm = ‘none’,\nindex, average silhouette width per cell type label, isolated label score encode_covariates = True, dropout_rate = 0.2 and trained with a\n(average silhouette width-scored) and cell type local inverse Simpson’s batch size of 1,024 for a maximum or 500 epochs with early stopindex to quantify conservation of biological variability. To quantify ping criterion. Next, the model was fine-tuned with scANVI50 using\nbatch-effect removal, we used average silhouette width per batch label, ‘Subregion’ and ‘CellClass’ as cell type labels with a batch size of\nintegration local inverse Simpson’s index, kNN batch-effect test score 1,024 for a maximum of 100 epochs with early stopping criterion\nand graph connectivity. Integration approaches were then ranked by and n_samples_per_label = 100. To project the organoids atlas to the\nan aggregate total score of individually normalized (into the range of primary atlas, we used the scArches51 implementation provided by\n[0,1]) metrics. Before we carried out the benchmarking, we iteratively scvi-tools88,89. The query model was fine-tuned with a batch size of\nremoved any cells from the dataset that had an identical latent repre- 1,024 for a maximum of 100 epochs with early stopping criterion\nsentation to another cell in the dataset until no latent representation and weight_decay = 0.0.\ncontained any more duplicate rows. This procedure removed a total of\n3,293 duplicate cells (0.002% of the whole dataset) and was required Bipartite weighted kNN graph reconstruction\nfor the benchmarking algorithm to complete without errors. We used With the primary reference27 and query (HNOCA) data projected to the\nthe snapseed level 3 annotation computed on the unintegrated PCA same latent space, an unweighted bipartite kNN graph was constructed\nembedding as ground-truth cell type labels in the integration. by identifying 100 nearest neighbours of each query cell in the reference\n data with either PyNNDescent or RAPIDS-cuML (https://github.com/\nPseudotime inference rapidsai/cuml) in Python, depending on availability of GPU accelera-\nTo infer a global ordering of differentiation state, we sought to infer a tion. Similarly, a reference kNN graph was also built by identifying 100\nreal-time-informed pseudotime on the basis of neural optimal trans- nearest neighbours of each reference cell in the reference data. For each\nport47 in the scPoli latent space. We first grouped organoid age in days edge in the reference-query bipartite graph, the similarity between\ninto seven bins ((0, 15], (15, 30], (30,60], (60, 90], (90, 120], (120, 150], the reference neighbours of the two linked cells, defined as A and B,\n(150, 450]). Next, we used moscot48 to solve a temporal neural problem. respectively, is represented by the Jaccard index:\nTo score the marginal distributions on the basis of expected proliferation rates, we obtained proliferation and apoptosis scores for each cell A∩B\n J (A, B) = .\nwith the method score_genes_for_marginals(). Marginal weights were A∪B\nthen computed with\n The square of Jaccard index was then assigned as the weight of the\n exp(4 × (prolif_score − apoptosis_score)) edge, to get the bipartite weighted kNN graph between the reference\n and query datasets.\n The optimal transport problem was solved using the following\nparameters: iterations = 25,000, compute_wasserstein_baseline = False, wkNN-based primary developing brain atlas label transfer to\nbatch_size = 1,024, patience = 100, pretrain = True, train_size = 1. To HNOCA cells\ncompute displacement vectors for each cell in age bin i, we used the Given the wkNN estimated between primary reference27 and query\nsubproblem corresponding to the [i, i + 1] transport map, except for (HNOCA), any categorical metadata label of reference can be transthe last age bin, where we used the subproblem [i − 1,i]. Displacement ferred to query cells by means of majority voting. In brief, for each\nvectors were obtained by subtracting the original cell distribution from category, its support was calculated for each query cell as the sum of\nthe transported distribution. Using the velocity kernel from CellRank86 weights of edges that link to reference cells in this category. The catwe computed a transition matrix from displacement vectors and used egory with the largest support was assigned to the query cell.\nit as an input for computing diffusion maps87. Ranks on negative diffu- To get the final regional labels for the non-telencephalic NPCs and\nsion component 1 were used as a pseudotemporal ordering. neurons, as well as the NTT labels for non-telencephalic neurons, con-\n straints were added to the transfer procedure. For regional labels, only\nPreprocessing of the human developing brain cell atlas scRNA-seq the non-telencephalic regions, namely diencephalon, hypothalamus,\ndata thalamus, midbrain, midbrain dorsal, midbrain ventral, hindbrain,\nThe cell ranger-processed scRNA-seq data for the primary atlas27 were cerebellum, pons and medulla, were considered valid categories to\nobtained from the link provided on its GitHub page (https://storage. be transferred. The label-transfer procedure was only applied to the\ngoogleapis.com/linnarsson-lab-human/human_dev_GRCh38-3.0.0.h5ad). non-telencephalic NPCs and neurons in HNOCA. Before any major-\nFor further quality control, cells with fewer than 300 detected genes ity voting was done, the support scores of each valid category across\nwere filtered out. Transcript counts were normalized by the total all non-telencephalic NPCs and neurons in HNOCA were smoothed\nnumber of counts for that cell, multiplied by a scaling factor of 10,000 with a random-walk-with-restart procedure (restart probability alpha,\nand subsequently natural-log transformed. The feature set was inter- 85%). Next, a hierarchical label transfer, which takes into account the\nsected with all genes detected in the organoid atlas and the 2,000 structure hierarchy, was applied. First, the considered regions were\nmost highly variable genes were selected with the scanpy function grouped into diencephalon, midbrain and hindbrain, with a support\nhighly_variable_genes using ‘Donor’ as the batch key. An extra column score of each structure as its score summed up with scores of its subof ‘neuron_ntt_label’ was created to represent the automatic classified structures. Majority voting was applied to assign each cell to one of the\nneural transmitter transporter subtype labels derived from the ‘Auto­ three structures. Next, a second majority voting was applied to only\nAnnotation’ column of the cell cluster metadata (https://github.com/ consider the substructures under the assigned structure (for example,\nlinnarsson-lab/developing-human-brain/files/9755350/table_S2.xlsx). hypothalamus and thalamus for diencephalon).\n\nFor NTT labels, we first identified valid region-NTT label pairs in st = αs 0 + (1 − α)PT st −1\nthe reference on the basis of the provided NTT labels in the reference\nneuroblast and neuron clusters and their most common regions. Here, This procedure was performed 100 times to get the smooth presence\nthe most common regions were re-estimated in a hierarchical manner scores that were subsequently log transformed. Scores lower than the\nto the finest resolution mentioned above. Next, when transferring 5th percentile or higher than the 95th percentile were trimmed. The\nNTT labels, for each non-telencephalic neuron with the regional label trimmed scores were normalized into the range of [0,1] as the final\ntransferred, only NTT labels that were considered valid for the region presence scores in the HNOCA dataset.\nwere considered during majority voting. Given the final presence scores in each of the HNOCA datasets, the\n max presence scores in the whole HNOCA data were then easily cal-\nStage-matching analysis culated as the maximum of all the presence scores for each cell in the\nTo match telencephalic NPCs and neurons in HNOCA to develop- primary atlas. A large (close to one) max presence score indicates a\nmental stages, we used the recently published human neocortical high frequency of appearance for the cell type or state in at least one\ndevelopment atlas30 as the reference. The processed single nucleus HNOCA dataset whereas a small (close to zero) max presence score\nRNA-seq data were obtained from its data portal (https://cell.ucsf.edu/ suggests under-representation in all the HNOCA datasets.\nsnMultiome/). Given the ‘class’, ‘subclass’ and ‘type’ labels in the provided metadata as annotations, and ‘individual’ as the batch label, Cell type composition comparison among morphogen usage\nscPoli was applied for label-aware data integration. Next, data rep- using scCODA\nresenting different developmental stages were split. For each stage, To test the cell type compositional changes on admission of certain\nLouvain clustering based on the scPoli latent representation (resolu- morphogens from different organoid differentiation protocols, we\ntion, 5) was applied. Clusters of all stages were pooled, and highly used the pertpy90 implementation of the scCODA algorithm91. scCODA\nvariable genes were identified on the basis of coefficient of variations is a Bayesian model for detecting compositional changes in scRNA-seq\nas described in this page: https://pklab.med.harvard.edu/scw2014/ data. For this, we have extracted the information about the added morsubpop_tutorial.html. Finally, every one of HNOCA telencephalic phogens from each differentiation protocol and grouped them into\nNPCs and neurons were correlated to each cluster across the identi- 15 broad molecule groups on the basis of their role in neural differenfied highly variable genes. The stage label of the best-correlated cluster tiation (Supplementary Table 1). These molecule groups were used\nwas assigned to the query HNOCA cell. as a covariate in the model. The region labels transferred from the\n To extend the analysis to other neuronal cell types, the second- primary atlas were used as labels in the analysis (cell_type_identifier).\ntrimester multiple-region human brain atlas29 was also introduced. The For cell types without regional identity, the cell type labels presented\nprocessed count matrices and metadata were obtained from the NeMO in Fig. 1c were used. Pluripotent stem cells and neuroepithelium cells\ndata portal (https://data.nemoarchive.org/biccn/grant/u01_devhu/ were removed from the analysis because they are mainly present in the\nkriegstein/transcriptome/scell/10x_v2/human/processed/counts/). early organoid stages. We used bio_sample as the sample_identifier.\nGiven the ‘cell_type’ label of the provided metadata as the annotation We ran scCODA sequentially with default parameters, using No-U-turn\nand ‘individual’ as the batch label, scPoli was run for label-aware data sampling (run_nuts function) and selecting each cell type once as a\nintegration. Louvain clustering was applied to the scPoli latent rep- reference. We used a majority vote-based system to find the cell types\nresentation to identify clusters (resolution, 20). Similarly, Louvain that were credibly changing in more than half of the iterations.\nclustering with a resolution of 20 was also applied to the first-trimester\nmultiple-region human brain atlas27 on the basis of the scANVI latent Cell type composition comparison among morphogen usage\nrepresentation we generated earlier. Average expression profiles using regularized linear regression\nwere calculated for all the clusters, and highly variable genes were To complement the composition analysis conducted with scCODA, we\nidentified using the same procedure as above for clusters of the two devised an alternative approach to test for differential composition\nprimary atlases combined. Next, every NPC and neuron in HNOCA using regularized linear regression. We fit a generalized linear model\nwas correlated to the average expression profiles of those clusters. with the region composition matrix as the response Y and molecule\nThe best-correlated first- and second-trimester clusters, as well as usage as independent variables X:\nthe correlations, were identified. The differences between the two\ncorrelations were used as the metrics to indicate the stage-matching Y ~ Xβ\npreferences of NPCs and neurons in HNOCA.\n The model was fit with lasso regularization (alpha = 1) using Gaussian\nPresence scores and max presence scores of cells in the primary noise and an identity link function. The regularization parameter lambda\ndeveloping brain atlas was automatically determined through cross-validation as implemented\nGiven a reference dataset and a query dataset, the presence score in the function cv.glmnet() from the glmnet92 R package. All non-zero coefis a score assigned to each cell in the reference, which describes the ficients β were considered as indications of enrichment and depletion.\nfrequency or likelihood of the cell type or state of that reference cell\nappearing in the query data. In this study, we calculated the presence DE analysis between HNOCA neural cell types and their primary\nscores of primary atlas cells in each HNOCA dataset to quantify how counterparts and functional enrichment analysis\nfrequently we saw a cell type or state represented by each primary cell To study the transcriptomic differences between organoid and primary\nin each of the HNOCA datasets. cells, we subset HNOCA using the final level 1 annotation to cells labelled\n Specifically, for each HNOCA dataset, we first subset the wkNN graph ‘Neuron’. We furthermore subset the human developing brain atlas to\nto only HNOCA cells in that dataset. Next, the raw weighted degree cells that had been assigned a valid label in the neuron_ntt_label annotawas calculated for each cell in the primary atlas, as the sum of weights tion column. We added an extra two datasets of fetal cortical cells from\nof the remaining edges linked to the cell. A random-walk-with-restart ref. 39 and ref. 28. For the data from ref. 39, we subset the data to cells\nprocedure was then applied to smooth the raw scores across the kNN labelled ‘fetal’ and estimated transcripts per million reads for each gene\ngraph of the primary atlas. In brief, we first represented the primary in each cell using RSEM93 given the STAR94 mapping results. We then\natlas kNN graph as its adjacency matrix (A), followed by row normaliza- computed a PCA, a kNN graph, UMAP and Leiden clustering (resolution to convert it into a transition probability matrix (P). With the raw tion 0.2) using scanpy. We then selected the cluster with the highest\nscores represented as a vector s0, in each iteration t, we generated st as STMN2 and NEUROD6 expression as the cortical neuron cluster and\n\nArticle\nused only those cells. For the data from ref. 28 we subset the datasets average expression of each neural cell type in the primary reference, as\nto cells annotated as ‘Neuronal’ in Supplementary Table 5 (‘Cortex well as in each dataset of HNOCA. For each HNOCA dataset, only neural\nannotations’) of their publication and computed a PCA, neighbourhood cell types with at least 20 cells were considered. Highly variable genes\ngraph and UMAP to visualize the dataset. We found that only samples were identified across the neural cell types in the primary reference\nfrom the individuals CS14_3, CS20, CS22 and CS20 contained detectable using a Chi-squared test-based variance ratio test on the generalized\nexpression of STMN2 and NEUROD6 so we subset the dataset further linear model with Gamma distribution (identity link), given coefficient\nto only cells from those individuals. of variance of transcript counts across neural cell types as the response\n To compute DE between HNOCA cells and their primary counterparts, and the reciprocal of average transcript count across neural cell types\nwe first aggregated cells of the same regional neural cell type into pseu- as the independent variable. Genes with Benjamini–Hochberg adjusted\ndobulk samples by summing the counts for every sample (annotation P values less than 0.01 were considered as highly variable genes. Similarcolumns, ‘batch’ for HNOCA; ‘SampleID’ for the human developing ity between one neural cell type in the primary atlas and its counterpart\nbrain atlas; ‘sample’ for ref. 39 and ‘individual’ for ref. 28) using the in each HNOCA dataset was then calculated as the Spearman correlation\nPython implementation of decoupler95 (v.1.4.0) while discarding any coefficient across the identified highly variable genes.\nsamples with fewer than ten cells or 1,000 total counts. We then subset- To estimate the similarity of the core transcriptomic identity, which\nted the feature space to the intersection of features of all datasets and is defined by the coexpression of transcription factors, the highly variremoved any cells with fewer than 200 genes expressed. We further able genes were subset to only transcription factorsfor calculating\nremoved any genes expressed in less than 1% of neurons in HNOCA and Spearman correlations. The list of transcription factors was retrieved\nany genes located on the X and Y chromosomes. Out of the remaining from the AnimalTFDB v.4.0 database98.\n11,636 genes, on average, 99% were reported in each of the constituent To identify metabolically stressed cells in the datasets, we used the\nHNOCA datasets. For each regional neural cell type, we removed any scanpy score_genes function with default parameters to score the\nsample from the pseudobulk data that was associated with an organoid ‘canonical glycolysis’ gene set obtained from the enrichR GO_Biologidifferentiation assay with fewer than two total samples or fewer than cal_Process_2021 database across all neuronal cells from HNOCA and\n100 total cells. We next used edgeR96 to iteratively compute DE genes refs. 27,28,39.\nbetween each organoid differentiation protocol and primary cells of the To estimate the significance of the difference between the correlamatching regional neural cell types for every regional neural cell type tion of glycolysis scores and whole transcriptomic similarities, and\nwhile correcting for organoid age in days, number of cells per pseudob- the correlation of glycolysis scores and core transcriptomic identity\nulk sample, median and standard deviation of the number of detected similarities, we generated 100 subsets of highly variable genes, each\ngenes per pseudobulk sample. We used the data from ref. 27 (the human with the same size as the highly variable transcription factor. Trandeveloping brain atlas mentioned above), ref. 28 and ref. 39 as primary scriptomic similarities were calculated on the basis of those subsets,\ndata for the DE comparison in the cell type ‘Dorsal Telencephalic Neuron and then correlated with the glycolysis scores.\nNT-VGLUT’, whereas for all other cell types we used the human developing brain atlas as the fetal dataset. We used the edgeR genewise negative Heterogeneity of the telencephalic trajectories\nbinomial generalized linear model with quasi-likelihood F-tests. We To characterize heterogeneity of telencephalic NPCs and neurons in\ndeemed a gene significantly DE if its false-discovery rate (Benjamini– HNOCA, we first transferred the cell type labels (as indicated as the\nHochberg) corrected P value was smaller than 0.05 and it had an abso- ‘type’ label in the given metadata) from the human neocortical devellute log2-fold change above 0.5. We used the GSEApy97 Python package opment atlas to the HNOCA telencephalic NPCs, intermediate proto carry out functional enrichment analysis in our DE results using the genitor cells and neurons, on the basis of transcriptomic correlation.\n‘GO_Biological_Process_2021’ gene set. In brief, each primary atlas cluster we obtained as mentioned above\n To evaluate the effect of different primary datasets on the DE results, was assigned to a cell type as the most abundant cell type among cells\nwe computed the DE between Dorsal Telencephalic Neuron NT-VGLUT in the cluster. The label of the best-correlated primary cluster was then\nfrom the HNOCA subset generated with the protocol from ref. 6 and the transferred to every query cell. Given the transferred label, together\nmatching cell type from the Braun et al.27 primary dataset as well as the with the level 2 cell type annotation shown in Fig. 1c, as the annotation\ndata from ref. 28. To prevent technology effects to affect this analysis, label, scPoli was applied to the telencephalic subset of HNOCA for\nwe only used cells generated with the 10X Genomics 3′ v.2 protocol data integration.\nin this comparison. We generate pseudobulk samples as described To benchmark how well different integration strategies recover the\nabove and corrected organoid age in days and number of cells per pseu- neuron subcell type heterogeneity, we generated four different clusterdobulk sample in the DE comparison. We used the same edgeR-based ing labels: (1) Louvain clustering (resolution, 2) with the original scPoli\nprocedure and cut-offs as described above. We used the scipy fcluster latent representation; (2) Louvain clustering (resolution, 2) with the\nmethod to cluster genes on the basis of their log-fold changes in the updated scPoli representation; (3) Louvain clustering (resolution, 2)\ntwo primary datasets. We grouped clusters to represent consistently with PCA of HNOCA telencephalic subset (based on scaled expresupregulated, consistently downregulated and three different inconsist- sion of 3,000 highly variable genes of the telencephalic subset with\nently regulated groups of genes. We computed functional enrichment flavor = ‘seurat’) and (4) Louvain clustering (resolution, 1) for each\nof each gene group as described above. sample separately (each with 3,000 highly variable genes identified\n To evaluate the effect of different organoid datasets on the protocol- with flavor = ‘seurat’, followed by data scale and PCA). Next, for each\nbased DE analysis, we computed DE between Dorsal Telencephalic sample with at least 500 dorsal telencephalic neurons, the adjusted\nNeuron NT-VGLUT of every organoid publication (further split by pro- mutual information scores were calculated between each of those\ntocol, where more than one protocol was used in a publication) and the four clustering labels with the transferred cell type label mentioned\nmatching cell type in the dataset from ref. 27. We computed pseudobulk above as the gold standard, across the dorsal telencephalic neurons\nsamples and carried out the DE analysis using the same procedure and as annotated as the level 2 annotation.\ncut-offs as in the protocol-based DE analysis. To create a comprehensive primary atlas of dorsal telencephalic neu-\n rons for DE analysis between neural organoids and primary tissues, we\nTranscriptomic similarity between HNOCA neural cell types and subset dorsal telencephalic neurons or neocortical neurons from four\ntheir primary counterparts in the human developing brain atlas different primary atlases27–30. For ref. 28, cells in five author-defined clus-\nTo estimate the transcriptomic similarity between neurons in HNOCA ters (60, 57, 79, 45, 65) with high expression of MAP2, DCX and NEUROD6\nand the human developing brain atlas27, we first summarized the were selected. For ref. 29, cells with the following ‘clusterv2 - final’ labels\n\nwere selected: ‘Neuron_28’, ‘Neuron_34’, ‘GW19_2_29NeuronNeuron’,\n‘Neuron_30’, ‘Neuron_66Neuron’, ‘GW18_2_42NeuronNeuron’, ‘Neu- Projection and label transfer-based annotation of the diseaseron_33’, ‘Neuron_39Neuron’, ‘Neuron_35’, ‘Neuron_63Neuron’, ‘Neu- modelling dataset\nron_9’, ‘Neuron_11’, ‘Neuron_20’, ‘Neuron_22’, ‘Neuron_5Neuron’, To compare the disease-modelling atlas with the integrated HNOCA, we\n‘Neuron_21’, ‘Neuron_18’, ‘Neuron_101Neuron’, ‘Neuron_17’, ‘Neu- used scArches51 to project it to the HNOCA as well as the first-trimester\nron_19’, ‘Neuron_16’, ‘Neuron_50Neuron’, ‘Neuron_12’, ‘Neuron_13’, primary human brain scRNA-seq atlas27. For projecting to the primary\n‘Neuron_68Neuron’, ‘Neuron_100Neuron’, ‘Neuron_25’, ‘Neu- atlas, the same implementation as mentioned above to map HNOCA\nron_27’, ‘Neuron_53Neuron’, ‘Neuron_23’, ‘Neuron_26’, ‘Neuron_24’, to the atlas was used. For projecting to HNOCA, the query model\n‘Neuron_102Neuron’, ‘Neuron_72Neuron’, ‘Neuron_15’, ‘Neuron_29’ was based on the scPoli model pretrained with the HNOCA data, and\nand ‘Neuron_35Neuron’ on the basis of their high expression of NEU- fineturned with a batch size of 16,384 for a maximum of 30 epochs with\nROD6 and FOXG1. For ref. 27, cells dissected from dorsal telencephalon 20 pretraining epochs. A nearest neighbour graph was created for the\nthat were annotated as neurons with and only with the VGLUT NTT disease-modelling atlas on the basis of the projected latent representalabel were selected. For ref. 30, cells annotated as excitatory neurons tion to HNOCA with scanpy (default parameters), with which a UMAP\nwere selected. The curated clusters of the Wang et al. primary atlas, embedding was created with scanpy (default parameters).\nas described earlier, were also subset to those with excitatory neuron Next, for both HNOCA and the disease-modelling atlas, cells were\nlabels. The selected dorsal telencephalic neuron subsets of the atlases represented by the concatenated representation of HNOCA-scPoli\nwere merged into the joint neocortical neuron atlas. and primary-scANVI models. A bipartite wkNN graph was then recon-\n Next, cells in the joint neocortical neuron atlas were correlated with structed as mentioned above, by identifying 50 nearest neighbours\nthe average expression profile of each excitatory neuron cluster of the in HNOCA for each disease-modelling atlas cell. On the basis of the\nWang et al. atlas30. The cluster label of the best-correlated cluster was bipartite wkNN, the majority voting-based label transfer was applied to\nassigned to each cell in the joined neocortical neuron atlas, so that cell transfer the four levels of hierarchical cell type annotation and regional\ncluster labels were harmonized for all cells in the atlas. Label-aware identity to the disease-modelling atlas.\ndata integration was then performed using scPoli45. On the basis of\nthe scPoli latent representation, Louvain clustering was performed Reconstruction of matched HNOCA metacells\non the joint neocortical neuron atlas (resolution, 1). This cluster label For each cell in the disease-modelling atlas, a matched HNOCA metacell\nwas transferred to the dorsal telencephalic neurons in HNOCA with was reconstructed on the basis of the above mentioned bipartite wkNN.\nmax-correlation manner across highly variable genes defined on aver- In brief, for a query cell i and a gene j measured in HNOCA, its matched\nage transcriptomic profiles of clusters in the joint neocortical neuron metacell expression of j, denoted as eij′, is calculated as:\natlas.\n ∑ k ⊆Ni wikekj\n eij′ =\nReference mapping of the neural organoid morphogen screen ∑ k ⊆Ni wik\nscRNA-seq data to the human developing brain atlas and HNOCA\nWe used scArches to map scRNA-seq data from the neural organoid mor- Here, Ni represents all HNOCA nearest neighbours of the query cell\nphogen screen to both the scANVI model of the human developing brain ci, wik represents the edge weight between query cell i and reference\natlas27 and the scPoli model of the HNOCA. In both cases, the ‘dataset’ cell k, and ekj represents expression level of gene j in reference cell k.\nfield of the screen data was used as the batch covariate, which indicates Given the matched HNOCA metacell transcriptomic profile, the\nbelonging to one of the three categories: ‘organoid screen’, ‘secondary similarity between a query cell and its matched cell state in HNOCA is\norganoid screen’ or ‘fetal striatum 21pcw’. For mapping to the primary then calculated as the Spearman correlation between the query cell\nreference, we used the scvi-tools implementation of scArches without transcriptomic profile and its matched HNOCA metacell transcripthe use of cell type annotations and trained the model for 500 epochs tomic profile.\nwith weight_decay of 0 and otherwise default parameters. For mapping\nto HNOCA we used scArches through scPoli and trained the model for Re-analysis of GBM-2019 and FXS-2021 datasets\n500 epochs without unlabelled prototype training. To analyse the glioblastoma organoid dataset (GBM-2019), cells from\n the publication were subset from the integrated disease-modelling\nRetrieval and harmonization of disease-modelling human atlas. Using scanpy, highly variable genes were identified with default\nneural organoid scRNA-seq datasets parameters. The log-normalized expression values of the highly\nWe included 11 scRNA-seq datasets of neural organoids, which were variable genes were then scaled across cells, the truncated PCA was\ndesigned to model 10 different neural diseases including microceph- performed with the top 20 principal components used for the folaly56, amyotrophic lateral sclerosis43, Alzheimer’s disease57, autism42, lowing analysis. Next, harmonypy, the Python implementation of\nFXS58, schizophrenia59, neuronal heterotopia60,61, Pitt–Hopkins syn- harmony99, was applied to integrate cells from different samples.\ndrome62, myotonic dystrophy63 and glioblastoma64. Count matrices and On the basis of the harmony-integrated embeddings, the neighbour\nmetadata were directly downloaded for the ten datasets with processed graph was reconstructed. UMAP embeddings and Louvain clusters\ndata provided in the Gene Expression Omnibus or ArrayExpress. For (resolution, 0.5) were created on the basis of the nearest neighbour\nthe dataset with only FASTQ files available56, we downloaded the FASTQ graph. Among the 12 identified clusters, cluster-7 and cluster-0, the\nfiles and used Cell Ranger (v.4.0) to map reads to the human refer- two clusters with the highest AQP4 expression, were selected for the\nence genome and transcriptome retrieved from Cell Ranger website following DE analysis.\n(GRCh38 v.3.0.0) for gene expression quantification. All datasets were To analyse the FXS dataset (FXS-2021), cells from the publication were\nconcatenated together with anndata in Python ( join = ‘inner’). For each subset from the integrated disease-modelling atlas. The same procedataset, samples were grouped into either ‘disease’ or ‘control’ as their dure of highly variable gene identification, data scaling and PCA as the\ndisease status, with ‘disease’ representing data from patient cell lines, GBM-2019 dataset was applied. Next, the nearest neighbour graph was\nmutant cell lines with disease-related alleles, cells carrying target- created directly on the basis of the top 20 principal components. UMAP\ning guide RNAs (gRNAs) in CRISPR-based screen and tumour-derived embeddings and Louvain clusters (resolution, 1) were then created on\norganoids. and ‘control’ representing data from healthy cell lines, the basis of the reconstructed nearest neighbour graph. Among the 30\nmutation-corrected cell lines and cells carrying only non-targeting clusters, cluster-17 and cluster-23, which express EMX1 and FOXG1 and\ngRNAs in a CRISPR-based screen. were largely predicted to be dorsal telencephalic NPCs and neurons\n\nArticle\naccording to the transferred labels from HNOCA, were selected for 78. Fischer, D. S. et al. Sfaira accelerates data and model reuse in single cell genomics.\n Genome Biol. 22, 248 (2021).\nthe following DE analysis. 79. Cunningham, F. et al. Ensembl 2022. Nucleic Acids Res. 50, D988–D995 (2022).\n 80. Virshup, I., Rybakov, S., Theis, F. J., Angerer, P. & Wolf, F. A. anndata: annotated data.\nF-test-based DE analysis for paired transcriptome Preprint at bioRxiv https://doi.org/10.1101/2021.12.16.473007 (2021).\n 81. Wolf, F. A., Angerer, P. & Theis, F. J. SCANPY: large-scale single-cell gene expression data\nTo compare expression levels of two groups of paired cells, the expres- analysis. Genome Biol. 19, 15 (2018).\nsion difference per gene of each cell pair is first calculated on the basis 82. McInnes, L., Healy, J., Saul, N. & Großberger, L. UMAP: Uniform Manifold Approximation\nof the log-normalized expression values. Next, for each gene to test for and Projection. J. Open Source Softw. 3, 861 (2018).\n 83. Traag, V. A., Waltman, L. & van Eck, N. J. From Louvain to Leiden: guaranteeing well-\nDE, its variance over the calculated expression difference per cell pair connected communities. Sci. Rep. 9, 5233 (2019).\n(σ2) is compared with the sum of squared of expression differences 84. Nolet, C. et al. Accelerating single-cell genomic analysis with GPUs. Preprint at bioRxiv\n(di for gene i) normalized by the number of cell pairs: https://doi.org/10.1101/2022.05.26.493607 (2022).\n 85. YosefLab/scib-metrics: accelerated, Python-only, single-cell integration benchmarking\n n metrics. GitHub https://github.com/YosefLab/scib-metrics (2024).\n ∑i =1 di 86. Lange, M. et al. CellRank for directed single-cell fate mapping. Nat. Methods 19, 159–170\n s02 = .\n n (2022).\n 87. Haghverdi, L., Buettner, F. & Theis, F. J. Diffusion maps for high-dimensional single-cell\n analysis of differentiation data. Bioinformatics 31, 2989–2998 (2015).\n Here, an F-test is applied for the comparison, with f = σ2/s20, d.f.1 = n − 1 88. Gayoso, A. et al. A Python library for probabilistic analysis of single-cell omics data. Nat.\nand d.f.2 = n. Biotechnol. 40, 163–166 (2022).\n 89. Virshup, I. et al. The scverse project provides a computational ecosystem for single-cell\n omics data analysis. Nat. Biotechnol. 41, 604–606 (2023).\nConstruction of the HNOCA Community Edition by query-to- 90. Heumos, L. et al. Pertpy: an end-to-end framework for perturbation analysis. Preprint at\nreference mapping bioRxiv https://doi.org/10.1101/2024.08.04.606516 (2024).\n 91. Büttner, M., Ostner, J., Müller, C. L., Theis, F. J. & Schubert, B. scCODA is a Bayesian model\nTo construct the HNOCA-CE, we first collected raw count matrices for compositional single-cell data analysis. Nat. Commun. 12, 6876 (2021).\nand associated metadata of five more neural organoid studies. For 92. Tay, J. K., Narasimhan, B. & Hastie, T. Elastic net regularization paths for all generalized\ntwo publications71,75, we obtained them from the sources listed in the linear models. J. Stat. Softw. 106, 1–31 (2023).\n 93. Li, B. & Dewey, C. N. RSEM: accurate transcript quantification from RNA-seq data with or\n‘Data availability’ section of the paper. For the remaining three publi- without a reference genome. BMC Bioinf. 12, 323 (2011).\ncations72–74, count matrices and associated metadata were provided 94. Dobin, A. et al. STAR: ultrafast universal RNA-seq aligner. Bioinformatics 29, 15–21\n (2013).\ndirectly by the authors. We subset each dataset to the healthy control\n 95. Badia-I-Mompel, P. et al. decoupleR: ensemble of computational methods to infer\ncells and removed any cells with fewer than 200 genes expressed. We biological activities from omics data. Bioinform. Adv. 2, vbac016 (2022).\nsubset the gene space of every dataset to the 3,000 HVGs of HNOCA 96. Robinson, M. D., McCarthy, D. J. & Smyth, G. K. edgeR: a Bioconductor package for\n differential expression analysis of digital gene expression data. Bioinformatics 26,\nwhile filling the expression of missing genes in the community datasets\n 139–140 (2010).\nwith zeros. On average, 23% of genes with zero expression were added 97. Fang, Z., Liu, X. & Peltz, G. GSEApy: a comprehensive package for performing gene set\nper dataset. We instantiated a mapping object from the HNOCA-tools enrichment analysis in Python. Bioinformatics 39, btac757 (2023).\n 98. Shen, W.-K. et al. AnimalTFDB 4.0: a comprehensive animal transcription factor database\npackage (at commit fe38c52) using the saved scPoli45 model weights\n updated with variation and expression annotations. Nucleic Acids Res. 51, D39–D45\nfrom the HNOCA integration. Using the map_query method of the (2023).\nmapper instance, we projected the community datasets to HNOCA. We 99. Korsunsky, I. et al. Fast, sensitive and accurate integration of single-cell data with\n Harmony. Nat. Methods 16, 1289–1296 (2019).\nused the following training hyperparameters: retrain = ‘partial’, batch_\n 100. He, Z. Dony, L. & Fleck, J. S. An integrated transcriptomic cell atlas of human neural\nsize = 256, unlabeled_prototype_training = False, n_epochs = 10, pre- organoids: cleaned datasets. Zenodo https://doi.org/10.5281/zenodo.11203684 (2023).\ntraining_epochs = 9, early_stopping_kwargs = early_stopping_kwargs,\neta = 10, alpha_epoch_anneal = 10. We computed the wkNN graph using Acknowledgements We thank C. De Donno for his support in improving our data integration\nthe compute_wknn method of the mapper instance with k = 100. We efforts using scPoli. We thank D. Klein, P. Weiler and M. Lange for insightful discussions\ntransferred the final level_2 cell type labels from HNOCA to the com- on the moscot framework, (neural) optimal transport and real-time-informed pseudotime\n analyses. We thank C. Bright for customizing the ArchMap tool to meet the requirements\nmunity datasets using this neighbour graph. To obtain the combined of this project. We thank F. Sanchis-Calleja, S. Jansen and F. Zenk for insightful comments\nrepresentation of HNOCA-CE, we projected HNOCA together with the on summarizing neural organoid protocols. We thank P. Lönnerberg and S. Linnarsson for\nadded community datasets through the trained model and computed insightful discussions on the application of the human developing brain atlas in this study.\n We thank the Human Cell Atlas Organoid Biological Network, in particular F. Birey, J. Andersen,\na neighbour graph and UMAP from the resulting latent representation. S. A. Sloan, A. R. Muotri, S. Velasco, P. Arlotta, Y. Xiang, I.-H. Park, A. Bhaduri, A. R. Kriegstein,\n L. Pellegrini, M. A. Lancaster, G.-L. Ming, T. Sawada, T. Kato, O. Revah, K. R. Bowles, A. M. Goate,\nReporting summary S. Temple, A. Fiorenzano, M. Parmar, R. Samarasinghe, B. G. Novitch, I. Kelava, J. A. Knoblich,\n G. Testa, T. Bertucci, R. Shyti, E. B. Binder, F. H. Gage and C. Bock for their support on data and\nFurther information on research design is available in the Nature Port- metadata retrieval. This work was supported by Chan Zuckerberg Initiative DAF, an advised\nfolio Reporting Summary linked to this article. fund of the Silicon Valley Community Foundation (grant nos. CZF2019-002440 and CZF2021-\n 237566, to J.G.C. and B.T.). This work was cofunded by the Swiss National Science Foundation\n (project grant no. 310030_192604, to B.T.), the European Union (European Research Council\n (ERC), DeepCell grant no. 101054957, to A.S. and F.J.T.; ERC, Organomics grant no. 758877, to\nData availability B.T.; H2020, Braintime grant no. 874606, to B.T.; ERC, Anthropoid grant no. 803441, to J.G.C.)\n and the Roche Institute for Human Biology (Z.H., H.C.L., B.T.). Views and opinions expressed\nAll curated individual HNOCA datasets are available for easy access\n are however those of the authors only and do not necessarily reflect those of the European\nthrough the sfaira Python tool78. The integrated HNOCA data is available Union or the ERC. Neither the European Union nor the granting authority can be held\nat Zenodo (https://doi.org/10.5281/zenodo.11203684)100 and the Cellx- responsible for them. This work was supported by the Bavarian Ministry of Science and the\n Arts in the framework of the Bavarian Research Association ForInter (Interaction of Human\nGene Discover Census (https://cellxgene.cziscience.com/collections/\n Brain Cells) (to F.J.T.). This work was supported by the BMBF-funded de.NBI Cloud within the\nde379e5f-52d0-498c-9801-0f850823c847). The extended HNOCA Com- German Network for Bioinformatics Infrastructure (de.NBI) (grant nos. 031A532B, 031A533A,\nmunity Edition Atlas is also available through the CellxGene Discover 031A533B, 031A534A, 031A535A, 031A537A, 031A537B, 031A537C, 031A537D, 031A538A)\n (to L.D., A.S., K.X.L. and I.S.). This work was supported through a Fulbright grant of the German-\nCensus (same URL as above). Both versions of HNOCA are available\n American Fulbright Commission (to K.X.L.). L.D. acknowledges support by the Joachim Herz\nfor reference mapping through the ArchMap web interface (https:// Foundation. This publication is part of the Human Cell Atlas (www.humancellatlas.org/\nwww.archmap.bio/). The HNOCA-tools package provides a Python publications/).\ninterface for annotation, reference mapping and central downstream\n Author contributions A.S., K.X.L. and I.S. contributed equally. Z.H., L.D. and J.S. collected\nanalysis steps and is available at https://github.com/devsystemslab/ and retrieved the scRNA-seq data involved in HNOCA, with suggestions from S.P.P., J.G.C.\nHNOCA-tools. More information on the available tools and a documen- and B.T. H.-C.L. and M.S. generated the unpublished midbrain organoid data. A.A. and G.Q.\ntation of HNOCA-tools is available at https://devsystemslab.github.io/ generated and shared the cerebellar organoid data before its publication. J.S.F. developed\n snapseed. Z.H. and J.S.F. curated cell type hierarchy with the support from L.D. L.D., K.X.L.,\nHNOCA-tools. Jupyter notebooks and scripts to reproduce the analysis I.S. and A.S. performed HNOCA data curation and metadata harmonization. L.D., with the\nare available at https://github.com/theislab/neural_organoid_atlas. support from K.X.L. and I.S., performed HNOCA data preprocessing and integration using the\n\npipeline developed by Z.H., L.D., J.S.F. and A.S. L.D. and K.X.L. performed the benchmark of J.S.F., A.S., I.S., S.P.P., J.G.C., F.J.T. and B.T. wrote the paper with input from all the coauthors.\nintegration methods. Z.H. did HNOCA cell type annotation. K.X.L. and J.S.F. performed the All authors read and approved the final manuscript.\nreal-time-informed pseudotime analysis. J.S.F. performed reference mapping of HNOCA\nto the human developing brain atlas with support from A.S. Z.H. developed and performed Competing interests F.J.T. consults for Immunai Inc., Singularity Bio B.V., CytoReason Ltd,\nlabel transfer and presence score estimation. Z.H. performed stage-matching analysis Cellarity, and has ownership interest in Dermagnostix GmbH and Cellarity. The other authors\nof HNOCA cells. I.S., J.S.F. and L.D. performed morphogen analysis, with the organoid declare no competing interests.\nprotocols summarized by Z.H. L.D. and Z.H. with support from I.S. K.X.L. performed DE\nand transcriptomic comparison analysis. Z.H. performed the heterogeneity analysis of Additional information\ntelencephalic cells and cell-level DE analysis with covariates. J.S.F. and A.S. performed Supplementary information The online version contains supplementary material available at\nreference mapping of organoid morphogen screen dataset to HNOCA and the human https://doi.org/10.1038/s41586-024-08172-8.\ndeveloping brain atlas and the follow-up analysis. Z.H. collected, retrieved and analysed the Correspondence and requests for materials should be addressed to Zhisong He,\nscRNA-seq data of disease-modelling neural organoids, and developed the procedure to J. Gray Camp, Fabian J. Theis or Barbara Treutlein.\ncompare with HNOCA. L.D. curated extra datasets and performed reference mapping to Peer review information Nature thanks the anonymous reviewers for their contribution to the\nexpand HNOCA. J.S.F. developed the HNOCA-tools Python package implementing analysis peer review of this work.\napproaches developed in the study. Z.H., J.G.C., F.J.T. and B.T. designed the project. Z.H., L.D., Reprints and permissions information is available at http://www.nature.com/reprints.\n\nArticle\n\n\nExtended Data Fig. 1 | Benchmark of data integration. (a) UMAPs of HNOCA, integration methods. (c) PCA of the scPoli sample embeddings from the final\neither without any data integration (PCA) or with different data integration scPoli integration of HNOCA presented throughout the manuscript, colored by\nmethods applied. Number in parenthesis indicates which level of RSS-based publications, scRNA-seq methods, organoid protocols, protocol types, cell lines,\nsnapseed annotation labels were provided as input to the model for methods and sample ages. (d) UMAPs of HNOCA based on the final scPoli integration, each\nwhich support semi-supervised data integration. Dots in all UMAP embeddings, with one data set highlighted. Here, one data set is defined as data representing\neach of which represents a cell, are colored by the cell type annotation introduced one protocol in one publication. The protocol and publication of each data set are\nin Fig. 1. a.c. = aggrecell algorithm (b) scIB benchmarking metrics on all tested shown by the color bar and indices on top of the UMAP.\n\nExtended Data Fig. 2 | Characterization of HNOCA. (a) Expression of selected neural cell types. Markers are defined as genes with AUC > 0.7, in-out detection\nmarker genes used in the semi-automatic annotation of cell types for Fig. 1. rate difference>20%, in-out detection rate ratio>2 and fold change>1.2. When\n(b) Mean cell type proportion over all data sets per organoid age bin. more than 5 markers are found, only the top-5 (with the highest in-out detection\n(c) Distribution of sample real-time age in days over deciles of computed rate ratio) are shown.\npseudotime. (d) Expression of top markers in different non-telencephalic\n\nArticle\n\n\nExtended Data Fig. 3 | Mapping-assisted annotation refinement of HNOCA. expression of three neurotransmitter transporters SLC17A6, SLC18A3 and\n(a-b) UMAP of HNOCA colored by the mapped (a) cell classes and (b) brain SLC32A1 in clusters (bottom) and neural cell types (right). (g) Overview of the\nregions, both from the human developing brain cell atlas as the primary HNOCA cell type composition for the first two levels of the cell annotation\nreference. (c) Comparison of the HNOCA cell type annotation with the primary (left - level-1, middle - level-2), and the refined regional annotation assisted\nreference mapping-based transferred cell class and brain region labels. by mapping of non-telencephalic NPC and neurons to the primary reference\nDarkness of cells indicates proportions of each HNOCA cell type being (right). (h) neural cell type compositions of different data sets (rows). Darkness\nassigned to different cell class and brain region categories. Brain region labels of the heatmap shows the proportions of different neural cell types per HNOCA\nare only shown for the HNOCA neural cell types. (d) Comparison of the simple data set. Sidebars on the left show organoid protocol types of different data\nmajority-voting-based regional label transfer and the hierarchical regional sets. Sidebars on the bottom show neural cell types. Bars on the right show\nlabel transfer with random-walk-with-restart-based smoothening. Only cells total neuron numbers across data sets. (i) Distribution of transcriptomic\nannotated as NPCs, IPs and neurons are included. (e) UMAP of non-telencephalic similarity differences of NPCs and neurons in HNOCA with the primary\nneurons, colored by clusters (upper), mapped brain regions (middle) and mapped neuronal populations in the first trimester (represented by Braun et al. 27) and\nneurotransmitter transporter (NTT) subtypes (bottom). (f) Comparison the second trimester (represented by Bhaduri et al. 29). Cells are firstly grouped\nof non-telencephalic neural cell types, defined as the concatenation of the by regional identities, followed by organoid ages (in months). Colors of boxes\nmapped brain region and NTT subtype, with the clusters. The middle heatmap indicate organoid ages. (j) Heatmap shows the enrichment of adult regional\nshows contributions of different clusters to different neural cell types. The identities (columns) for HNOCA NPCs and neurons with different estimated\nsidebar on the left shows the neural cell types; dots under the heatmap show regional identities (rows).\nclusters. The heatmaps on the bottom and on the right show the average\n\nExtended Data Fig. 4 | Relationship between morphogen usage and cell half of the reference cell types. (c) Effect of different morphogens on regional\ntype as well as regional composition. (a) Schematic of estimating cell type organoid composition in HNOCA. Positive values correspond to a higher\nenrichment with different morphogen usages. (b) This heat map indicates in abundance of cells from the indicated regional cell identity in cases where\nhow many of the 17 iterations scCODA was executed (using each of the 17 the respective morphogen was used in the differentiation protocol. Top:\nregional cell identity as a reference once) the respective morphogen was found log2-fold-effect sizes of morphogens per regional cell identity as computed\nto lead to compositional changes with respect to the reference regional cell by the scCODA model. Bottom: L1-regularized linear model coefficients.\nidentity. A morphogen effect was called significant in this consensus approach The dashed arrows show consistent enrichment/depletion identified by the\nif it had a significant effect on cell type composition with respect to more than two methods.\n\nArticle\n\n\nExtended Data Fig. 5 | Presence scores per HNOCA data set. (a) Average MB - midbrain). (b) UMAP of the primary reference, colored by the max\nnormalized presence scores of different HNOCA data sets (rows) in different cell presence scores across different HNOCA data subsets, split by organoid\nclusters in the primary reference of the human developing brain atlas27 (columns). protocol types. A high max presence score suggests enrichment of the\nSidebars on the left show organoid differentiation protocol types of HNOCA corresponding primary cell state in at least one HNOCA data set among the\ndata sets. Sidebars underneath show cell class and the commonest region data sets based on the specific type of organoid protocols, with a low score\ninformation of the cell clusters in the primary reference (HyTh - hypothalamus, meaning under-representation of the cell state in all data sets in the subset.\n\nExtended Data Fig. 6 | Robustness of organoid-primary DEGs against protocol (10×3’ v2 chemistry only) and primary fetal cortical neurons from\nprimary reference, and across organoid data set. (a) Number of DEGs Braun et al. 27 (10×3’ v2 chemistry only) or Eze et al. 28 respectively. Of the 2815\nbetween organoid Dorsal Telencephalic Neurons NT-VGLUT generated using shared DEGs, 2375 genes had an aligned direction of fold-change while 440 genes\nthe Velasco et al.6 protocol (10×3’ v2 chemistry only) and primary fetal cortical had an opposite direction of fold-change. (d) Heatmap of log2-transformed\nneurons from Braun et al. 27 (10×3’ v2 chemistry only) or Eze et al. 28 respectively. fold changes (log 2FC) across all 9106 DEGs between dorsal telencephalic\nOf the 3829 shared DEGs, 3423 genes had an aligned direction of fold-change neurons from Lancaster et al. and either primary fetal cortical neurons from\nwhile 406 genes had an opposite direction of fold-change. (b) Heatmap of Braun et al. (10×3’ v2 chemistry only) or Eze et al. The dendrogram shows the\nlog2-transformed fold changes (log 2FC) across all 9054 DEGs between Dorsal hierarchical clustering of DEGs based on their log 2FC against the two primary\nTelencephalic Neurons NT-VGLUT from Velasco et al. and either primary fetal data. (e) Heatmap showing the mean log-fold change per gene across organoid\ncortical neurons from Braun et al. (10×3’ v2 chemistry only) or Eze et al. The publications for Dorsal Telencephalic Neurons NT-VGLUT compared to the\ndendrogram shows the hierarchical clustering of DEGs based on their log 2FC expression in the matching cell type from the Braun et al.27 primary atlas. Shown\nagainst the two primary data. (c) Number of DEGs between organoid Dorsal are all genes that are significantly differentially expressed compared to primary\nTelencephalic Neurons NT-VGLUT generated using the Lancaster et al. 36 cells in the data from at least one publication.\n\nArticle\n\n\nExtended Data Fig. 7 | Transcriptomic fidelity of neurons and cell stress. canonical glycolysis scores and transcriptomic similarities to primary is\n(a) Hallmark glycolysis scores of different neural cell types in primary significantly weaker when only TFs are taken into consideration, while electron\n(left, Braun et al. 27) and a selected organoid data set (right, Kanton et al. 3). transport scores show no correlation with transcriptomic similarities. The\n(b) Spearman correlation between average gene expression profiles of neural cell boxes show the distributions of correlation when a random subset of variable\ntypes in HNOCA and those in the primary reference of human developing brain genes, with the same number as the variable TFs, are used. The red dots show\natlas27, across either all the variable genes (left, S1) or variable transcriptional the correlation using variable TFs. (e) Core transcriptomic fidelity of organoid\nfactors (TFs) (right, S3). The average gene expression profile per neural cell type neurons (S2, shown in Fig. 3) which only considers TFs, is higher than the global\nwas calculated with all cells (S1) or cells with low glycolysis scores (glycolysis transcriptomic fidelity (S1) which considers all the highly variable genes. Core\nscore <0.6, S3). (c) Correlation between different average metabolic scores transcriptomic fidelity and global transcriptomic fidelity are highly correlated\n(up - hallmark glycolysis score, middle - canonical glycolysis score, low - electron (left, x-axis - S1, y-axis - S2, each dot represents one neural cell type in one\ntransport score) and transcriptomic similarities (Spearman correlation) to HNOCA data set), while core transcriptomic fidelity is significantly higher\nprimary counterparts. Each dot represents one neural cell type generated by (right, x-axis: S1, y-axis: S2-S1, dots are colored by density estimated with\none protocol. The correlation is calculated based on either all variable genes Gaussian kernel). P-value shows the Wilcoxon test significance.\n(left, S1) or variable TFs (right, S2). (d) The correlation between hallmark and\n\nExtended Data Fig. 8 | Heterogeneity of telencephalic NPCs and neurons F-test-based DE analysis results, with (left) and without (right) the glycolysis\nand its incorporation to differential expression analysis between dorsal scores and matched cluster labels as covariates. The identified DEGs are\ntelencephalic neurons in HNOCA and primary developing human brains. colored by red (increased expression in HNOCA) or blue (decreased expression\n(a) Overview of mapping the telencephalic NPCs and neurons in HNOCA to the in HNOCA). (i) Changes of functional term enrichment by DAVID for DEGs based\nhuman neocortical developmental atlas30 for cell type annotations. (b) UMAP on the analysis with or without covariates. The top panel shows enrichments\nof cells from the HNOCA telencephalic trajectories, colored by the transferred for the up-regulated DEGs (uDEG) in organoids, and the lower panel shows\ncell types from the human neocortical developmental atlas (upper) and the enrichments for the down-regulated DEGs (dDEG). Each dot indicates one\nHNOCA annotation. (c) UMAP of HNOCA telencephalic cells colored by functional term with raw P-value < 0.05 for both DEG sets. Red dots indicate\nexpression levels of selected cell type markers. (d) Distributions of adjusted functional terms gaining enrichment with DEGs with covariates (with-covariate\nmutual information across dorsal telencephalic neurons in different HNOCA adjusted P wt < 0.1, and without-covariate adjusted P wo>P wt). Blue dots indicate\nsamples, between the transferred cell type labels and cluster labels generated functional terms losing enrichment with DEGs without covariates (P wt>0.1 and\nwith four different representations: 1) the original scPoli (scPoli-1), 2) the P wo < 1 × 10 −10). (j) Heatmap shows normalized coefficient (estimated logFC\nre-computed telencephalon-only scPoli based on given the transferred labels; normalized by the overall logFC magnitude) of each DEG per data set.\n3) unintegrated PCA of the merged data; 4) PCA and clustering sample-wise. Dendrograms show hierarchical clustering of DEGs and data sets. Rows\n(e) The joint atlas of human neocortical development, colored by data sets, represent data sets. Side bars on the left are colored based on the types of\ndevelopmental stages, clusters, and whether there is any counterpart in protocols, individual protocols, and publications corresponding to the data\nHNOCA dorsal telencephalic neurons. (f) Distribution of the hallmark sets. Columns represent DEGs.\nglycolysis scores in HNOCA and the primary atlas. (g) Volcano plots show the\n\nArticle\n\n\nExtended Data Fig. 9 | Reference mapping of the neural organoid (d) Heatmap showing min-max scaled average presence scores of each condition\nmorphogen screen data to HNOCA and the human developing brain atlas. in the screen data set in HNOCA data sets. (e) Heatmap showing min-max scaled\n(a) UMAP embedding of the human developing brain atlas and neural organoid average presence scores of each condition in the screen data set in each leiden\nmorphogen screen44 data sets based on the joint scANVI latent space colored cluster in HNOCA, ordered by annotated cell type. (f) UMAP embeddings of\nby brain region (left) and data set (right). (b) UMAP embedding of HNOCA and HNOCA (left) and the human developing brain atlas (right) colored by presence\nthe screen data sets based on the joint scPoli latent space colored by annotated scores for each condition group in the screen data set. (g) UMAP embeddings\ncell type (left) and data set (right). (c) scPoli UMAP embedding of the HNOCA of the human developing brain atlas (upper) and screen data set (lower) colored\ncolored by cell type (left) and max presence score across all data sets (right). by coexpression scores of clusters with gained coverage in the screen data set.\n\nExtended Data Fig. 10 | Disease-modeling neural organoid scRNA-seq of dots represent the average expression levels. (g-j) UMAP of the glioblastoma\natlas and data projection based extension of HNOCA. (a-c) UMAP of GBM-2019 data set, colored by (g) samples, (h) predicted cell class labels (level-1)\nthe unintegrated disease-modeling neural organoid atlas, colored by from the HNOCA projection, (i) expression of astrocyte markers GFAP and\n(a) publications, (b) disease status, (c) transferred level-2 annotation from AQP4, and (j) the AQP4+ population selected for DE analysis with HNOCA.\nHNOCA, and (d) transferred regional identities from HNOCA. (e) Dot plot shows (k-n) UMAP of the fragile X syndrome FXS-2021 data set, colored by (k) samples,\nexpression of selected cell type markers in cells with different transferred cell (l) predicted cell type annotation (level-2) from the HNOCA projection,\nclass labels (level-1) from HNOCA. (f) Dot plot shows expression of selected (m) expression of dorsal telencephalic cell markers FOXG1, EMX1 and NEUROD6,\nregional markers in the predicted NPCs and neurons in the disease-modeling (n) the dorsal telencephalic NPC and neuron subset for DE analysis with HNOCA.\natlas with different transferred regional identities from HNOCA. In both (e) and (o) PCA of the scPoli sample embeddings of samples in HNOCA and five additional\n(f), sizes of dots represent percentages of cells expressing the gene, and colors data sets projected to HNOCA.\n\nZhisongHe\n He\n\n\n natureportfolio|reportingsummary\n J.GrayCamp\n FabianTheis\n Correspondingauthor(s): BarbaraTreutlein\n Lastupdatedbbya\n y uthor(s):Aug23,2024\n\n\nRNateurePpoortfroltiowiinshgS u\n esttoi\n mma ry\n omprovethereproducibilityo\n oftheworkthatwe\n wepublish.Thisformprovidesstructureforconsistencyandtransparency\ninr\n n eporting.Forfurtherinformationo\n onNa\n n turePortfoliopolicies,seeourEditorialPoliciesandtheEditorialPolicyChecklist.\n\n\nStatistics\nForallstatisticalanalyses,confirmthatthefollowingitemsarepresentint n hefigurelegend,tablelegend,maintext,orMethodssection.\nn/a Confirmed\n 8 Theexactsampl esize(n)foreachexperimentalgroup/condition,givena asad\n s iscretenumberandunitofmeasurement\n 8 Astatementonwh n ethermeasurementsweretakenfromdistinctsampleso orwhetherthesamesamplewasmeasuredrepeatedly\n 8T hestatisticaltest(s)usedANDwhethertheyareone-ortwo-sided\n Onlycommontestsshouldbedescribedsolelybyname;describemorecomplextechniquesintheMethodssection.\n 8 Adescri ptionoofallcovariatestested\n 8 Adescri ptionoofanyassumptionso orcorrections,suchaast\n sestso\n ofnormalityandadjustmentformultiplecomparisons\n 8 Af ulldescriptionoofthestatisticalparametersincludingcentraltendency(e.g.means)orotherbasicestimates(e.g.regressioncoefficient)\n ANDvariation(e.g.standarddeviation)orassociatedestimateso ofuncertainty(e.g.confidenceintervals)\n 8 Fornul lhypothesistesting,theteststatistic(e.g.F,t,r)withconfidenceintervals,effectsizes,degreeso\n GivePvaluesasexactvalueswheneversuitable.\n offreedomandPvaluenoted\n 8 ForBayesiananalysis,informationo\n ont\n n hechoiceo ofpriorsandMarkovchainMonteCarlosettings\n 8 Forhierarchicalandcomplexdesigns,identificationo\n oftheappropriatelevelfortestsandfullreportingo\n ofoutcomes\n 8 Esti\n matesoofeffectsizes(e.g.Cohen'sd,Pearson'sr),indicatinghowtheywerecalculated\n Ourwebcollectiononstatisticsforbiologistscontainsarticlesonmanyofthepointsabove.\n\nSoftwareandcode\nPolicyinformationaboutavailabilityo\n ofcomputercode\n Datacollection Thedatacollectionprocedureiisd\n s escribediint\n n heMethodssectionoofthemanuscript.\n Dataanalysis Thedataanalysisiisd\n s escribediint\n n heMethodssectionoofthemanuscript.\nFormanuscriptsutilizingcustomalgorithmso\n orsoftwarethatarecentraltot\n o heresearchbutnotyetdescribediinp\n n ublishedliterature,softwaremustbema\n e deavailablettoe\n o ditorsand\nreviewers.We\n Westronglyencouragecodedepositioni inac\n n ommunityrepository(e.g.GitHub).SeetheNaturePortfolioguidelinesforsubmittingcode&softwareforfurtherinformation.\n\nData\nPolicyinformationaboutavailabilityo\n ofdata\n Allmanuscriptsmustincludeadataavailabilitystatement.Thisstatementshouldprovidethefollowinginformation,whereapplicable:\n -Accessioncodes,uniqueidentifiers,orweblinksforpubliclyavailabledatasets\n -Adescriptionoofanyrestrictionsoond\n n ataavailability\n -Forclinicaldatasetsoorthirdpartydata,pleaseensurethatthestatementadheresttoo\n o urpolicy\n April2023\n\n\nAllcuratedindividualHNOCAdatasetsareavailableforeasyaccessviathesfairapythontool80.TheintegratedHNOCAdataiisa s vailableoonZ\n n enodo(https://\ndoi.org/10.5281/zenodo.11203684)andtheCellxGeneDiscoverCensus(https://cellxgene.cziscience.com/collections/de379e5f-52d0-498c-9801-0f850823c847).\nTheextendedHNOCACommunityEditionAtlasiisa s lsoavailableviatheCellxGeneDiscoverCensus(sameURLaasa s bove).BothversionsoofHNOCAareavailablefor\nreferencemappingviatheArchMapwebinterface(https://www.archmap.bio/).\n 1\n\nResearchinvolvinghumanparticipants,theirdata,orbiologicalmaterial\n\n\n natureportfolio|reportingsummary\nPolicyinformationaboutstudieswithhumanparticipantsorhumandata.Seealsopolicyinformationaboutsex,gender(identity/presentation),\nandsexualorientationandrace,ethnicityandracism.\n Reportingonsexandgender N/A\n Reportingonrace,ethnicity,or N/A\n othersociallyrelevantgroupings\n Populationcharacteristics N/A\n Recruitment N/A\n Ethicsoversight N/A\nNotethatfullinformationontheapprovalofthestudyprotocolmustalsobeprovidedinthemanuscript.\n\nFPleiaesesldele-csttpheoencebiefloiwtcr e p o r ti n g\n hatisthebestfitforyourresearch.Ifyouarenotsure,readtheappropriatesectionsbeforemakingyourselection.\n 8 Lifesciences Behavioural&socialsciences Ecological,evolutionary&environmentalsciences\nForareferencecopyofthedocumentwithallsections,seenature.com/documents/nr-reporting-summary-flat.pdf\n\nLAlilsftes ci e n c e ss tu d yd e sig n\n udiesmustdiscloseonthesepointsevenwhenthedisclosureisnegative.\n Samplesize WecollectedalltherepresentativescRNA-seqdatasetsofdifferentneuralorganoidprotocolsthatareaccessibleforHNOCA.Similarly,we\n collectedalltherepresentativescRNA-seqdatasetsofneuralorganoiddiseasemodelsthatareaccessibleforthediseaseatlas.\n Dataexclusions Qualitycontrolwasappliedtoexcludecellswithlowquality.DetailedmethodsaredescribedintheMethodssection\n Replication ThetwounpublishedscRNA-seqdatasetsbothincludemeasurementsofmultipleindividuals\n Randomization Experimentswerenotrandomized\n Blinding Thereisnoblindingdesignofthestudy\n\nRWereepquioreinrfotrmaintiogf o r s p e c ificma t e r ia ls , s y s te msa n dme t h o d s\n nfromauthorsaboutsometypesofmaterials,experimentalsystemsandmethodsusedinmanystudies.Here,indicatewhethereachmaterial,\nsystemormethodlistedisrelevanttoyourstudy.Ifyouarenotsureifalistitemappliestoyourresearch,readtheappropriatesectionbeforeselectingaresponse.\n Materials&experimentalsystems Methods\nn/a Involvedinthestudy n/a Involvedinthestudy\n 8 Antibodies 8 ChIP-seq\n 8 Eukaryoticcelllines 8 Flowcytometry\n 8 Palaeontologyandarchaeology 8 MRI-basedneuroimaging\n 8 Animalsandotherorganisms\n 8 Clinicaldata\n 8 Dualuseresearchofconcern\n 8 Plants\n April2023\n\n\n 2\n\nPlants\n\n\n natureportfolio|reportinggsummaary\nSeedstocks Reportonthesourceofallseedstocksorotherplantmaterialused.Ifapplicable,statetheseedstockcentreandcataloguenumber.If\n plantspecimenswerecollectedfromthefield,describethecollectionlocation,dateandsamplingprocedures.\nNovelplantgenotypes De scribethemethodsbywhichallnovelplantgenotypeswereproduced.Thisincludesthosegeneratedbytransgenicapproaches,\n geneediting,chemical/radiation-basedmutagenesisandhybridization.Fortransgeniclines,describethetransformationmethod,the\n numberofindependentlinesanalyzedandthegenerationuponwhichexperimentswereperformed.Forgene-editedlines,describe\n theeditorused,theendogenoussequencetargetedforediting,thetargetingguideRNAsequence(ifapplicable)andhowtheeditor\nAuthentication wa\n Desscaripbpeliaendy.authenticationproceduresforeachseedstockusedornovelgenotypegenerated.Describeanyexperimentsusedto\n assesstheeffectofamutationand,whereapplicable,howpotentialsecondaryeffects(e.g.secondsiteT-DNAinsertions,mosiacism,\n off-targetgeneediting)wereexamined.\n\n\n April2023\n\n\n 3",
      "rationale": "heuristic fallback",
      "detected_categories": [
        {
          "id": "dna_rna_extraction",
          "hits": 58,
          "confidence": 1.0,
          "matched_patterns": [
            "lysis"
          ]
        },
        {
          "id": "molecular_cloning",
          "hits": 13,
          "confidence": 1.0,
          "matched_patterns": [
            "vector",
            "insert",
            "transform"
          ]
        },
        {
          "id": "purification_cleanup",
          "hits": 11,
          "confidence": 1.0,
          "matched_patterns": [
            "column"
          ]
        },
        {
          "id": "cell_culture",
          "hits": 10,
          "confidence": 1.0,
          "matched_patterns": [
            "\\bwell\\b"
          ]
        },
        {
          "id": "sequencing_library_prep",
          "hits": 3,
          "confidence": 0.375,
          "matched_patterns": [
            "sequenc",
            "library"
          ]
        }
      ],
      "split_audit": {
        "char_count": 75177,
        "word_count": 11243,
        "sentence_count": 781,
        "category_count": 5,
        "flags": [
          "UNIT_CATEGORY_OVERMIXED"
        ]
      }
    }
  ],
  "created_at": "2026-02-16T10:57:30.517304+00:00"
}
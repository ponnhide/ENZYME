Methods
 Generation of the CAG::Cas9 hiPS cell line
Culture of hiPS cells The CAG::Cas9 line was generated as previously described53. The
The hiPS cell lines used in this study were validated as previously donor plasmids were constructed by modifying the AAVS1-CAG-hrGFP
described51. The SEC61B-mEGFP hiPS cell line (AICS-0059 cl.36) was (Addgene plasmids catalogue no. 52344) and replacing the GFP with
developed at the Allen Institute for Cell Science (https://www.allen- Cas9 (Addgene plasmids catalogue no. 42230), TRE and tTA (Takara,
cell.org/cell-catalog.html) and is distributed through Coriell43. The catalogue no. 63113). The plasmid containing gRNA targeting AAVS1
CAG::Cas9 cell line was genetically engineered in the laboratory (the locus was obtained from Addgene (plasmid no. 41818). hiPS cells
parental cell line 1205-4 was derived and characterized at Stanford Uni- (2 × 106 cells) dissociated with accutase (Innovative Cell Technoloversity6). The cell line was initially generated such that Cas9 expression gies, catalogue no. AT104) were electroporated using the P3 Primary
can be turned off by adding doxycycline, but doxycycline was not used Cell 4D-NucleofectorTMX Kit L (Lonza, catalogue no. V4XP-3024), a
in this screen. The CAG::Cas9; Dlxi1/2b::eGFP cell line was generated in 4D-nucleofector core unit and X unit (Lonza; nucleofection program no.
the CAG::Cas9 line. The 2242-1 control hiPS cell line used to generate CA-137). Cells were seeded on a well of a six-well plate that was precoated
hCO for the screen and the 1208-2 control hiPS cell line were derived with vitronectin and contained prewarmed Essential 8 medium suppleat Stanford University. The donor for the 1205-4 line was a 30-year-old mented with the ROCK inhibitor Y27632 (10 µM; Selleckchem, catalogue
female; the donor for the 2242-1 line was a 4-year-old male; and the no. S1049). Once the seeded cells reached 70–80% confluency, 1 µg ml−1
donor for the 1208-2 line was a 20-year-old female. of puromycin in StemFlex medium (Life Technologies, catalogue no.
 Briefly, hiPS cells were maintained in six-well plates coated with recom- A3349401) was supplemented for 5 days. Colonies were visible at the
binant human vitronectin (Life Technologies, catalogue no. A14700) end of 5 days of selection in puromycin. Cells were maintained in Stemin Essential 8 medium (Life Technologies, catalogue no. A1517001). Flex medium for another 5 days, and individual colonies were picked
To passage hiPS cell colonies, cells were incubated with 0.5 mM EDTA and maintained separately in a 24-well plate coated with vitronectin.
for 7 min at room temperature, resuspended in Essential 8 medium Cells were maintained in StemFlex medium for another 4 days and were
and distributed into new six-well plates. Cultures were tested and expanded and maintained in Essential 8 medium afterwards. Three sets
maintained mycoplasma free. Approval for the derivation and use of of PCR programs were designed to select colonies that showed the inserthese lines was obtained through the Stanford International Review tion of the left, middle and right parts of the donor DNA (PCR1, 5′-TCC
Board. Validation of hiPS cell genome integrity was performed by TGAGTCCGGACCACTTT and 3′-CACCGCATGTTAGAAGACTTCC;
high-density single-nucleotide polymorphism arrays (Supplemen- PCR2, 5′-TATGGAGATCCCTCGACCTG and 3′-CCTGGGATACCCCGAA
tary Table 10). GAGT; PCR3, 5′-TTCTTCTTGATGCTGTGCCG and 3′-GCTCAAGGGGC
 TTCATGATG). Validation of hiPS genome integrity was performed by
Generating a list of NDD genes for the screen high-density single-nucleotide polymorphism arrays.
We compiled a list of 611 genes associated with ASD and other NDDs
based on genetic studies of patients with NDD10–13 and the SFARI Generation of the CAG::Cas9;Dlxi1/2b::eGFP cell line
database (score 1, 2 and syndromic). To focus on NDDs genes that CAG::Cas9 hiPS cells cultured in a six-well plate were infected with
are expressed in hSO, we assessed gene expression in single-cell RNA lentivirus expressing Dlxi1/2b::eGFP with a hygromycin resistance
sequencing data from Dlxi1/2b::eGFP+ cells6. To ensure a conserva- gene. Cells were maintained in Essential 8 medium for another 3 days
tive threshold, we averaged single-cell data from each of the collected before passaging. One day after passaging, 200 µg ml−1 hygromycin was
samples (from assembloids of hCO and hSO) and plotted the maximum added to the medium to select for infected cells. Cells were maintained
value across samples for each measured gene. We focused on the 425 in hygromycin for 9 days. Control cells without virus infection died
NDD genes (out of 611 total) that showed at least minimal (defined after 4 days of exposure to 200 µg ml−1 hygromycin. Surviving cells
as greater than two read counts) expression in at least one averaged were expanded and cryopreserved for use.
sample. To confirm expression in the developing human forebrain,
we also analysed bulk RNA sequencing data from the ganglionic emi- Generation of the sgRNA library for the screen
nences (medial, caudal and lateral ganglionic eminences) of developing The interneuron migration CRISPR sgRNA library was designed by
primary human brain at 8–9 postconception weeks using the Brain- selecting up to five sgRNAs targeting each of the 438 genes of interest
Span. Specifically, we obtained the maximum averaged expression (425 NDD genes and 13 genes associated with interneuron development)
value (log2 reads per kilobase per million mapped reads, RPKM) across and an extra 10% ‘safe’ harbour-targeting negative control sgRNAs
these samples, which is plotted in Fig. 1a. To visualize developmental (Supplementary Table 2)54. Cloning restriction sites and amplification
expression trajectories of NDDs genes, normalized RPKM (obtained primer handles were appended to each oligo. The sgRNA library oligos
from http://development.psychencode.org/) expression values were were synthesized on the Agilent chip oligo array synthesis platform and
log2 transformed and scaled (using the scale() function in R v.4.1.2 cloned into a lentiviral plasmid vector that constitutively expresses
with default parameters). Data smoothing was performed using the the sgRNA and mCherry.
geom_smooth() (as implemented in the ggplot2 package v.3.3.6) function in R with default parameters. Briefly, this function fits a penalized Generation of hCO and hSO from hiPS cells
cubic regression spline to the data using the restricted maximum likeli- hCO were differentiated from feeder-free maintained hiPS cells, as
hood approach (by calling the mgcv:gam() R function with formula = previously described51. To generate 3D hCO, hiPS cells were dissociy ~ s(x, bs = “cs”) and method = ‘REML’). To visualize the expression of ated with accutase to obtain a single-cell suspension. About 3 × 106
screen hit genes across developing human cortex cell populations, cells were seeded per AggreWell 800 plate well in Essential 8 medium
we analysed previously published single-cell RNA sequencing data supplemented with the ROCK inhibitor Y27632 (10 µM). The plate was
collected from mid-gestation30. Briefly, the raw gene count matrix then centrifuged at 100g for 3 min and incubated overnight at 37 °C with
was downloaded from Gene Expression Omnibus (accession number 5% CO2. The next day (day 0), cellular aggregates were transferred into
GSE162170) and processed using the standard workflow of the R pack- ultra-low attachment plastic dishes (Corning, catalogue no. 3262) and
age Seurat52 (v.4.1.0): including normalization using the sctransform cultured in Essential 6 medium (Thermo Fisher Scientific, catalogue no.
function (vst.flavor = ‘v2’). Using the cell type annotations provided by A1516401) supplemented with dorsomorphin (2.5 µM, Sigma-Aldrich,
the original publication, we visualized normalized gene expression of catalogue no. P5499), SB-431542 (10 µM, R&D Systems, catalogue no.
hit genes in central nervous system derived cell populations. 1614) and XAV-939 (1.25 µM, Tocris, catalogue no. 3748). No medium

Article
change was performed on day 1. Organoids were cultured in E6 medium envelope plasmids using polyethylenimine (Polysciences, catalogue
with patterning molecules from days 2 to 5. On day 6, organoids were no. 24765-100). Media from transfected cells was harvested at 24, 48
transferred to neural medium containing Neurobasal A (Thermo Fisher, and 72 h after transfection. Viruses were concentrated by spinning at
catalogue no. 10888022), B-27 supplement without vitamin A (Life 17,000 rpm at 6 °C for 1 h.
Technologies, catalogue no. 12587), GlutaMax (1:100, Life Technologies,
catalogue no. 35050061) and penicillin-streptomycin (1:100, Thermo Preparation of sequencing libraries
Fisher, catalogue no. 15140163). Neural medium was supplemented Sample-specific sequencing libraries were prepared from the extracted
with 20 ng ml−1 EGF (R&D Systems) and 20 ng ml−1 FGF2 (R&D Systems) genomic DNA of each collected sample by amplifying and barcoding
from day 6 to 24 with daily medium change in the first 10 days, and the lentivirally integrated sgRNA spacer sequence using the Herculase II
every other day for the subsequent 9 days. From day 25 to day 43, neural Fusion DNA Polymerase (Agilent, catalogue no. 600679). Samples were
medium was supplemented with 20 ng ml−1 brain-derived neurotrophic pooled and sequenced on Illumina NextSeq 550 flow cells at 450–1,000
factor (Peprotech, catalogue no. 450-02) and 20 ng ml−1 NT-3 (Pepro- times read depth. Bowtie v.1.2.2 was used to aligne sequencing reads.
tech, catalogue no. 450-03). From day 44, only neural medium without
growth factors was used for medium changes every 4 days. Gellan gum Analysing screen results
(roughly 0.005%, Sigma, catalogue no. G1919-259G, lot SLCF5726) was Screen results were analysed using the casTLE software54, a maximum
added in the medium from day 6 to 15 to avoid spontaneous organoid likelihood estimator that provides for each gene: a casTLE score, a
fusion55. The differentiation of hSO from hiPS cells is similar to hCO log-likelihood ratio that considers the relative enrichment or depletion
differentiation with the following differences in patterning: from day of each gene-targeting sgRNA compared to the distribution of negative
6 to day 11, EGF, FGF2 and XAV-939 (1.25 µM, Tocris, catalogue no. 3748) control sgRNA effects, a casTLE effect size, a log2-transformed maxiwere supplemented to the neural medium; from day 12 to day 24, EGF, mum likelihood estimate of the ratio of cells containing sgRNAs per-
FGF2, XAV-939 and SAG (100 nM, EMD Millipore, catalogue no. 566660) turbing a given gene in one sample compared to another, normalized
were used. Gellan gum (roughly 0.005%) was added in the medium from to the median difference of negative control sgRNAs. In the interneuron
day 6 to 11 to avoid spontaneous organoid fusion. generation screen, genes with at least two sgRNAs having effects less
 than or equal to −1.57 or more than or equal to +1.57, roughly twice the
Generation of hFA s.d. of negative controls and no sgRNAs with opposite effects beyond
To generate hFA, hCO and hSO were generated separately and assem- the threshold, were selected as candidates. In the interneuron migration
bled by placing them in close proximity in 24-well low attachment plates screen, genes with at least two sgRNAs having effects less than or equal
(Corning, catalogue no. 3473), which were placed slightly tilted in the to −2.5 or more than or equal to +2.5, roughly twice the s.d. of negative
incubator56. Medium was changed 3 days later. Assembloids were then controls and no sgRNAs with opposite effects beyond the threshold,
cultured in the 24-well low attachment plates until use, with the plates were selected as candidates. To evaluate the extent of sgRNA drop out
placed flat in the incubator. For the screen and the validations, day 45 in our screen, we assessed the sequencing coverage of the sgRNAs in the
hSO were fused with day 60 hCO, and hFA were used for downstream final samples we collected. We found that for more than 93% of the 2,402
analysis at roughly 30 days postassembly. For the experiments imag- sgRNAs, there were at least ten sequencing counts, which can be used
ing ER morphology, day 60 hSO and hCO were assembled as previ- to calculate the enrichment of a sgRNA54. Furthermore, in the interneuously described6 and hFA were imaged at specific days postassembly ron generation screen, more than 96% of the sgRNAs had at least 100
as described. sequencing counts, whereas in the interneuron migration screen, more
 than 78% of the sgRNAs had at least 100 sequencing counts. R v.4.1.1
Interneuron generation and migration screen and Python v.3.8.5 were used to analyse sequencing data.
CAG::Cas9;Dlxi1/2::eGFP hiPS cells were passaged with accutase 1 day
before infection with the lentiviral library (with 5 µg ml−1 polybrene). Examining mutations in CAG::Cas9;Dlxi1/2b::eGFP cells
Three days later, mCherry+ cells were selected by FACS (collected roughly transuded by lentivirus expressing sgRNAs from the screen
3.6 × 106 cells) and seeded onto vitronectin coated plates to recover and The sgRNAs (Supplementary Table 6) were cloned into the same lenexpand for another 6 days. hSO were generated with these hiPS cells as tiviral plasmid vector used in the screen that constitutively expresses
described above. We observed eGFP+ cells at days 21–23 hSO, which is sgRNA and mCherry. CAG::Cas9;Dlxi1/2b::eGFP hiPS cells were infected
indicative of successful differentiation. We also monitored the morphol- with lentivirus expressing each sgRNA (with 5 μg ml−1 polybrene).
ogy of the organoids. At day 44, hSO were collected for the interneuron mCherry+ cells were enriched by FACS and sparsely seeded on a 10 cm
generation screen. At a similar time, hFA were generated by assembling dish followed by isolation of 48–60 clones from each infected samday 60 hCO generated from an unlabelled hiPS cell line with day 45 hSO. ple. Cells (432 clones total) were cultured in 48-well plates. After one
We generated a total of 1,008 assembloids. Thirty days postassembly, passage, genomic DNA was extracted from cells using the DNeasy 96
hFA were checked for migration under a fluorescence microscope. hFA Blood & Tissue Kit (Qiagen, catalogue no.69581), and PCR was perthat did not pass quality control (that is, showed low GFP signal from the formed with GoTaq G2 Flexi DNA Polymerase (Promega, catalogue
hCO side) were excluded. hFA were then aligned on 100 mm plates with no. M7805) (Supplementary Table 9). PCR products were analysed by
hSO on the left and hCO on the right, and were split at the boundary of Sanger sequencing. The HET and/or homozygous state of each mutant
the assembloid under a dissection scope. hCO and hSO were collected clone was decided by ICE analysis (https://www.synthego.com/prodseparately after checking GFP expression under a fluorescence micro- ucts/bioinformatics/crispr-analysis) combined with manually checking
scope. The hSO showed strong GFP signal in the entire organoid whereas the sequence trace. Among the 432 clones we isolated, 32 clones failed
the hCO showed less GFP signal. The samples were subsequently dissoci- to generate useful sequencing data and 31 clones were mixed clones
ated and populations were sorted out and stored in a −80 °C freezer. We coming from several colonies. In the 369 remining clones, there were
processed roughly 900 assembloids in 8 days. In addition, 5 × 106 hiPS 217 mutated clones and 152 non-mutated clones.
cells and day 19 organoids sampled from all plates were collected. FACS
gating strategies were summarized in Supplementary Fig. 1. Generating KO cell pools with 3× sgRNAs strategy
 To validate the candidate genes of the screen, we generated KO hiPS cell
Lentivirus production pools for genes of interest with the CRISPR–Cas9 system. Three sgRNAs
Lentivirus was produced by transfecting human embryonic kidney targeting an early exon of a specific gene were designed and synthesized
293T cells with lentiviral transfer plasmids, packaging plasmids and by Synthego (see Supplementary Table 6 for the sgRNA sequences) to

induce one or more fragment deletions (Extended Data Fig. 4b). In brief, Quanteon 4025 flow cytometer (Stanford FACS Facility) was used to
CAG::Cas9;Dlxi1/2::eGFP hiPS cells were dissociated with accutase and analyse the percentage of GFP+ cells. NovoExpress (v.1.3.0) was used to
0.5 million cells were mixed with 300 pmol of sgRNAs and 40 pmol of generate flow cytometry data. Data were analysed on FlowJo (v.10.8.1).
Cas9 protein (Synthego, SpCas9 2NLS Nuclease (1,000 pmol)). Nucleofection was performed using the P3 Primary Cell 4D-NucleofectorTMX Real-time quantitative PCR
Kit L (Lonza, catalogue no. V4XP-3032), a 4D-nucleofector core unit For real-time qPCR analysis, 2–3 organoids were pooled as a sample.
and the X unit (Lonza, program no. CA-137). Cells were then seeded mRNA was isolated using the RNeasy Mini Plus kit (Qiagen, catalogue
onto vitronectin coated six-well plates in Essential 8 medium supple- no. 74136) and template complimentary DNA was prepared by reverse
mented with the ROCK inhibitor Y27632 (10 µM). Essential 8 medium transcription using the SuperScript III First-Strand Synthesis Superwas used for daily medium change. To generate SMAD4 and CSDE1 Mix for RT–qPCR (Thermo Fisher Scientific, catalogue no. 11752250).
KO cells from 2242-1 and 1208-2 hiPS cells, these two control cell lines Real-time qPCR was performed using the SYBR Green PCR Master Mix
were first infected with a lentivirus expressing Dlxi1/2b::eGFP followed (Thermo Fisher Scientific, catalogue no. 4312704) on a QuantStudio
by hygromycin selection to stably express eGFP under the control of 6 Flex Real-Time PCR System (Thermo Fisher Scientific, catalogue
Dlxi1/2b. For genotyping, DNA was extracted from hiPS cells using the no. 4485689). Data were processed using the QuantStudio RT–PCR
DNeasy Blood & Tissue Kit (Qiagen, catalogue no. 69506) and PCR was software (Applied Biosystems, v.1.7.1). To plot the heatmap to preperformed with GoTaq G2 Flexi DNA Polymerase (Promega, catalogue sent the qPCR results, gene expression was scaled and mean centred
no. M7805) with primers to amplify DNA sequence around the sgRNA (using the ‘scale’ function in R) and the heatmap was plotted using the
targeting sites of the gene of interest (Supplementary Table 9). The ‘ComplexHeatmap’ package. Primers used in this study are listed in
PCR products were separated by gel electrophoresis and Image Lab Supplementary Table 8.
(v.6.0.1) was used for gel image acquisition.
 Clearing, staining and imaging of hFA
Generation of SMAD4 HET hiPS cells The Clear, Unobstructed Brain/Body Imaging Cocktails and Computa-
The SMAD4 HET hiPS cells from the 2242-1 genetic background were tional analysis (CUBIC) method was applied to optically clear hFA, as
generated from an individual clone isolated from the SMAD4 KO cell previously described58. Briefly, hFA at roughly 40 days postassembly
pool. To generate SMAD4 HET lines in the 1205-4 genetic background, were fixed overnight with 4% paraformaldehyde (PFA) at 4 °C. The next
CAG::Cas9;Dlxi1/2::eGFP hiPS cells were dissociated with accutase and day, samples were washed with PBS (2 h × 3, 37 °C) before incubation
0.5 million cells were mixed with 40 pmol of sgRNA (AAAAAGAGCAAUUG with the Tissue-Clearing Reagent CUBIC-L (TCI, catalogue no. T3740)
AAAGUU) and 5 µg of Cas9 protein (Integrated DNA Technologies (IDT), at 37 °C for roughly 18 h. After washing with PBS (2 h × 3, 37 °C), samples
Alt-R S.p. Cas9 Nuclease V3). Nucleofection was performed in the same were incubated in a nuclear staining solution (1:150 dilution of RedDot,
way as described above. Individual clones were isolated, and the HET Biotium 40061-T) in PBS with 500 mM NaCl at 37 °C overnight. Samples
line was confirmed by Sanger sequencing. were then washed with PBS (2 h × 2, 37 °C) followed by incubation with
 HEPES-TSB (10 mM HEPES, 10% TX-100, 200 mM NaCl, 0.5% BSA) buffer
Preparing samples for next-generation sequencing at 37 °C for 2 h. Samples were subsequently stained with anti-GFP anti-
DNA was isolated from hSO using the DNeasy Blood & Tissue Kit (Qiagen, body (GTX13970, 1:1,000) for 48 h and secondary antibody (Alexa Fluor
catalogue no. 69506). Primers (Supplementary Table 7) with Illumina 488 AffiniPure Donkey Anti-Chicken IgY, Jackson ImmunoResearch
adaptors were used to amplify roughly 300 bp of DNA sequence around catalogue no. 703-545-155, 1:300) for another 48 h. Antibodies were
the sgRNA targeting site of the gene of interest. PCR was performed prepared in HEPES-TSB buffer and hFA were washed with 10% TX-100 in
with the PrimeSTAR Max DNA polymerase 2× hot-start PCR master PBS (2 h × 2, 37 °C) and HEPES-TSB (2 h × 1, 37 °C) in between stains. After
mix (TaKaRa Bio, catalogue no. R045A). PCR products were purified secondary antibody staining, samples were washed with 10% TX-100 in
using the AMPure XP PCR purification system (Beckman Coulter, cata- PBS (30 min × 2, 37 °C) and PBS (1 h × 1, 37 °C) followed by subsequent
logue no. A63881) and the 96S Super Magnet (Alpaqua, catalogue no. incubation with 50 and 100% Tissue-Clearing Reagent CUBIC-R+ (TCI,
A001322) for next-generation sequencing (Azenta). catalogue no. T3741) at room temperature for 1 day each. All incuba-
 tion steps were performed on a shaker. Samples were transferred to a
Dissociation of hCO and hSO 96-well plate with a clear bottom (ibidi, catalogue no. 89626) in CUBIC-R+
hCO and hSO were dissociated as previously described57 with some solution and imaged using a ×10 objective on a Leica Stellaris confocal
modifications. Briefly, organoids (single organoids cultured in a microscope. The entire hCO and the hCO-hSO boundary were imaged
96-well plate or up to eight organoids cultured in a six-well plate) (roughly 1 mm volume per hFA) blindly to the genotype of the samples.
were incubated with an enzyme solution containing 10 U ml−1 papain Images were analysed with Imaris (Oxford Instruments, v.9.7.0)
(Worthington, catalogue no. LS003127), 1× Earle’s balanced salt solu- and Fiji (ImageJ, v.1.0 and v.1.53f51). Briefly, Z-stack confocal images
tion (Sigma-Aldrich, catalogue no. E7510-500ML), 0.36% d(+)-glucose were compiled in Imaris to generate a 3D reconstruction of the hFA.
(Sigma-Aldrich), 26 mM NaHCO3 (Sigma-Aldrich), 0.5 mM EDTA The boundary of the assembloid in individual frames was manually
(Sigma-Aldrich), DNase (Worthington, catalogue no. LS002007), delineated using the nuclear stain signal (roughly every 40 frames);
6.1 mM l-cysteine (Sigma-Aldrich) and the ROCK inhibitor Y27632 these boundaries were used to create an Imaris ‘surface’ to define the
(10 µM) at 37 °C with 5% CO2 for 15 min; this solution was prewarmed hCO (Supplementary Video 1). The 3D hCO was then reduced into a
at 37 °C for 30 min to activate papain, and then cells were washed with two-dimensional (2D) projection using the maximum intensity function
a prewarmed protease inhibitor solution (1× Earle′s balanced salt solu- in Fiji. To measure the Dlxi1/2b::eGFP intensity in a consistent manner
tion, 0.36% d(+)-glucose, 26 mM NaHCO3, 0.2% trypsin inhibitor (Wor- for all samples, the hCO-hSO boundary was aligned vertically. One third
thington, catalogue no. LS003086)). Organoids were then triturated, of the hCO adjacent to the boundary was used to quantify mean intenand the resulting single-cell suspension was centrifuged at 1,200 rpm sity. A representative area of background noise was also measured for
for 5 min. The pellet was resuspended with 3% BSA (Sigma-Aldrich) mean intensity and was subtracted from the measurements of the hCO.
and then filtered.
 Western blotting
Flow cytometry Whole cell protein lysates were prepared using the RIPA buffer system
To sort mCherry+ or GFP+ cells during the screen, FACS was conducted (Santa Cruz, catalogue no. sc-24948) for LNPK, SYNCRIP and TERF2
on BD-Aria II instruments (Stanford FACS Facility). The ACEA NovoCyte blots. For CSDE1 and SMAD4, whole cell protein lysates from samples

Article
were prepared using SDS Buffer (1.5% SDS, 25 mM Tris pH 7.5). Briefly, catalogue no. H3569, 1:10,000 dilution). Fixed hiPS cells and cryosec-
50 µl of SDS buffer was added to two spheres in a 1.5 ml tube. Samples tions were mounted for microscopy on glass slides using Aquamount
were sonicated for a total of 7–9 s using an ultrasonicator (Qsonica (Polysciences, catalogue no. 18606) and imaged on a Leica Stellaris
Q500 sonicator; pulse 3 s on, 3 s off; amplitude 20%) using a small tip confocal microscope. LAS-X (Leica) software was used for acquiring
attachment until samples were no longer viscous. Protein concentra- the microscopy data. Images were processed with Fiji (ImageJ, v.1.0,
tion was quantified using the bicinchoninic acid assay (Pierce, Thermo v.2.3.0). The fraction of cCasp3+ hiPS cells was quantified by imaging
Fisher, catalogue no. 23225). For electrophoresis, 20 μg of protein per three randomly selected colonies from each independent experiment.
lane was loaded and run on a 4–12% Bis-Tris PAGE gel (Bolt 4–12% Bis-Tris The fraction of cCasp3+, SOX2+ and NeuN+ cells in hSOs was quantified
Protein Gel, Invitrogen, catalogue no. NW04122BOX) and transferred by imaging at least three sections from each individual hSO. Following
onto a polyvinyl difluoride membrane (Immobilon-FL, EMD Millipore). background subtraction, nuclei were identified using a threshold and
Membranes were blocked with 5% BSA in tris-buffered saline with Tween watershed algorithm on the Hoechst channel. The mean fluorescence
(TBST) for 1 h at room temperature and incubated with primary anti- intensity within identified nucleus regions was calculated for each
bodies against TERF2 (rabbit 1:2,000, Novus Biologicals, catalogue channel. The same cutoff was used for samples from the same batch
no. NB110-57130SS), SYNCRIP (mouse 1:2,000, MilliporeSigma, catalogue to distinguish positive cells. The data from many sections of the same
no. 05-1517), Atlastin-1 (mouse, 1:500, Sigma, catalogue no. MABN1831, organoid were averaged and then presented in the figure.
Clone 3194) and GAPDH (glyceraldehyde 3-phosphate dehydrogenase)
(mouse, 1:5,000, GeneTex, catalogue no. GTX627408) overnight and Live cell imaging and analysis of Dlxi1/2b::eGFP+ cell migration
LNPK (rabbit, 1:500, Sigma, catalogue no. HPA014205), CSDE-1 (rabbit, To image the Dlxi1/2b::eGFP+ cell migration, hFA were transferred to a
1:500, Abcam, catalogue no. ab201688), and SMAD4 (mouse 1:250, well of a 96-well plate with a clear bottom (ibidi, catalogue no. 89626) in
Santa Cruz Biotechnology, catalogue no. sc-7966) for 72 h at 4 °C. 500 µl of neural medium under environmentally controlled conditions
Membranes were washed three times with TBST and then incubated (37 °C, 5% CO2). Samples were placed in this condition for 30–60 min
with near-infrared fluorophore-conjugated species-specific secondary before imaging on a confocal microscope (Leica, catalogue no. SP8).
antibodies: Goat Anti-Mouse IgG Polyclonal Antibody (IRDye 680RD, hFA were imaged under a ×10 objective at a depth of 50–150 μm and at
1:10,000, LI-COR Biosciences, catalogue no. 926–68070) or Goat a rate of roughly 20 min per frame for 18–22 h. Fiji (ImageJ, v.1.0) was
Anti-Rabbit IgG Polyclonal Antibody (IRDye 800CW, 1:10,000, LI-COR used to quantify the migration of Dlxi1/2b::eGFP+ cells. To estimate the
Biosciences, catalogue no. 926–32211) for 1 h at room temperature. length of individual saltations, Dlxi1/2b::eGFP+ cells showing a swelling
Following secondary antibody application, membranes were washed of the soma were identified, and the distance (in μm) to the new position
three times with TBST, once with TBS and then imaged using a LI-COR of the soma following nucleokinesis was measured manually. The time
Odyssey CLx imaging system (LI-COR) with Image studio software necessary for this movement was used to calculate saltation frequency.
(Licor, v.5.2). Western blots were analysed using Image studio software Only cells that showed at least two complete jumps during the imaging
(Licor, v.5.2) or ImageJ (v2.3.0). See Source Data for full blots. session were included in the analysis, and the averaged saltation length
 of each cell was used in the statistical analysis. Analysis was carried out
Immunofluorescence staining blindly to the genotype.
hiPS cells were fixed in 4% PFA-PBS for 20 min at room temperature. hSO
and hFA were fixed in 4% PFA-PBS overnight at 4 °C followed by dehy- Live cell imaging and analysis of SEC61B-mEGFP+ cell migration
dration in 30% sucrose for 3 days. Subsequently, samples were embed- To image the SEC61B-mEGFP+ cells, hFA (SEC61B-mEGFP+ CTL,
ded in optimal cutting temperature (OCT) compound (Tissue-Tek CAS9-CTL, LNPK KO, or ATL1 KO hSO assembled with unlabelled hCO)
OCT Compound 4583, Sakura Finetek) and 30% sucrose–PBS (1:1) for were imaged under environmentally controlled conditions (37 °C,
cryosectioning (25-μm-thick sections) using a Leica Cryostat (Leica, 5% CO2) on a confocal microscope (Leica Stellaris, ×20 objective,
catalogue no. CM1860). For immunofluorescence staining, cryosec- ×2 zoom). The samples were placed in the controlled environment for
tions were washed with PBS to remove excess OCT. Fixed hiPS cells 1 h before imaging. Samples were imaged at a depth of roughly 12 μm
and cryosections were blocked in 10% normal donkey serum (NDS) and a rate of 10 min per frame for roughly 20 h. Given the short work-
(MilliporeSigma, catalogue no. S30-M) and 0.3% Triton X-100 (Mil- ing distance of the ×20 objective and the nature of 3D floating samliporeSigma, catalogue no. T9284-100ML) diluted in PBS for 1 h at ples, only images at the very bottom of the samples were used. One
room temperature. Sections were then incubated overnight at 4 °C to three images per hFA were obtained for the analysis. Images that
with primary antibodies diluted in PBS containing 10% NDS and 0.3% contain densely packed fast-moving cells were excluded. To analyse
Triton X-100. PBS was used to wash away excess primary antibodies, the percentage of saltatory migrating cells in hCO or hSO showing
and the cryosections were incubated with secondary antibodies in ER displacement, SEC61B-mEGFP+ cells showing saltatory migrations
PBS containing 10% NDS and 0.3% Triton X-100 for 1 h. The following with at least two jumps in the imaging session were selected and cells
primary antibodies were used for staining: anti-Cleaved Caspase-3 showing a swelling of the ER at the leading neural branch preceding
(Asp175) antibody (1:500 dilution, rabbit, Cell Signaling Technology, nuclear translocation were identified as showing ER displacement
catalogue no. 9661), anti-SOX2 antibody (1:200 dilution, goat, R&D, (cells were considered to have this ER displacement if one of the jumps
catalogue no. AF2018), anti-NeuN antibody (1:200 dilution, mouse, showed this displacement). The hCO or hSO with at least three salta-
Abcam, catalogue no. ab104224), anti-GFP antibody (1:1,000 dilution, tory moving cells were included to analyse ‘the percentage of cells with
chicken, GeneTex, catalogue no. GTX13970) and anti-LNPK antibody ER displacement’. When estimating the saltation length and saltation
(1:500, rabbit, Sigma, catalogue no. HPA014205). Alexa Fluor 488 Affin- frequency of SEC61B-mEGFP+ migratory cells, a strategy similar to that
iPure Donkey Anti-Chicken IgY ( Jackson ImmunoResearch, catalogue used for measuring Dlxi1/2b::eGFP+ migrating cells was used. Cells
no. 703-545-155) and Alexa Fluor 568 donkey anti-rabbit IgG (H&L) with at least two complete jumps were included. Fiji (ImageJ, v1.0 and
highly cross-adsorbed secondary antibody (Thermo Fisher Scientific, v1.53f51, and ImageJ2, v.2.3.0/1.53q) was used to analyse the migration
catalogue no. A10042), Alexa Fluor Plus 647 donkey anti-goat IgG (H&L) of SEC61B-EGFP+ cells. Blinding for genotype was used for analysis.
highly cross-adsorbed secondary antibody (Thermo Fisher Scientific, When examining Dlxi1/2b::mScarlet virally labelled hFA (SEC61Bcatalogue no. A32849) and Alexa Fluor 647 donkey anti-mouse IgG mEGFP hSO assembled with unlabelled hCO), Dlxi1/2b::mScarlet+
(H&L) highly cross-adsorbed secondary antibody (Thermo Fisher cells were identified by the florescence signal filling the entire soma
Scientific, catalogue no. A31571) were used in 1:1,000 dilution. The and extending to the leading branch (SEC61B-mEGFP hiPS line
nuclei were visualized with Hoechst33258 (Thermo Fisher Science, also expresses mTagRFP-T tagged LMNB1, which was captured while

imaging mScarlet). ER displacement was examined on the basis of the
SEC61B-mEGFP signal as described above. Reporting summary
 Further information on research design is available in the Nature
Viral labelling for live imaging Portfolio Reporting Summary linked to this article.
hFA (SEC61B-mEGFP hSO assembled with unlabelled hCO) were infected
with lentivirus encoding Dlxi1/2::mScarlet. Briefly, 30 days postassembly, hFA cultured in 24-well low attachment plates with 500 μl of neural Data availability
medium were cultured with virus overnight at 37 °C with 5% CO2. The The data that support the findings of this study are available on request
next day, fresh neural medium (500 μl) was added. The following day, from the corresponding author. The following public dataset were
the medium was replaced with fresh medium. Samples were ready for used to support this study: the SFARI database (https://gene.sfari.org).
live imaging 2 weeks after infection. The single-cell RNA sequencing data from Dlxi1/2b::eGFP+ cells were
 generated by Birey et al.6 and were downloaded from Gene Expression
ASO Omnibus under accession number GSE93811. Trevino et al.30 data were
ASO used in this study was manufactured by IDT (/52MOErC/*/i2MOErT/*/ downloaded from the Gene Expression Omnibus with the accession
i2MOErT/*/i2MOErC/*/i2MOErC/*A*A*C*C*C*A*T*A*A*T*/i2MOErT/*/ number GSE162170. Bulk RNA sequencing data from the developing
i2MOErT/*/i2MOErT/*/i2MOErT/*/32MOErG/). ASO was reconstituted human cortex were generated by psychENCODE (BrainSpan, downin nuclease-free water at a concentration of 1 mM and stored at −20 °C loaded from http://development.psychencode.org/). Source data are
thereafter. In the experiment, 5 μM ASO diluted with neural medium provided with this paper.
was applied to hFA.

Mouse slice electroporation Code availability
Brains from E13-E14 CD1 mouse embryos (not genotyped for sex) The codes for casTLE analysis can be downloaded at https://bitbucket.
were dissected, embedded in 4% low melting temperature agarose org/dmorgens/castle/downloads/. For the analysis of publicly available
and subsequently sectioned in Hanks’ balanced salt solution (HBSS) RNA sequencing data, no custom software algorithms were generated
supplemented with glucose (100 ml of 10× HBSS without Ca or Mg, for this study. All analyses were carried out using standard software
2.5 ml of 1 M HEPES buffer at pH 7.4, 30 ml of 1 M d-glucose, 10 ml of packages with default parameters.
100 mM CaCl2, 10 ml of 100 mM MgSO4 and 4 ml of 1 M NaHCO3) or ACSF
(125 mM NaCl, 2.5 mM KCl, 1 mM MgCl2, 2 mM CaCl2, 1.25 mM NaH2PO4, 51. Yoon, S. J. et al. Reliability of human cortical organoid generation. Nat. Methods 16, 75–78
 (2019).
25 mM NaHCO3, 25 mM glucose) bubbled with 95% oxygen and 5% car- 52. Stuart, T. et al. Comprehensive integration of single-cell data. Cell 177, 1888–1902 e1821
bon dioxide using a Leica vibratome. Next, 300 μm coronal slices with (2019).
readily discernible forebrain structures were placed into tissue culture 53. Andersen, J. et al. Generation of functional human 3D cortico-motor assembloids. Cell
 183, 1913–1929 e1926 (2020).
dishes containing slice culture media (31% HBSS, 60% basal media Eagle, 54. Morgens, D. W., Deans, R. M., Li, A. & Bassik, M. C. Systematic comparison of CRISPR/Cas9
5% FBS, 1% glucose, 1% N2 Supplement (Thermo Fisher Scientific), 1% and RNAi screens for essential genes. Nat. Biotechnol. 34, 634–636 (2016).
 55. Narazaki, G. & Miru, Y. Biocompatible polymers for scalable production of human neural
GlutaMax (Thermo Fisher Scientific) and 1% penicillin-streptomycin)
 organoids. Preprint at bioRxiv https://doi.org/10.1101/2022.03.18.484949 (2022).
for electroporation. Using a sterile, pulled and bevelled glass micropi- 56. Miura, Y. et al. Engineering brain assembloids to interrogate human neural circuits. Nat.
pette, ganglionic eminences were locally coinjected with a CAG-driven Protoc. 17, 15–35 (2022).
 57. Sloan, S. A. et al. Human astrocyte maturation captured in 3D cerebral cortical spheroids
GFP plasmid (pCAG-IRES-GFP, gift from C. Cepko through Addgene,
 derived from pluripotent stem cells. Neuron 95, 779–790 (2017).
plasmid no. 11159, ref. 59) mixed with either a sgRNA–Cas9 complex 58. Miura, Y. et al. Generation of human striatal organoids and cortico-striatal assembloids
(Synthego) directed to mouse Lnpk or Cas9 protein alone. Randomly from human pluripotent stem cells. Nat. Biotechnol. 38, 1421–1430 (2020).
 59. Matsuda, T. & Cepko, C. L. Electroporation and RNA interference in the rodent retina
picked slices were electroporated with horizontally oriented pad-
 in vivo and in vitro. Proc. Natl Acad. Sci. USA 101, 16–22 (2004).
dle electrodes at 50 V using a BTX Square Pulse electroporator and 60. Li, M. et al. Integrative functional genomic analysis of human brain development and
were subsequently grown at the air liquid interface on Millicell cell neuropsychiatric risks. Science 362, eaat7615 (2018).
culture inserts (Millipore catalogue no. PICM03050) for 3 days until
 Acknowledgements We thank J. Bernstein, R. Reimer and members of the Pașca laboratory
live imaging or real-time qPCR. To determine the efficiency of Lnpk for scientific input, especially S. Kanton. This work was supported by the Stanford Brain
knockdown, slices were carefully microdissected to isolate regions Organogenesis Program in the Wu Tsai Neuroscience Institute and Bio-X, Kwan Funds, Senkut
containing EGFP-expressing cells, which were then placed directly Funds, the Ludwig Foundation, the Mann Foundation (S.P.P.) and the Stanford Medicine Dean’s
 Fellowship (to X.M.). We are also thankful for support from the UCSF Program for Breakthrough
in lysis buffer for RNA extraction (Qiagen RNeasy Micro Kit). Animal Biomedical Research, Sandler Foundation (to G.P.). S.P.P. is a New York Stem Cell Foundation
experiments were performed in accordance with National Institutes of (NYSCF) Robertson Stem Cell Investigator, a Chan Zuckerberg Initiative (CZI) Ben Barres
 Investigator and a CZ BioHub Investigator. Flow cytometry analysis and cell sorting were
Health (NIH) guidelines for the care and use of laboratory animals under
 performed on instruments in the Stanford Shared FACS Facility obtained using NIH S10 Shared
protocols approved by the Stanford University’s Administrative Panel Instrument grant (no. S10RR025518-01). Some illustrations were created with BioRender.com.
on Laboratory Animal Care and University of California, San Francisco
 Author contributions X.M. and S.P.P. conceived the project and designed the experiments.
Institutional Animal Care and Use Committees. Mice were housed in an X.M. conducted the differentiation, sample collection and library preparation for the screen.
animal facility on a 12 h/12 h light/dark cycle, with 20–22 °C (68–72 °F) K.W.K. analysed the NDD genes and generated the list of genes used in the screen. D.Y. designed
 and cloned the sgRNA library, sequenced the library and analysed the data with the supervision
and 30–70% humidity. See Source Data 5 for the data used to generate
 of M.C.B. S.K. generated the lentivirus encoding the sgRNA library. X.M. and X.C. performed
bar graphs in Extended Data Fig. 6­. FACS for the screen. X.M., K.I. and N.R. generated the KO cell pools, and performed flow
 cytometry, live imaging and cell migration analysis. M.V.T. performed western blot. X.M., A.A.M.
Statistics and G.P. designed and performed the mouse knockdown experiments. X.M. and S.P.P. wrote
 the manuscript with input from all authors. S.P.P. supervised all aspects of this study.
Data are analysed with GraphPad Prism (v.9.1.0) unless otherwise indi-
 Competing interests Stanford University holds several patents on organoids and assembloids
cated. Data are presented as mean ± s.e.m., unless otherwise indicated. with S.P.P. listed as an inventor.
Distribution of the raw data was tested for normality of distribution;
 Additional information
statistical analyses were performed using the Student’s t-test, Mann– Supplementary information The online version contains supplementary material available at
Whitney test, Kruskal–Wallis test and one- or two-way analysis of vari- https://doi.org/10.1038/s41586-023-06564-w.
ance (ANOVA) with multiple comparison tests as indicated. Sample sizes Correspondence and requests for materials should be addressed to Sergiu P. Pașca.
 Peer review information Nature thanks Kristen Brennand and the other, anonymous, reviewer(s)
were estimated empirically. Blinding of genotypes was used for imaging for their contribution to the peer review of this work.
analyses, flow cytometry analysis and organoid size measurements. Reprints and permissions information is available at http://www.nature.com/reprints.

Article

line. A, Schematic showing the strategy to generate the CAG::Cas9 hiPS cell Hoechst+ hiPS cells (h, n = 9 colonies from 3 passages) and percentage of
line. Dashed lines indicate homologous recombination sites. PCR 1–3 indicate cCasp3+ cells of SOX2+ (i, n = 12 organoids from 3 differentiations) or NeuN+
the three pairs of primers designed to confirm the insertion of the entire donor. ( j, n = 12 organoids from 4 differentiations) cells in hSO. h, j, Two-tailed Mannb–d, PCR confirming the successful amplification of the targeted DNA as Whitney test; h, P = 0.4742; j, P = 0.063; i, P = 0.1933, two-tailed unpaired t-test.
shown in (a). “N”: negative control (PCR product from a control hiPS cell line). k, Schematic showing experimental design for examining the deletion state of
“P”: positive control (PCR product from the donor plasmid). In total, 35 clones mutations in the CAG::Cas9;Dlxi1/2b::eGFP hiPS cells following transduction
were screened, and 3 clones (Clone #29, #31, and #35) were positive in all PCR with a lentivirus expressing an individual sgRNA. l, Analysis of deletion state
reactions. e, Cas9 expression in CAG::Cas9 hiPS cells compared to the parental of mutant hiPS cells transduced by lentiviruses carrying 8 distinct sgRNAs.
cells (n = 7 independent hiPS cell samples) by real-time-qPCR. *** P = 0.0006, Homo: homozygous mutation. Het: heterozygous mutation. The number at the
two-tailed Mann-Whitney test. f, Genome editing efficiency in CAG::Cas9 hiPS bottom of each column indicates the number of mutant clones we acquired for
cells. CAG::Cas9 hiPS cells were infected with a lentivirus harbouring GFP and each sgRNA. m, Analysis of the KO efficiency of mutations reported in (l). If one
a sgRNA against GFP. Infected cells were split into two groups with or without allele had an in-frame deletion/insertion of less than 21 bp, its KO efficiency was
doxycycline (DOX) supplementation to inhibit Cas9 expression. Cells were assumed to be 0. n, Representative live images of hFA at 30 days after assembly.
subjected to flow cytometry to examine the percentage of GFP+ cells. The Day 45 CAG::Cas9;Dlxi1/2b::eGFP hSO were assembled with day 60 unlabeled
percentage of GFP+ cells (–DOX)/percentage of GFP+ cells ( +DOX) at each time hCO. The dashed lines indicate the boundary of hCO and hSO. Data are presented
point was plotted. g, Representative immunofluorescence images of hiPS cells as mean ± s.e.m. (e, h–j).

Article

the screen. a, Sources of the 611 NDD genes. b, Sources of the 425 NDD genes whiskers extend 1.5 times the interquartile range with outliers shown outside
included in the screens. c, Expression trajectories in the human cerebral cortex this range) representation of expression levels; non-hits (n = 392 genes) versus
of the selected 425 NDD genes using the BrainSpan dataset60. Displayed are interneuron generation hits (n = 13 genes): P = 0.2013; non-hits versus
fitted (generalized additive model; denoted with dashed line) z-score normalized interneuron migration hits (n = 33 genes): P = 0.404; two-sided Wilcoxon tests.
expression data with 99% confidence interval shown in grey (n = 425 genes; f, Expression of screen hits summarized by cell cluster based on a single-cell
n = 419 cortical samples). d, e, Expression in hSO Dlxi1/2b::eGFP+ cells of screen RNA sequencing atlas of developing human cortex30.
hit genes compared with non-hit genes. e, Boxplot (horizontal line denotes

size and associated casTLE score for neural differentiation at 19 days of hSO differentiation. Three genes with notable effects are labelled in red.

Article

candidate genes: CSDE1 and SMAD4. a, Estimation of gene perturbation effect h–j, Representative western blotting images and quantifications for KO cell
sizes. Log2 fold change enrichments, normalized to the median of negative ‘safe’- pools generated from the 1205-4 hiPS cell line (h, i, n = 4, ~day 40 hSO, 2
targeting controls, of sgRNAs between the Dlxi1/2::eGFP+ and Dlxi1/2::eGFP− differentiations; j, n = 4, hiPS cells). GAPDH was used as a loading control.
samples are plotted in the indicated color; the distribution of safe-targeting k, Genotype analysis of hiPS cells showing the PCR amplicon of CSDE1 or SMAD4.
sgRNA controls in black. The dashed line is the casTLE-estimated maximum These experiments have been repeated 3 times. l, Amplicon sequencing results
effect size. b, Schematic showing 3 sgRNAs designed to target an exon of the from genomic DNA extracted from day 40 hSO. m–o, Representative western
gene of interest to generate multiple fragment deletions. c–d, Genotype blotting images and quantification of CSDE1 (m) and SMAD4 (n, o) abundance
analysis of hiPS cells (c) or day–40 hSO (d) showing the PCR amplicon of in day 40 hSO (n = 4 differentiations for each). GAPDH was used as a loading
individual candidate genes. These experiments have been repeated 3 times. control. p, Percentage of Dlxi1/2b::GFP+ cells in ~day–40 hSO (Cas9-CTL, n = 37,
e–g, Amplicon sequencing results from genomic DNA extracted from day–40 SMAD4 HET, n = 46, from 3 differentiations). Two-tailed Mann-Whitney test.
hSO derived from CSDE1 KO (e), SYNCRIP KO (f) or SMAD4 KO (g) cells. The **** P < 0.0001. Data are presented as mean ± s.e.m. (h–j, m–p).
percentage of each amplicon that is more than 2% is presented. In (g), 138, 138’

Article

effects of TERF2 loss on interneuron saltatory migration. a, Estimation of organoid was processed as one sample. Kruskal-Wallis test (P = 0.1316). k, hSO
gene perturbation effect sizes. Log 2 fold change enrichments, normalized size over time (from 4 differentiations). mixed model two-way ANOVA
to the median of negative ‘safe’-targeting controls, of sgRNAs between the (genotype as factor, F2,42 = 3.329) using Dunnett’s multiple comparison test.
Dlxi1/2::eGFP+ and Dlxi1/2::eGFP− samples are plotted in the indicated color; * P = 0.0324. l, Left, a representative immunofluorescence image showing LNPK
the distribution of safe-targeting sgRNA controls is shown in black. The dashed expression in hSO. Right, inset showing LNPK co-localizes with SEC61B-mEGFP
line is the casTLE-estimated maximum effect size. b–c, Genotype analysis of in hSO derived from SEC61B-mEGFP hiPS cells. This experiment has been
hiPS cells (b) or day 40 hSO (c) showing the PCR amplicon of individual repeated 3 times. m, Saltatory migration of Dlxi1/2b::eGFP+ cells in the hCO
candidate genes. These experiments have been repeated 3 times. d–e, NGS side of the Cas9-CTL and TERF2 KO hFA. Triangles mark the nucleus and arrows
analysis of amplicons amplified from genomic DNA extracted from day 40 hSO mark the dilation that moves before nuclear translocation. n–p, Saltation
derived from TERF2 KO (d) and LNPK KO (e) cells. The percentage of each length, number of saltations, and speed of movement of Dlxi1/2b::eGFP+ cells
amplicon that is more than 2% is presented. In (d), TERF2 116’ has an additional in the hCO side of the hFA (Cas9-CTL, n = 47 cells from 14 hFA; TERF2 KO, n = 26
21 bp insertion. f–i, Representative western blotting images and quantifications cells from 8 hFA, from 3-4 differentiations). n, **** P < 0.0001, two-tailed
showing TERF2 (f, g) and LNPK (h, i) abundance in KO and Cas9-CTL hSO unpaired t-test. o, p, Two-tailed Mann-Whitney test. o, P = 0.5497, p, * P = 0.0267.
(day 60–80, n = 3 samples). GAPDH was used as a loading control. j, Percentage Data are presented as mean ± s.e.m. (g, i, j, k, n–p).

Article

a, Schematic illustrating the experimental design for investigating the role of sgRNAs-Cas9 complex targeting mouse Lnpk. Triangles mark the nucleus.
LNPK in mouse interneuron migration. b, Quantification of Lnpk mRNA d–f, Quantification of the saltation length (d, two-tailed unpaired t-test;
expression in the microdissected tissue (n = 4, each datapoint represents **** P < 0.0001), number of saltations (e, two-tailed Mann-Whitney test;
microdissected slices from 2-3 embryos). Data are presented as mean ± s.e.m.; *** P = 0.0002), and speed of movement of electroporated cells (f, two-tailed
two-tailed Mann-Whitney test. * P = 0.0286. c, Representative time-lapse Mann-Whitney test; **** P < 0.0001). Data are presented as mean ± s.e.m.;
sequences of live cell imaging showing the saltatory migration of GFP+ cells in Cas9-CTL, n = 23 cells; Lnpk KO, n = 20 cells; from 10 embryos).

migrating human neural cells. a, Example image showing measurements to Fig. 4c). Black triangles indicate nuclear translocations.
study ER displacement and nuclear translocation. b–c, Relation of nuclear and

Article

cells. a–b, Time-lapse sequences of a SEC61B-mEGFP+ cell in hSO (a) or hCO (b) movement. The cell in (a) showed no detectable ER displacement. The cell in (b)
moving in a saltatory pattern. The hFA is generated by assembly of SEC61B- has partial ER signal “left behind” the nucleus after nuclear translocation.
mEGFP hSO with unlabeled hCO. Triangles mark the nucleus and arrows mark

Dlxi1/2b::mScarlet+ cells. a, Left: Immunofluorescence cryosection images of of a SEC61B-EGFP+ cell that was co-labelled with Dlxi1/2b::mScarlet (at ~60 days
hFA obtained by assembly of unlabeled hCO with SEC61B-mEGFP hSO. Right: post-assembly). Triangles mark the nucleus and arrows mark the linear or dilated
Inset showing the ER distribution in SEC61B-mEGFP+ cells migrated into the structure of the ER during migration (n = 5 hFA). c, Percentage of SEC61B-mEGFP
hCO. Triangles mark the nucleus and arrows mark the linear or dilated structure and Dlxi1/2b::mScarlet double positive migratory cells showing ER displacement.
of the ER in the leading branch. From 2 experiments in n = 7 hFA. b, Representative Live images were taken from both hCO and hSO sides (n = 5 hFA).

Article

and saltation length of hSO saltatory migrating cells. A, Genotype analysis western blotting image showing atlastin-1 abundance. GAPDH was used as
of genomic DNA extracted from hSO showing the PCR amplicon of LNPK. a loading control. k, Quantification of atlatin-1 abundance (n = 5 from 4
b, Representative western blotting image showing LNPK expression in LNPK KO differentiations). l, Schematic illustrating experimental design for performing
and Cas9-CTL hSO derived from the SEC61B-mEGFP hiPS cells. GAPDH was live imaging on the hSO side of the hFA to observe saltatory migration.
used as a loading control. c, Quantification of LNPK abundance (n = 4, from 3 m, Percentage of saltatory migrating SEC61B-mEGFP+ cells showing ER
differentiations). d, Representative time-lapse sequences of SEC61B-mEGFP+ displacement (Cas9-CTL, n = 46 cells from 12 hFA from 3 differentiations,
cells moving in a saltatory pattern in hSO assembled with an unlabeled hCO. 34 cells displayed ER displacement; ATL1 KO, n = 22 cells from 9 hFA from 2
ER displacement was detectable in the last three steps of the four in Cas9-CTL, differentiations, 8 cells displayed ER displacement; two-sided Chi-square test,
but not in the LNPK KO. e, Percentage of SEC61B-mEGFP+ saltatory moving cells ** P = 0.0029). n–p, Quantification of saltation length (n, ** P = 0.0067), number
in the hSO side of the hFA showing ER displacement (hFA at 29–52 days after of saltations (o, P = 0.5891), and speed of movement (p, P = 0.2646) of SEC61Bassembly. n = 15 hFA from one differentiation). * P = 0.0218, two-tailed Mann- mEGFP+ cells in (m) (Cas9-CTL, n = 46 cells, from 3 differentiations; ATL KO,
Whitney test. f–h, Quantification of saltation length, number of saltations, and n = 22 cells from 2 differentiations); two-tailed Mann-Whitney test. Data are
speed of movement of SEC61B-mEGFP+ cells in (d) (Cas9-CTL, n = 73 cells; LNPK presented as mean ± s.e.m. (c, e, f–h, k, n–p).
KO, n = 68 cells). f, ** P = 0.0042, g, h **** P < 0.0001, two-tailed Mann-Whitney

nature portfolio | reporting summary
 Corresponding author(s): Sergiu Pasca
 Last updated by author(s): July 19, 2023

Reporting Summary
Nature Portfolio wishes to improve the reproducibility of the work that we publish. This form provides structure for consistency and transparency
in reporting. For further information on Nature Portfolio policies, see our Editorial Policies and the Editorial Policy Checklist.

Statistics
For all statistical analyses, confirm that the following items are present in the figure legend, table legend, main text, or Methods section.
n/a Confirmed
 The exact sample size (n) for each experimental group/condition, given as a discrete number and unit of measurement
 A statement on whether measurements were taken from distinct samples or whether the same sample was measured repeatedly
 The statistical test(s) used AND whether they are one- or two-sided
 Only common tests should be described solely by name; describe more complex techniques in the Methods section.

 A description of all covariates tested
 A description of any assumptions or corrections, such as tests of normality and adjustment for multiple comparisons
 A full description of the statistical parameters including central tendency (e.g. means) or other basic estimates (e.g. regression coefficient)
 AND variation (e.g. standard deviation) or associated estimates of uncertainty (e.g. confidence intervals)

 For null hypothesis testing, the test statistic (e.g. F, t, r) with confidence intervals, effect sizes, degrees of freedom and P value noted
 Give P values as exact values whenever suitable.

 For Bayesian analysis, information on the choice of priors and Markov chain Monte Carlo settings
 For hierarchical and complex designs, identification of the appropriate level for tests and full reporting of outcomes
 Estimates of effect sizes (e.g. Cohen's d, Pearson's r), indicating how they were calculated
 Our web collection on statistics for biologists contains articles on many of the points above.

Software and code
Policy information about availability of computer code
 Data collection Image Lab (V 6.0.1) was used for gel image acquisition. LAS-X (Leica) software was used for acquiring the microscopy data. Image Studio (V5.2)
 was used to acquire western blotting data. QuantStudio Real-Time PCR software (V1.7.1) was used to collect qPCR data. NovoExpress (V1.3.0)
 was used to generate flow cytometry data. Bowtie 1.2.2 was used to aligne sequencing reads.

 Data analysis Flow optometry data were analyzed with FlowJo (V10.8.1). The GraphPad Prism (V9.1.0) was used for statistical analyses. Fiji (ImageJ, V1.0
 and V1.53f51, and ImageJ2, V2.3.0/1.53q) was used for image quantification and processing. Imaris (V9.7.0) was used to process images. R
 4.1.1 and Python 3.8.5 were used to analyze sequencing data. R version 4.1.2 was used to analyze disease genes expression. casTLE (https://
 bitbucket.org/dmorgens/castle/downloads/) was used to analyze CRISPR screen data. Image Studio (V5.2) was used to analyze western
 blotting data. ICE analysis (Synthego) was used to analyze the heterozygous/homozygous state of each mutant clone.
For manuscripts utilizing custom algorithms or software that are central to the research but not yet described in published literature, software must be made available to editors and
reviewers. We strongly encourage code deposition in a community repository (e.g. GitHub). See the Nature Portfolio guidelines for submitting code & software for further information.
 March 2021

 1

nature portfolio | reporting summary
Data
Policy information about availability of data
 All manuscripts must include a data availability statement. This statement should provide the following information, where applicable:
 - Accession codes, unique identifiers, or web links for publicly available datasets
 - A description of any restrictions on data availability
 - For clinical datasets or third party data, please ensure that the statement adheres to our policy

The data that support the findings of this study are available on request from the corresponding author. The following public datasets were used to support this
study: the Simons Foundation Autism Research Initiative (SFARI) database (https://gene.sfari.org/). The single-cell RNA-sequencing data from Dlxi1/2b::eGFP+ cells
were generated by Birey et al.6 and were downloaded from Gene Expression Omnibus (GEO) under accession numbers GSE93811. Trevino et al.30 data were
downloaded from the Gene Expression Omnibus with the accession number GSE162170. Bulk RNA-seq data from the developing human cortex were generated by
psychENCODE (BrainSpan, downloaded from: http://development.psychencode.org/).

Human research participants
Policy information about studies involving human research participants and Sex and Gender in Research.

 Reporting on sex and gender N/A

 Population characteristics N/A

 Recruitment N/A

 Ethics oversight N/A

Note that full information on the approval of the study protocol must also be provided in the manuscript.

Field-specific reporting
Please select the one below that is the best fit for your research. If you are not sure, read the appropriate sections before making your selection.

 Life sciences Behavioural & social sciences Ecological, evolutionary & environmental sciences
For a reference copy of the document with all sections, see nature.com/documents/nr-reporting-summary-flat.pdf

Life sciences study design
All studies must disclose on these points even when the disclosure is negative.
 Sample size Sample sizes were estimated empirically, based on previous studies (Birey et al., Nature 2017; Marton et al., Nature Neuroscience; Pasca et al,
 Stem Cell 2022).

 Data exclusions When analyzing the percentage of saltatory migrating cells that showed ER displacement, 4 images containing densely packed fast-moving
 cells that are different from other collected images were excluded. In addition, organoids having less than 3 migrating cells were not included.

 Replication Data shown in representative experiments was repeated with similar results in at least 3 independent experiments. All attempts at replication
 were successful. Sample sizes for other experiments were indicated in Figure legends. Data in Extended Data Fig. 10 e-h was collected from
 multiple organoids in one differentiation and part of these results verified findings in Fig. 3h and Fig. 4 f-i. NGS validation of the deletion of
 the candidate genes was performed once as it is standard practice and results were consistent with PCR genotyping experiments.

 Randomization Organoids and assembloids were randomly picked from cell culture plates for each assay. For the experiment used mouse tissues, mouse
 brain slices were randomly grouped for control and experimental treatment.

 Blinding Blinding of genotypes was used for all imaging analysis, flow cytometry analysis, and organoid size measurements. Blinding was not used or
 March 2021

 was not relevant for other experiments.

Reporting for specific materials, systems and methods
We require information from authors about some types of materials, experimental systems and methods used in many studies. Here, indicate whether each material,
system or method listed is relevant to your study. If you are not sure if a list item applies to your research, read the appropriate section before selecting a response.

 2

Materials & experimental systems Methods

 nature portfolio | reporting summary
n/a Involved in the study n/a Involved in the study
 Antibodies ChIP-seq
 Eukaryotic cell lines Flow cytometry
 Palaeontology and archaeology MRI-based neuroimaging
 Animals and other organisms
 Clinical data
 Dual use research of concern

Antibodies
 Antibodies used Anti-GFP (Chicken, GeneTex, GTX13970, 1:1000 dilution), Lot # 822104593
 Anti-GAPDH (mouse, 1:5000, GeneTex,GTX627408), lot#41268
 Anti-LNPK (rabbit, 1:500, Sigma, HPA014205), lot# 000013636
 Anti-CSDE-1 (Rabbit, Abcam, ab201688, Lot# GR3352903-3)
 Anti-SMAD4 (Mouse, Santa Cruz biotechnology, sc-7966, Lot# I2122)
 Anti-TERF2 (Rabbit, Novus biologicals, NB110-57130SS, Lot# D107745-1)
 Anti-hnRNP Q (SYNCRIP, mouse, Sigma, 05-1517, Lot# 3485009)
 Anti-Cleaved Caspase-3 (rabbit, Cell Signaling Technology, 9661, lot# 47)
 Anti-SOX2 antibody (goat, R&D, AF2018, lot# KOY0622062)
 Anti-NeuN antibody (mouse, Abcam, ab104224, lot# GR3341933-1)
 Anti-Atlastin-1 antibody (mouse, Sigma, MABN1831, Clone 3194, lot# 3837025)
 Goat Anti-Mouse IgG Polyclonal Antibody (IRDye 680RD, 1:10,000, LI-COR Biosciences, 926–68070)
 Goat Anti-Rabbit IgG Polyclonal Antibody (IRDye 800CW, 1:10,000, LI-COR Biosciences, 926–32211)
 Alexa Fluor® 488 AffiniPure Donkey Anti-Chicken IgY (Jackson ImmunoResearch 703-545-155)
 Alexa Fluor Plus 647 donkey anti-goat IgG (H&L) (Thermo Fisher Scientific, A32849)
 Alexa Fluor 647 donkey anti-mouse IgG (H&L) (Thermo Fisher Scientific, A31571)
 Alexa Fluor 568 donkey anti-rabbit IgG (H&L) (Thermo Fisher Scientific, A10042)

 Validation Anti-GFP: Used in our previous study (Miura et.al., Nature Biotechnology, 2020) and in 31 studies according to the manufacture's
 website.
 Anti-GAPDH: This antibody has been used in at least several hundreds of studies according to the manufacture's website.
 Anti-LNPK: According to the manufacture's website, this antibody has been validated by the Human Protein Atlas project. In addition,
 this antibody has also been used by several other studies, including Breuss et.al., The American Journal of Human Genetics, 2018 and
 Yuniati et.al., Cell Reports, 2020.
 Anti-CSDE-1: This antibody has been tested on several positive samples according to the manufacture's website.
 Anti-SMAD4: This antibody has been used in more than 10 studies according to the manufacture's website.
 Anti-TERF2: This antibody has been used in more than 80 studies according to the manufacture's website.
 Anti-hnRNP Q: This antibody has been validated with positive samples and have been used by more than 5 studies according to the
 manufacture's website.
 Anti-Cleaved Caspase-3: used in our previous study (Pasca et al., Nature Medicine, 2019)
 Anti-SOX2: this antibody has been used in 186 studies according to the manufacture's website.
 Anti-NeuN: used in our previous study (Miura et al., Nature Biotechnology, 2020)
 Anti-Atlastin-1: this antibody has been evaluated by Western Blotting in human brain tissue lysate according to the manufacture's
 website.
 Goat Anti-Mouse IgG Polyclonal Antibody: We have used this antibody in our previous study (Birey et.al., Cell Stem Cell, 2022). Based
 on the manufacture's technical note, this antibody has been validated and used in multiple studies.
 Goat Anti-Rabbit IgG Polyclonal Antibody: We have used this antibody in our previous study (Birey et.al., Cell Stem Cell, 2022). Based
 on the manufacture's technical note, this antibody has been validated and used in multiple studies.
 Alexa Fluor® 488 AffiniPure Donkey Anti-Chicken IgY: this antibody has been used in 261 studies according to the manufacture's
 website.
 Alexa Fluor Plus 647 donkey anti-goat IgG (H&L): this antibody has been used in 1010 studies according to the manufacture's website.
 Alexa Fluor 647 donkey anti-mouse IgG (H&L): this antibody has been used in 1570 studies according to the manufacture's website.
 Alexa Fluor 568 donkey anti-rabbit IgG (H&L): this antibody has been used in 1025 studies according to the manufacture's website.

Eukaryotic cell lines
Policy information about cell lines and Sex and Gender in Research
 Cell line source(s) Three hiPS cell lines (1205-4, 2242-1, and 1208-2) were reprogrammed at Stanford University from fibroblasts harvested with
 March 2021

 IRB approval and following written consent.
 The SEC61B-mEGFP hiPS cell line (AICS-0059 cl.36) was derived at the Allen Institute for Cell Science and the line was
 obtained under an inter-institutional MTA.
 HEK293T cell line was ordered from Takara (Cat. # 632180)

 Authentication hiPS cell lines were authenticated by SNP arrays.

 Mycoplasma contamination All cell lines were regularly tested and maintained Mycroplasma free

 3

Commonly misidentified lines No commonly misidentified lines used in this study
 (See ICLAC register)

 nature portfolio | reporting summary
Animals and other research organisms
Policy information about studies involving animals; ARRIVE guidelines recommended for reporting animal research, and Sex and Gender in
Research

 Laboratory animals E13-E14 CD1 mouse embryos were used in this study.

 Wild animals No wild animals were used in the study

 Reporting on sex Mouse embryos were used in the experiment without knowing the sex of the embryos.

 Field-collected samples No field collected samples were used in the study.

 Ethics oversight Animal work was performed under protocols approved by the Stanford University’s Administrative Panel on Laboratory Animal Care
 (APLAC) and a University of California, San Francisco Institutional Animal Care and Use Committees.
Note that full information on the approval of the study protocol must also be provided in the manuscript.

Flow Cytometry
Plots
 Confirm that:
 The axis labels state the marker and fluorochrome used (e.g. CD4-FITC).
 The axis scales are clearly visible. Include numbers along axes only for bottom left plot of group (a 'group' is an analysis of identical markers).
 All plots are contour plots with outliers or pseudocolor plots.
 A numerical value for number of cells or percentage (with statistics) is provided.

Methodology
 Sample preparation Organoids (single organoids cultured in a 96-well plate or up to 8 organoids cultured in a 6-well plate) were incubated with an
 enzyme solution containing 10U/ml papain (Worthington, LS003127), 1x EBSS (Sigma-Aldrich, E7510-500ML), 0.36% D(+)-
 Glucose (Sigma-Aldrich), 26 mM NaHCO3 (Sigma-Aldrich), 0.5 mM EDTA (Sigma-Aldrich), DNase (Worthington, LS002007), 6.1
 mM L-Cysteine (Sigma-Aldrich), and the ROCK inhibitor Y-27632 (10 μM) at 37°C with 5% CO2 for 15 min; this solution was
 pre-warmed at 37°C for 30 minutes to activate papain, and then cells were washed with a pre-warmed protease inhibitor
 solution (1x EBSS, 0.36% D(+)-Glucose, 26 mM NaHCO3, 0.2% trypsin inhibitor (Worthington LS003086)). Organoids were
 then triturated, and the resulting single cell suspension was centrifuged at 1,200 rpm for 5 minutes. The pellet was
 resuspended with 3% BSA (Sigma-Aldrich) and then filtered.
 hiPS cells were dissociated with accutase and filtered before sorting.

 Instrument BD FACS Aria II and ACEA NovoCyte Quanteon 4205.

 Software BD FACSDiva Software for FACS, and NovoExpress software for analyzing the percentage of GFP positive cells. FlowJo was
 used for data analysis.

 Cell population abundance The purity of the sample were determined by either GFP or mCherry fluorescence.

 Gating strategy In all the sorting and analysis experiments, a similar differentiation or hiPS cells without any fluorescence were used as
 negative control to set the gate.

 Tick this box to confirm that a figure exemplifying the gating strategy is provided in the Supplementary Information.
 March 2021

 4

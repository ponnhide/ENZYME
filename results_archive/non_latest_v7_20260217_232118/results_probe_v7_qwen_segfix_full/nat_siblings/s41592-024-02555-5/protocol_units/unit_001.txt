methods

Article https://doi.org/10.1038/s41592-024-02555-5

Multiplexing cortical brain organoids for the
longitudinal dissection of developmental
traits at single-cell resolution

Received: 18 August 2023 Nicolò Caporale 1,2,6,7, Davide Castaldi 1,2,6, Marco Tullio Rigoli1,2,6,
 Cristina Cheroni2, Alessia Valenti1,2, Sarah Stucchi1,2, Manuel Lessi 1,2,
Accepted: 31 October 2024
 Davide Bulgheresi 2, Sebastiano Trattaro 2, Martina Pezzali 1,2,
Published online: 9 December 2024 Alessandro Vitriolo2, Alejandro Lopez-Tobon2, Matteo Bonfanti2, Dario Ricca ,
 2

 Katharina T. Schmid 3,4, Matthias Heinig 3,4, Fabian J. Theis 3,4,
 Check for updates
 Carlo Emanuele Villa2,7 & Giuseppe Testa 1,2,5,7

 Dissecting human neurobiology at high resolution and with mechanistic
 precision requires a major leap in scalability, given the need for
 experimental designs that include multiple individuals and, prospectively,
 population cohorts. To lay the foundation for this, we have developed and
 benchmarked complementary strategies to multiplex brain organoids by
 pooling cells from different pluripotent stem cell (PSC) lines either during
 organoid generation (mosaic models) or before single-cell RNA sequencing
 (scRNA-seq) library preparation (downstream multiplexing). We have also
 developed a new computational method, SCanSNP, and a consensus call to
 deconvolve cell identities, overcoming current criticalities in doublets and
 low-quality cell identification. We validated both multiplexing methods
 for charting neurodevelopmental trajectories at high resolution, thus
 linking specific individuals’ trajectories to genetic variation. Finally, we
 modeled their scalability across different multiplexing combinations
 and showed that mosaic organoids represent an enabling method for
 high-throughput settings. Together, this multiplexing suite of experimental
 and computational methods provides a highly scalable resource for brain
 disease and neurodiversity modeling.

The polygenic underpinnings of human neurodiversity, in its physi- Toward these overarching goals, brain organoid and single-cell
ological and pathological unfolding alike, have been eloquently multiomic technologies have afforded major strides in the mechanisreferred to as terra incognita, calling for new maps to trace that tic dissection of human neurodevelopment, enabling transformative
unfolding in the authenticity of human genetic backgrounds and insights from the study of genetic and environmental causes of neuthereby render it mechanistically actionable. Developmental sto- ropsychiatric disorders, a community-wide effort to which we and
chasticity and environmental triggers add to such complexity, and the several others have been contributing2,5–14. Importantly, our recent
increasingly broader range of exposome that is becoming measurable benchmark of cortical brain organoids (CBOs) compared to the human
promises to make gene–environment interactions finally tractable fetal cortex confirmed the preservation in CBOs of transcriptional
at meaningful scales1–4. programs pinpointed as relevant for disease modeling15.

A full list of affiliations appears at the end of the paper. e-mail: giuseppe.testa@fht.org

Nature Methods | Volume 22 | February 2025 | 358–370 358

Article https://doi.org/10.1038/s41592-024-02555-5

 Despite these advances, the characterization of brain organoids Experimental assessment of mCBOs
at single-cell resolution from entire cohorts and, in perspective, at We first characterized mCBOs by immunofluorescence for canonipopulation scale remains however an unmet challenge, although an cal markers of neurodevelopment previously defined for organoids
obviously required one if we are to capture how individual genomes differentiated with the same protocol by us and others15,40,41 and conand developmental trajectories shape variability in vulnerability and firmed their expected expression patterns (Fig. 2a,b and Extended
resilience across the spectrum of neurodiversity16–18. Scaling up human Data Fig. 1a–c). Next, to estimate the stability of the presence of the
brain organoid modeling and molecular profiling by single-cell omics different PSC lines within mCBOs throughout development, we used a
would allow us to understand how the molecular causes of neurodevel- two-pronged approach. First, we longitudinally assessed the proliferaopmental disorders trigger deviations from physiological trajectories19, tion rate of organoids derived from individual lines in two differentiain line with the expanding set of population-level single-cell studies20,21. tion replicates through flow cytometry-based cell cycle analysis. This
This is however still an experimental and analytical challenge due to showed similar proliferative trends across lines, with the expected
high cost and workload and to the inherent batch-to-batch variability decrease in proliferation along differentiation and no substantial variof the complex experimental designs required. ations in the proliferative rate of the different lines over time points
 To overcome some of these problems, progress has been made (Fig. 2c,d and Supplementary Data 1). Next, we probed the extent to
in single-cell multiplexing strategies, including methods based on which individual lines, despite homogeneous proliferation rates in
sample barcoding22–26 and methods leveraging the detection of natu- isolation, could still yield skewed distributions when grown as mosaics.
ral genetic variants27–30. These approaches have indeed proven to be In line with in vivo evidence of high asymmetric clonality during human
instrumental for population genetics and disease-modeling studies, brain development42, the quantification of genotypes from single-cell
including through co-culture of cell lines derived from multiple donors transcriptomics confirmed a variable degree of balance between indiin a single dish31–39. vidual lines during mCBO differentiation (Extended Data Fig. 2).
 However, multiplexing has not yet been systematically applied
to organoids, a challenge that is particularly relevant for the brain Benchmarking of demultiplexing algorithms
given the long-term longitudinal unfolding of highly heterogeneous The single-cell transcriptomics datasets generated from both mosaic
combinations of cell types, and the field still lacks studies able to and downstream multiplexed organoids at early, mid and late stages
establish the experimental and computational viability of applying of differentiation (Fig. 1b) were demultiplexed using three differmultiplexing strategies to complex three-dimensional experimental ent state-of-the-art algorithms available for genetic demultiplexing
systems. (demuxlet27, souporcell28, Vireo29). We observed a high number of pre-
 We thus implemented and benchmarked complementary strate- dicted doublets with an unexpected read count distribution skewed
gies to multiplex human brain organoidogenesis in vitro, pooling PSCs toward low values when compared to singlets (Extended Data Fig. 3a,b).
coming from different individuals either during organoid generation, This was associated with a variable degree of unassigned cells and identermed the mosaic model according to standardized guidelines for tity call agreement among tools (Extended Data Fig. 3c,d). We thus
brain organoid nomenclature we recently contributed to40, or before set out to develop a new method, SCanSNP (Fig. 3a), to overcome the
scRNA-seq library preparation. To improve genetic-based cell identi- observed limitations by (1) dividing the classification challenge into two
fication when dealing with brain organoid single-cell transcriptomes, steps, one for identity assignment and one for doublet detection and
we developed an in silico deconvolution method (SCanSNP), which (2) measuring the genetic purity of each droplet to identify low-quality
we benchmarked against existing deconvolution tools, producing a droplets and separate them from authentic doublets. Finally, to conconsensus pipeline for robust genotype identification across data- solidate deconvolution accuracy, we set a consensus call framework
sets of different quality. Finally, we evaluated the two multiplexing considering the strengths and weaknesses of each algorithm, including
paradigms through a deep reconstruction of neurodevelopmental non-genetic-based tools for doublets and low-quality cell detection43,44,
trajectories, provided proof of principle of their suitability for linking merging their outcomes into one combined output (Fig. 3b).
genetic variation to neurodevelopmental trajectory phenotypes and Next, we performed demultiplexing again using all the above
modeled the scalability of the system, analyzing different multiplexing methods. We found that all three thus far available tools tended to
combinations with an increasing number of lines. This provides the overestimate doublets, if compared to the theoretically expected rate,
community with an enabling resource for scaling up brain organoid SCanSNP or the consensus call (Fig. 3c). Notably, doublets identified
modeling to the challenges of human neurodiversity. by SCanSNP and the consensus call were the only ones for which the
 average log count distribution of unique molecular identifiers was, as
Results expected, higher than that for singlets (Fig. 3e). This suggests a bias
Single-cell analysis of multiplexed CBOs of existing algorithms in doublet detection that includes low-quality
To test the feasibility of multiplexed brain organoid modeling over droplets that SCanSNP is instead able to identify (Extended Data
extended developmental time courses, we developed an experimental Fig. 3c). Accordingly, the evaluation of agreement rate in the assigndesign comparing two approaches with distinctive features in terms ment of individual identity across algorithms highlighted a high overall
of scaling, standardization potential and experimental challenges: agreement for singlet calls, with cases of lower agreement coinciding
(1) pooling PSC lines from multiple donors to generate mosaic CBOs with datasets that had higher genotype imbalance (Extended Data
(mCBOs) and (2) generating CBOs individually and pooling them only Fig. 3d). On the other hand, we observed that doublet detection agreebefore single-cell droplet encapsulation (hereafter referred to as down- ment was consistently lower (Extended Data Fig. 3d). To additionally
stream multiplexing) (Fig. 1a and the Methods). For the first strategy, assess the demultiplexing performance of the different algorithms,
we pooled PSC lines (5,000 cells per line) before organoid generation we benchmarked them with ground truth priors using (1) five in silico
and longitudinally profiled the resulting mCBOs through scRNA-seq at multiplexed datasets with varying degree of balance among genotypes
50, 100 and 300 d of differentiation, following the same protocol previ- and (2) two ad hoc experiments in which the different genotypes were
ously used and benchmarked in our laboratory5,11,15. For downstream barcode tagged before pooling. As shown in Fig. 3d, in the simulated
multiplexing, CBOs were generated individually from the PSC lines and datasets, all demultiplexing algorithms performed better in balanced
profiled at the same time points, pooling equal amounts of cells per cases, and SCanSNP was the most accurate in both balanced and imballine after organoid dissociation for single-cell library preparation. For anced settings. The superior performance (comparison against cellboth approaches, individual cell identity was demultiplexed through ranger multi; Methods) delivered by SCanSNP was confirmed in the
genetic variation (Fig. 1b). barcode-tagged datasets (Extended Data Fig. 4).

Nature Methods | Volume 22 | February 2025 | 358–370 359

Article https://doi.org/10.1038/s41592-024-02555-5

 a

 Downstream multiplexing Mosaic organoids

 PSC

 Organoid generation
 (differentiation days 50, 100, 250/300)

 Single-cell
 dissociation

 Library preparation
 + sequencing
 (20,000 targeted cells per sample)

 Demultiplexing

 b
 Early Downstream multiplexing Mosaic organoids Genetic demultiplexing
 (day 50)
 CTL01 CTL01
 CTL08A
 CTL08A
 CTL02A
 CTL02A
 CTL04E

 Mid
 (day 100) CTL01 CTL01
 CTL08A CTL08A CTL08A
 CTL02A CTL02A CTL02A
 CTL04E CTL09A CTL04E

 Late
 CTL01
 (day 250/300) CTL08A
 CTL08A
 CTL02A
 CTL02A
 CTL04E

design. a, Representation of the two explored multiplexing paradigms. Left, stem cells. b, Representation of experimental design and the demultiplexing
downstream multiplexed organoids grown from individual lines and pooled approach. The CBO differentiation time points, the number of replicates for each
in equal amounts after dissociation at the single-cell level. Right, mosaic time point and their division between the two multiplexing paradigms and the
organoids generated by pooling equal amounts of multiple PSC lines during PSC lines (genotypes) used for each experiment are shown. Figure created with
organoid seeding. After single-cell dissociation, both paradigms undergo BioRender.com.

Analysis of neurodevelopmental cell types benchmarking15 and in line with evidence from recent studies character-
After deconvolving the identity of each droplet in our dataset by izing brain organoids at single-cell resolution46–48, CBOs recapitulated
the consensus call, we discarded doublets and low-quality cells and most of the relevant neurodevelopmental cell populations of human
proceeded with cells coming from the PSC lines across multiplexing corticogenesis. We observed a well-defined group of cells expressing
modalities (Extended Data Fig. 2 and Supplementary Table 1). We thus the proliferative markers CDC20, MKI67 and TOP2A that were labeled
analyzed the single-cell transcriptomic dataset entailing four PSC lines, as proliferating progenitor cells. Those cells are in continuity with a
their time points and two multiplexing modalities (Fig. 1b). We pre- bigger cluster of cells expressing PAX6, VIM, SOX2 and NES and annoprocessed each sample individually, integrated them and carried out tated as radial glia. This cluster undergoes a bifurcation, extending
multi-tier filtering. A force-directed graph was used to visualize the either toward cells expressing outer radial glial and/or astrocyte markintegrated dataset (Fig. 4a). ers HOPX, AQP4 and S100B or the neuronal markers STMN2, DCX and
 We systematically annotated the identity of each cell population GAP43, which we annotated accordingly. We then further divided the
by analyzing the expression distribution of relevant markers, defining neuronal branch into intermediate progenitors expressing EOMES,
the gene signatures driving each cluster and projecting the cells onto a two clusters of excitatory neurons expressing NEUROD2, TBR1, SATB2,
reference single-cell human fetal brain dataset (Fig. 4a, Extended Data SLC17A6, SLC17A7, SLA and GRIA2, two interneurons clusters express-

Nature Methods | Volume 22 | February 2025 | 358–370 360

Article https://doi.org/10.1038/s41592-024-02555-5

 a
 Nestin HOPX CTIP2 DAPI Composite

 50 µm 50 µm 50 µm 50 µm 50 µm

 PAX6 Reelin DAPI Composite

 50 µm 50 µm 50 µm 50 µm

 b SATB2 Reelin DAPI Composite

 50 µm 50 µm 50 µm 50 µm

 TUJ1 HOPX SOX2 DAPI Composite

 50 µm 50 µm 50 µm 50 µm 50 µm

 c Replicate 1 d Replicate 2

 1.00 1.00
 cycling cells

 cycling cells

 0.75 0.75
 Fraction of

 Fraction of

 0.50 0.50

 0.25 0.25

 0 0

 –2 0 5 12 25 –2 0 5 12 25 50
 Time (differentiation day) Time (differentiation day)
 CTL01 CTL02A CTL04E CTL08A Mosaic

benchmarking of neurodevelopmental markers in mCBOs. At differentiation radial glial cells, SATB homeobox 2 (SATB2)+ intermediate layer neurons and
day 50 (a), mCBOs show consistent presence of ventricular-like structures SRY-box transcription factor 2 (SOX2)+ neural precursors. DAPI, 4,6-diamidinopositive for the neural stem cell marker nestin and are surrounded by a layer of 2-phenylindole; PAX6, paired box 6. c,d, Fraction of cycling cells in pure lines
cells expressing the outer radial glial marker HOPX. The presence of newborn and mosaic organoids detected by flow cytometry (Methods) performed on two
deep-layer, Coup-TFI interacting protein 2 (CTIP2)+ (BCL11B) cortical neurons differentiation replicates at relevant time points, from day −2 (organoid seeding)
can be appreciated next to HOPX+ cells. On the outer surface, mCBOs reveal the up to days 25 (c) and 50 (d).
presence of reelin+ cells. At differentiation day 100 (b), mCBOs display more

neurons expressing FOXP1, CA8 and LHX1 and one cluster expressing neurons were evenly distributed across time points, we observed that
RELN, PAX6 and CBLN1, annotated as Cajal–Retzius-like cells (Fig. 4a,b migrating neurons, early excitatory neurons and Cajal–Retzius-like
and Extended Data Fig. 5b). cells were more abundant at the early and middle time points, whereas
 We then compared the different time points of our longitudinal outer radial glia and/or astrocytes, late excitatory neurons and
dataset, observing, as expected, differences in cell type abundance. interneurons were more abundant at the late time point (Extended
While radial glial progenitors, proliferating progenitors and maturing Data Fig. 5d). Instead, cell type proportions between mosaic organoids

Nature Methods | Volume 22 | February 2025 | 358–370 361

Article https://doi.org/10.1038/s41592-024-02555-5

and downstream multiplexed samples were comparable (Extended Linking genetic variation to neurodevelopmental phenotypes
Data Fig. 5d). We thus tested for statistical significance in differential Genome-wide association studies have uncovered hundreds of thouabundance, leveraging Milo45, confirming significant differences across sands of genetic variants associated with human traits48. Mechanistime points (Fig. 4c,d). Conversely, the same analysis done comparing tically linking such variants to phenotypes of interest by molecular
mosaic and downstream multiplexed samples showed no significant quantitative trait locus mapping has been instrumental to underdifference between the two multiplexing paradigms. stand functional effects of genetic variation58. In particular, single-cell
 To further investigate the molecular impact of mosaic culture, we expression quantitative trait locus (eQTL) modeling allows identificacompared the transcriptomes of the same genotypes between mosaic tion of the impact of single-nucleotide polymorphisms (SNPs) on cell
and downstream multiplexing and, as a reference for technical vari- type-specific molecular mechanisms, as we pioneered in ref. 59, pushability, we compared the same genotypes when grown in two different ing forward previous work by the GTEx Consortium to characterize
mosaic batches (Methods). variation in gene expression across individuals and diverse tissues of
 The analysis highlighted a low number of differentially expressed the human body60. Moreover, because single-cell analysis can quantify
genes (DEGs) for both comparisons (69 DEGs between multiplexing longitudinal trajectories, it is possible to assess the effects of SNPs on
modalities and four DEGs between two mosaic batches, false discovery traits that vary dynamically along a continuous axis20,49. The power of
rate (FDR) < 0.05, log (fold change (FC)) > 1.5) (Supplementary Fig. 1a these approaches however has yet to be exploited for developmental
and Supplementary Data 3). variation as a trait per se that is now amenable to longitudinal quanti-
 Finally, to further probe the transcriptional regulation of specific tation in the form of single-cell resolved trajectories. We thus set out
cell types in the CBOs vis-à-vis the in vivo counterparts, we took advan- to leverage our in vitro cohort and probe as proof of principle how
tage of our multigenotype dataset to detect loci with allelic-specific genetic variants could be linked to the neurodevelopmental traits
expression (ASE)46, as the likelihood of observing heterozygous loci is quantified in CBOs. First, we empirically tested in our dataset the
higher. As expected, the number of detected loci with ASE correlated statistical power to perform single-cell eQTL analysis through our
with the total amount of reads (Extended Data Fig. 5e). Moreover, previously developed tool, scPower50, and identified the number of
exploring the correlation of the proportion of reads in each allele across lines needed to perform single-cell de novo eQTL discovery, given the
cell types, we observed that, also in CBOs, the patterns of ASE are cell CBO-specific variability we had determined in terms of gene exprestype specific, in line with external evidence from the human brain47 sion across neurodevelopmental cell types (Extended Data Fig. 6c).
(Extended Data Fig. 5f). Because, as expected with our dataset, we do not have the statistical
 power for de novo eQTL discovery, we followed a supervised approach
Multiplexed CBOs capture key neurodevelopmental to investigate the genetic basis of the differences we observed in
trajectories neurodevelopmental trajectories between individuals during CBO
One of the most powerful innovations enabled by single-cell analysis differentiation.
of experimental models featuring extensive cellular heterogeneity, In particular, we focused on the trajectory of migrating neurons
such as CBOs, is the possibility to analyze developmental trajecto- because it displayed the greater and most reproducible genotype
ries through pseudotime analysis49,50. To deeply explore this aspect in diversity in the distribution of cells along pseudotime (computed by
our dataset, we leveraged partition-based graph abstraction (PAGA; dpt; Fig. 5c and Extended Data Fig. 6d). Indeed, along this trajectory,
recapitulated in CBOs (progenitors → excitatory neurons, progeni- each time point (50 random sampling iterations), we found differtors → interneurons, progenitors → astrocytes, progenitors → Cajal– ences between two subgroups (of two individuals each) (Fig. 5c).
Retzius-like cells, progenitors → migrating neurons). We could thus This was also confirmed by PCA performed on the downsampled
analyze through diffusion pseudotime (dpt)52 how the single cells from dataset, where we observed the same genotypes’ separation along
the different time points and multiplexing modalities were distributed PC1 (Extended Data Fig. 7), which represents an alternative proxy
along those neurodevelopmental trajectories (Fig. 5a,b). Moreover, of the differentiation trajectory of migrating neurons (Fig. 5b). We
we harnessed the power of trajectory-based differential expression thus explored in more depth the genetic variants that distinguish
based on generalized additive models (tradeSeq53) and identified the the two subgroups. Of the total of 24,987 coding variants passing
key genes driving each lineage of differentiation (Extended Data Fig. 6b the quality filters, 1,035 presented a different allelic configuration
and Supplementary Data 4). Of note, for the excitatory lineage, trajec- between the two groups, and we found that 11 of these genetic varitory analysis allowed us to identify two temporally divergent paths ants (Fig. 5d and Supplementary Data 5) have been previously idenof neurogenesis that reconciled toward the end into the excitatory tified as single-cell eQTLs in population-scale scRNA-seq profiling
neuron clusters, where EOMES was one of the key drivers of the dif- of induced PSC (iPSC)-derived neurons (Table 7 from Jerber et al.35,
ference (Fig. 5a). This is in line with the recent empirical demonstra- total reported eVariants from the study, 10,972). Two of these varition of the ability of CBOs to recapitulate in a physiologically relevant ants are cis-acting eQTLs for SRCIN1, one of the trajectory-specific
way the two different patterns (direct and indirect) of human cortical highly variable genes (HVGs) we had identified (Fig. 5e) that encodes
neurogenesis54–57. a protein previously shown to be a regulator of disease-relevant

of SCanSNP: (1) best ID assignment, (2) doublet classification and (3) low- truth in an in silico multiplexed dataset. x axis reports different algorithms; y axis
quality droplet detection. Colors represent different individuals and droplet reports the deconvolution accuracy as the rate of barcodes with predicted IDs
identity after best ID assignment; grayscale intensity in matrices represents that match ground truth versus total detected barcodes per dataset. Balanced
the number of reads; cross-patterned cells represent droplets not included in datasets are colored light green; imbalanced datasets are colored orange. Plot is
the computations; colored curves represent fitted distributions. b, Schematic bound between 0.86 and 0.98 to magnify the differences among and within tools
representation of the consensus call. Top, an example of consensus score and jittered on the y axis for readability. e, Distribution of predicted singlets and
with weights for each algorithm. Weights are the partial score attributed from doublets from the different algorithms for each of the seven datasets. Algorithms
different algorithms toward a specific genotype. Bottom, final aggregation are shown on the x axis, and mean log counts are shown on the y axis. The shape of
rationale. DBL, doublets; LQ, low quality; SoC, souporcell. c, Percentage of each symbol corresponds to a dataset. Markers are colored by singlet or doublet
doublets detected from each algorithm across datasets. x axis, datasets ordered predicted labels.
by the number of retrieved cells; y axis, doublet rate. Lines are colored by

Nature Methods | Volume 22 | February 2025 | 358–370 362

Article https://doi.org/10.1038/s41592-024-02555-5

alterations in cell migration and hence potentially representing the Scalability of multiplexed CBOs
genetic underpinning of the neurodevelopmental difference in the Having shown that multiplexed CBOs enable the parallel assessment of
migrating neuron trajectory observed here between the CBOs from neurodevelopmental trajectories from different lines, we next sought
different individuals. to determine the scalability of the system, given the variable balance

a (1) Best ID detection (2) Doublet detection (3) Low-quality droplet detection
 Fitting negative droplet distribution
 First ID Second ID

 A B C

 Singlets

 log (best ID counts/second-best ID counts)

 Low quality Good quality

 Genotype signature Gaussian mixture model
 Genotype-specific
 A B C threshold
 Droplet

 A B C First ID Second ID
 First ID Double-positive droplets Low cross-genotype difference

 Doublet Low quality

 Contribution matrix
 (genotype counts/droplet)

b Demuxlet SCanSNP Vireo SoC Consensus score
 Demuxlet = 1.5
 SCanSNP = 1.5
Weights: Droplet 1j 1.5 1.5 0 1 4 Droplet score for jth genotype
 Vireo = 1 (pass if consensus score ≥ 3)
 Souporcell = 1 Droplet nj 0 0 1 1 2

 Low quality if Genetic doublet if Transcriptomic doublet if Leftover low quality:
 Failed consensus and SCanSNP == LQ SCanSNP == DBL and at least 1 more algorithm == DBL ScDblFinder == DBL Failed consensus and not
 or or and belonging to previous
 Failed consensus and dropkick == LQ All algorithms but SCanSNP == DBL The droplet was not already categories
 marked as LQ/genetic DBL.

 1 2 3 4

 Consensus call

c d e 10.5
 0.7 Consensus Balanced Doublet
 Expected 0.96 Imbalanced 10.0 Singlet
 0.6 Demuxlet
 Shape = dataset
 Correct assignment rate

 SCanSNP 9.5
 0.5 Souporcell 0.94
 Mean log counts

 Vireo
 Doublet rate

 9.0
 0.4
 0.92
 0.3 8.5

 0.2 0.90 8.0

 0.1 7.5
 0.88
 0
 7.0
 Vireo
 Demuxlet

 SCanSNP
 Mosaic D50

 Souporcell
 Mosaic D300
 Mosaic D100(1)

 Mosaic D100(2)

 Downstream D50
 Downstream D250

 Downstream D100

 Vireo
 Demuxlet

 SCanSNP

 Consensus
 Souporcell

 Dataset Algorithm Algorithm

Nature Methods | Volume 22 | February 2025 | 358–370 363

Article https://doi.org/10.1038/s41592-024-02555-5

 Expression
a b Fraction of cells
 in group (%) in group (scaled)

 0 0.5 1.0
 20 40 60 80 100

 Proliferating progenitors
 Radial glial progenitors
 Outer radial glial astrocytes
 Cajal–Retzius like
 Intermediate progenitors
 Neurons
 Migrating neurons
 Glutamatergic neurons, early
 Glutamatergic neurons, late
 Interneurons, GAD2
 Interneurons

 CDC20
 MKI67
 TOP2A
 VIM
 SOX2
 NES
 AQP4
 S100B
 HOPX
 CBLN1
 RELN
 PAX6
 EOMES
 TAGLN3
 FOXP1
 CA8
 LHX1
 SLC17A6
 NOVA1
 SATB2
 SLC17A7
 GRIA2
 DCX
 BCL11B
 TUBB3
 MAP2
 NEUROD1
 GAD2
 DLX5
 DLX6-AS1
c d

 log (FC) log (FC) log (FC) log (FC)
 (significant neighborhoods only) (significant neighborhoods only) (significant neighborhoods only) (significant neighborhoods only)
 Early depleted Early enriched Mid depleted Mid enriched Late depleted Late enriched Mosaic depleted Mosaic enriched
 −4 0 4 −5 0 5 −5 0 5

neurodevelopmental cell populations. a, Cell embeddings in a force-directed of similar cells; color code indicates enrichment for the indicated categories
graph after preprocessing and filtering. Each dot is a cell, colored by annotated (only shown for significantly enriched neighborhoods, spatial FDR < 0.1).
cell type. b, Dot plot of gene expression for some of the relevant markers used in d, Differential abundance graph of CBO data across multiplexing modalities. The
the annotation. Size of dots is proportional to the number of cells expressing a basis for the visualization is the force-directed graph. Dots represent groups of
marker, and color encodes the mean expression in the group (scaled log-normal similar cells; color code indicates enrichment for the indicated categories (only
counts). c, Differential abundance graph of CBO data across time points. shown for significantly enriched neighborhoods, spatial FDR < 0.1).

among lines during mosaic organoid differentiation (Extended Data over the mCBO differentiation course. This showed that, starting from
brain organoid development51,52 in line with the physiological clonality already altered at early stages of differentiation, resulting, for some
of human brain development42. We thus increased the number of PSC of the lines, in very low numbers of cells at later time points (Fig. 6a
lines and multiplexing combinations as well as replicates across differ- and Supplementary Data 6). We thus asked whether these imbalance
ent organoids of the same combinations to quantitatively measure the patterns could be predicted by individual lines’ growth rates. As shown
variance in balance between different PSC lines in mosaic organoids in Fig. 6a and Supplementary Data 6, for the contribution of each PSC
and derive empirically grounded guidelines for scaling up disease line in mosaics, we found both that it was reproducible across replicates
modeling with this approach. of the same mix and that it reflected line-specific behaviors across dif-
 To that end, we undertook an in-depth profiling of the growth rate ferent mixes (Fig. 6a), yet such regularity was not explained either by
of 12 different PSC lines by systematic and longitudinal imaging over dif- PSC or CBO growth rates (Supplementary Data 6 and Extended Data
ferent passages during pluripotency maintenance and at multiple time Fig. 10a). This excludes that a rapid assessment of PSC line growth rates,
points during CBO differentiation. By performing semi-automated image either in pluripotency or upon differentiation, could be harnessed to
preprocessing and segmentation53, we modeled the growth dynamics of preselect optimal mixes (that is, those most likely to preserve balance)
each PSC line (both in pluripotency and upon CBO differentiation) and for a high-scalability setting.
of seven different mosaic combinations (Extended Data Figs. 8 and 9). We thus probed an alternative solution to the scalability problem,
 In parallel, each mosaic combination was profiled by Census-seq36,37 integrating the longitudinal Census-seq with mCBO imaging data
at five different time points in triplicate to measure the PSC line balance to model mCBO clonal dynamics and thereby determine the upper

Nature Methods | Volume 22 | February 2025 | 358–370 364

Article https://doi.org/10.1038/s41592-024-02555-5

 a Excitatory N. early b
 Early Mid Late Mosaic Downstream
 Migrating neurons
 7 6
 Excitatory N. late 6
 5
 5
 4
 4
 3
 3
 2 2
 1 1
 0 0
 0 0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1.0

 Outer radial glia/astrocytes
 FDG2

 4
 4

 FDG1 3 3

 2 2

 1 1

 0 0

 Cell density
 0 0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1.0

 Interneurons
 7
 6 6
 DC2

 5 5
 4 4
 DC1 3 3
 2 2
 1 1
 3.69 0 0
 EOMES
 0 0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1.0
 log expression smoothed

 Excitatory N. early
 Excitatory N. late
 2.77
 Cajal–Retzius like
 8 6
 1.84
 5
 6
 4
 0.92 4 3
 2
 2
 0 1
 0 0
 0.06 0.29 0.51 0.74 0.9
 0 0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1.0
 dpt pseudotime dpt pseudotime

 c d eGene e
 2B

 KS
 4

 6
 R2
 1

 S3

 TL

 H
 IN

 C

 2
 X4

 1
 EL

 PC1
 IH

 RO
 TL
 AR
 RP

 ET
 C

 SF

 TM

 KD

 AR
 SR

 FS
 M

 M

 M

 M
 N

 3.0
 PC2

 0/0
 2.5
 Genotype
 Cell density

 2.0
 0/1
 1.5

 1.0
 1/1
 0.5
 32
 5

 3

 69

 07
 6
 51

 7

 3
 81

 52

 0
 06
 38 ,98

 46 99

 73

 18
 ,8

 1,4
 ,4

 ,7
 1,9

 ,3

 0,
 2,
 2,

 6,
 55

 2
 69
 32

 5
 8

 0 0.2 0.4 0.6 0.8 1.0
 86
 50

 58
 6
 3

 01

 39
 7,9
 ,7

 1,7

 ,4
 ,5

 ,5

 0.10
 3,

 9,

 3,
 8,

 0,
 :6
 38

 0:
 6:

 :4
 :11

 :14
 :12

 dpt pseudotime
 :12

 TOP2A
 r7

 Loading
 7:

 r1

 r2

 0.05
 7:

 7:

 r3
 r6
 r1

 ch

 r7

 r8
 ch
 r1

 r1

 r3
 ch

 ch
 ch

 ch
 ch
 ch

 ch

 ch

 0
 ch

 CTL02A CTL08A eVariant –0.05 SRCIN1 LHX1
 CTL01 CTL04E CTL08A CTL04E –0.10
 Shared allele
 CTL02A CTL01
 0

 0

 0

 0

 0

 50

 00

 50
 25

 75
 50

 0
 1,2

 1,7
 1,5
 1,0

 Loading rank

a, Highlight of late and early excitatory neurons (N.) branches. Top, embeddings iterations; solid lines display the mean value among dataset replicates.
in a force-directed graph (FDG1 and FDG2 dimensions). Middle, a magnification d, Schematics of SNPs classified as eQTLs from Jerber et al.35 and their allelic
of isolated branches on the diffusion map (DC1 and DC2 components). configuration (reference (Ref)/Ref, Ref/alternate (Alt), Alt/Alt) for the pairs of
Bottom, smoothed expression of EOMES for each of the two trajectories along genotypes exhibiting difference in pseudotime. chr, chromosome. e, Principalpseudotime. b, Highlight of main developmental lineages in a force-directed component analysis (PCA) (Harmony integrated) of the isolated migrating
graph. Next to each force-directed graph, density plots display the number of neurons branch. Bottom, migrating neurons-specific HVGs. Genes are ordered
cells along pseudotime by (1) differentiation time points and (2) multiplexing by their principal component (PC)1 loading, with TOP2A (cycling progenitors
paradigm. Faded color shows 1 s.d. among dataset replicates; solid line marker), LHX1 (migrating neurons marker) and SRCIN1 (only eGene from d also
displays the mean value among dataset replicates. c, Density plot of cells along present in HVGs) highlighted.
pseudotime for the isolated migrating neurons lineage. Cells are divided and

Nature Methods | Volume 22 | February 2025 | 358–370 365

Article https://doi.org/10.1038/s41592-024-02555-5

feasibility limit of the mosaic models as a function of their sensitivity benchmarking the ability of CBOs to recapitulate also the specific
in exposing single-cell endophenotypes. Specifically, we derived the molecular and cellular features of human Cajal–Retzius neurons in vivo.
‘mosaic growth rate’ of each PSC line by combining mosaic organoid This design also allowed us to identify the developmental divergrowth rate as measured by imaging and the percentage of specific PSC gence of direct and indirect neurogenesis, highlighting EOMES as the
lines as measured by Census-seq (Fig. 6b and Extended Data Fig. 10b). key driver guiding the different paths of early-versus-late glutamatergic
We then computed the empirical probability distribution of the derived neuron differentiation in organoids. This confirmed the ability of CBOs
number of cells coming from each PSC line in mCBOs and used it as to recapitulate the physiological processes of a unique aspect of human
the basis for a Monte Carlo simulation with two initial parameters: (1) neocortical development56,57, in line with recent work that investigated
the starting number of PSC lines used to generate mCBOs and (2) the these biological processes in early fetal tissue and cerebral organoids
minimum number of cells per line required for single-cell analysis of through imaging61.
the main cell types. We found that the number of effectively recovered Finally, we observed in our late-stage CBOs also the differentialines (that is, lines detected at levels that enable single-cell analysis of tion of GABAergic neurons62, a finding that, given the dorsal forebrain
the main neurodevelopmental cell types) increased with the number of patterning, is in line with recent evidence that human dorsal cortical
lines that were mixed (despite the reduction in relative representation) progenitors are also capable of producing GABAergic neurons with the
(Fig. 6c and Extended Data Fig. 10c). transcriptional characteristics of cortical interneurons63,64.
 Given similar clonal dynamics across mCBOs generated by dif- Through the analysis of developmental trajectories, we also
ferent numbers of PSC lines as well as by different combinations of showed that brain organoid multiplexing can be used to identify how
PSC lines, the scalability of the system is currently limited only by candidate genetic variants are linked to specific neurodevelopmental
the number of lines that can be accurately counted and multiplexed phenotypes, captured here as proof of principle in the transcriptional
when generating mCBOs. We could thus compute the impact of regulation of migrating neurons. This paves the way to molecular
the different multiplexing approaches (Fig. 6d and Extended Data quantitative trait locus discovery once multiplexing approaches will
disease-modeling studies. mCBOs emerged from this analysis as an lines. Indeed, we showed that the number of lines needed for de novo
enabling method due to the radical acceleration afforded by paral- discovery of eQTLs linked to neurodevelopmental trajectories in brain
lel processing of different rounds of differentiation experiments, organoids (which we propose to term eDTL, for expressed developfor example, compressing the profiling of 1,000 lines down from 10 mental trait loci) should be in the range of hundreds of individuals.
to 3 years and hence marking the difference, in the current funding Both molecular and imaging analyses showed that mCBOs recaand project management ecosystem of most academic institutions, pitulate the expected cytoarchitectural organization, including
between a largely unrealistic setting and a routinely feasible design. ventricular-like structures and the gradual emergence of relevant
 neurodevelopmental markers of standard CBOs. As expected, they
Discussion showed a variable degree of balance among individual PSC lines.
In this work, we developed multiplexing strategies to tackle the chal- Differently from another multiplexing approach that was recently
lenges of brain organoid modeling for the systematic study of human proposed, which requires however dissociation and re-aggregation
neurodiversity at scale. Pooling strategies already proved transform- of the organoids to keep the balance among individual lines52, here
ing for iPSC-based disease modeling34–38; however, their application we aimed to keep the mosaic model unperturbed and thus allow it to
to the inherently complex setting of brain organoids, which generate recapitulate the physiological phenomenon of clonal asymmetry51,65,66,
a highly heterogeneous composition of cell types over very extended proceeding to an in-depth investigation of these dynamics across diftimes, has just started to be undertaken51,52. Here, we first benchmarked ferent numbers of PSC lines, multiplexing combinations and replicates.
and improved the demultiplexing steps by leveraging and aggregating Interestingly, our longitudinal imaging profiling, characterizing
the edges of different publicly available state-of-the-art algorithms with quantitative parameters each PSC line upon passaging in pluripoand developing SCanSNP, a new deconvolution method that more tency and through CBO differentiation, did not explain the contribuaccurately identifies doublets and low-quality cells and flexibly accom- tion of each line in the mosaic models. However, we cannot exclude that
modates cases of imbalanced genotypes. a growth rate characterization with even additional time points and/or
 Next, we deeply characterized the neurodevelopmental cell replicates or at even higher resolution could lead to identification of a
types and trajectories recapitulated by CBOs across time points relationship between cell cycle and cell fate, as has been described in
and multiplexing modalities. Of note, the unicity of our longitudi- a different in vitro model67.
nal design allowed us to capture a very interesting and relevant neu- In terms of clonal dynamics and scalability, while we cannot genrodevelopmental process represented by the transient emergence of eralize our results for every PSC line, our results showed that:
Cajal–Retzius-like cells, a population that was also recapitulated in a
different brain organoid model but so far not reported in CBOs54. In 1. As expected from recent studies51,52, the line balance in mCBOs
our dataset, Cajal–Retzius-like neurons are enriched at middle stages is altered already at early stages of differentiation. This result,
and then depleted at advanced stages in both downstream CBOs and coupled with the lack of correlation with PSC and CBO growth
mCBOs, consistent with in vivo evidence that they are fated to elimi- rates, suggests that interindividual differences across PSC lines
nation as neuronal networks mature55. Future studies will thus enable in response to the patterning factors used in CBO differentiation

mosaic organoids of different composition (MIX IDs, Source Data Fig. 6), boxes) and minimum and maximum values (extension of the whiskers) among
as quantified by Census-seq. Each dot represents the average value of mixtures per line. c, Fitted power function of cell line recovery (Monte Carlo
representation for a single line at that time point across three different replicates, simulation, Extended Data Fig. 10c). The plot shows the number of mixed lines
except day −2, when only one replicate was available. Shading around the line (x axis) and the number of recovered cell lines (y axis). d, Projection of the
represents the 95% confidence interval around the mean, as depicted by the solid number of profilable lines over time across multiplexing approaches. The plot
line connecting the dots. b, Growth rate of different cell lines for different mosaic shows the number of profiled cell lines (y axis) and the experimental time in days
mixtures in the interval of day 0 to day 4. Different cell lines are divided along (x axis). Vertical dashed lines represent the experimental time to reach 100 and
the x axis; each dot in a box represents the growth rate of the same cell line in a 1,000 profiled cell lines in the left plot and the right plot, respectively. For the left
different experimental mixture. Displayed by each box is the median (horizontal plot, the approximation strict line is displayed for each protocol.

Nature Methods | Volume 22 | February 2025 | 358–370 366

Article https://doi.org/10.1038/s41592-024-02555-5

 a MIX ID:1 MIX ID:2 MIX ID:3
 1.0
 0.7 0.8
 0.6 0.8
 0.5 0.6
 0.6
 0.4
 0.4
 0.3 0.4
 0.2 0.2
 0.2
 0.1
 0 0 0
 –2 5 12 25 50 –2 5 12 25 50 –2 5 12 25 50
 Time point (d) Time point (d) Time point (d)
 Fraction of lines represented

 MIX ID:4 MIX ID:5 MIX ID:6
 1.0
 0.8 0.6
 0.8
 0.5
 0.6
 0.6 0.4
 0.4 0.3
 0.4
 0.2
 0.2 0.2
 0.1
 0 0 0
 –2 5 12 25 50 –2 5 12 25 50 –2 5 12 25 50
 Time point (d) Time point (d) Time point (d)

 MIX ID:7
 1.0
 PSC line
 0.8 UCSFi001-A CTL07C
 CTL01 CTL08A
 0.6
 CTL02A CTL09A
 0.4 CTL04E H1
 CTL05A H9
 0.2 CTL06F KTD8_2

 0
 –2 5 12 25 50
 Time point (d)
 b Growth rate stability (days 0–4) c Fitted power function of recovered PSC lines
 16
 Number of recovered PSC lines

 4 14
 Growth rate (days 0–4)

 12
 3
 10

 2 8

 6
 1
 4

 0 2

 0
 0 2 5 10 20
 -A
 A

 A

 A

 A
 C

 E

 F
 _2
 01

 9
 1
 H

 06
 04
 02

 05

 08

 09

 H
 07

 01
 D8
 TL

 Number of mixed PSC lines
 TL

 TL
 TL
 TL

 TL

 TL

 TL
 i0
 C

 KT

 C

 C

 SF
 C
 C

 C

 C

 C
 UC

 PSC line

 d Number of profiled cell lines per protocol over time
 200 Mosaic 1,400
 Downstream
 175
 1,200
 1,000 profiled
 Number of profiled PSC lines

 150 PSC lines
 1,000

 125
 100 profiled 800
 PSC lines
 100

 600
 75

 400
 50

 25 200

 0 168 325 41 108
 0
 0 30 60 90 120 150 180 210 240 270 300 330 0 24 48 72 96 120
 Experimental time (d) Experimental time (months)

Nature Methods | Volume 22 | February 2025 | 358–370 367

Article https://doi.org/10.1038/s41592-024-02555-5

 protocols (as also shown in ref. 68) may be a key determinant for gene–environment interaction studies72. Indeed, if it is not cru-
 the clonal asymmetry. However, with our data, we cannot ex- cial to recover all starting PSC lines, mCBOs allow studying the
 clude that the imbalance already originates during the first 2 d impact of genetic makeup, environmental chemicals11 or drugs
 of the protocol, during which embryoid bodies are generated, a on the gene expression of specific neurodevelopmental cell types
 phenomenon that was also shown to be relevant in ref. 51 where for very large cohorts of PSC lines, even without automated set-
 the authors showed that clones were lost during the formation ups, as the only bottleneck is the maintenance of the lines and the
 of embryoid bodies using a cerebral organoid protocol. generation of the organoids, thereby massively increasing the
 2. Mosaic models showed reproducibility in the relative abundance feasibility of large-scale experiments. For example, by leverag-
 among different individual lines across replicates of the same ing large cohorts of banked PSC lines (with already thousands of
 multiplexing combinations and across different combinations. lines available in standardized repositories (Table 2 from ref. 73))
 This points to the genetic background as a key determinant of and generating batches of mCBOs with 20 lines, the experimen-
 clonal dynamics. Naturally, this does not per se rule out that also tal timeline for profiling at day 50 would be, respectively, halved
 the epigenetic state of each line at the time of mCBO generation for 100 lines (about 6 months instead of more than 1 year needed
 may exert a substantial impact, in line with results from a large for a downstream multiplexing approach), more than three times
 collection of PSC lines69. Indeed, the lines that were overrepre- lower for 1,000 lines (about 3 years instead of about 10 years with
 sented in the experiments in Fig. 6 were not overrepresented in downstream) and substantially lower also than the recently in-
 previous single-cell transcriptomic experiments over different troduced alternative approach based on post-re-aggregation
 years and thus from different passages of the same iPSC lines. multiplexing52. This, in addition to the substantial reduction in
 3. The comparison between mosaic and downstream multiplex- the workload (see specific calculations in the Methods), repre-
 ing modalities showed that non-cell-autonomous effects are not sents a transformative leap for the transcriptomic annotation of
 evident in the mosaic model, as expected, considering that we polygenic risk scores along neurodevelopment and for precision
 only used wild-type PSC lines to generate the single-cell dataset neurotoxicology and pharmacology.
 and confirming independent works that found the same result in
 two-dimensional38 and three-dimensional52 cultures. However, To conclude, our findings indicate to opt for the downstream
 considering the few genes that emerged from the differential multiplexing strategy when the biological question at hand requires
 expression analysis between genotypes in the two multiplexing strict balance among individual lines, with the mosaic model ideally
 modalities, it is possible that, by increasing the number of cells suited instead, and in fact transformative, for unbiased large-scale
 and replicates and profiling mosaic models through spatial om- studies, in the same way as developmental neuroscientists can lever-
 ics, the molecular impact of cell-to-cell interactions between age pooled CRISPR perturbation strategies for screening the impact
 different lines could come into relief even within the range of of genetic variants as a complementary approach to the validation of
 genetically normotypical lines. Also, it will be relevant to investi- single mutations74–77.
 gate deeper non-cell-autonomous effects using PSC lines carry-
 ing disease-relevant genetic mutations, such as the ones that al- Online content
 ready showed evidence that non-cell-autonomous mechanisms Any methods, additional references, Nature Portfolio reporting sum-
 are relevant for the pathogenesis70,71. maries, source data, extended data, supplementary information,
 4. The variance in mCBO clonal dynamics across PSC lines was not acknowledgements, peer review information; details of author contri-
 dependent on the specific mosaic combinations (where differ- butions and competing interests; and statements of data and code avail-
 ent lines were used) nor on the number of lines at generation, in- ability are available at https://doi.org/10.1038/s41592-024-02555-5.
 dicating high scalability of the system. Additional experiments
 will clarify the impact of increasing to hundreds of lines in single References
 mCBOs on these clonal dynamics. However, considering the cur- 1. Silbereis, J. C., Pochareddy, S., Zhu, Y., Li, M. & Sestan, N. The
 rent limitations in laboratory settings for accurate cell counting, cellular and molecular landscapes of the developing human
 which is needed to generate balanced mCBOs (excluding flow central nervous system. Neuron 89, 248–268 (2016).
 cytometry setups for the logistics of generating mosaic mod- 2. Cheroni, C., Caporale, N. & Testa, G. Autism spectrum disorder at
 els with many lines), we do not suggest going lower than about the crossroad between genes and environment: contributions,
 1,000 cells per line during mCBO generation. Thus, our guide- convergences, and interactions in ASD developmental
 lines suggest using a maximum of about 20 lines in mosaic mod- pathophysiology. Mol. Autism 11, 69 (2020).
 els (because 20,000 cells are needed to generate a mCBO with 3. Tărlungeanu, D. C. & Novarino, G. Genomics in neurodevelop­
 our current protocol). mental disorders: an avenue to personalized medicine. Exp. Mol.
 5. Monte Carlo simulations incorporating the empirical growth Med. 50, 1–7 (2018).
 rates from our experiments allowed us to compute the probabil- 4. Hyman, S. E. The daunting polygenicity of mental illness: making
 ity of recovering, from each PSC line, a sufficient number of cells a new map. Philos. Trans. R. Soc. Lond. B Biol. Sci. 373, 20170031
 for single-cell omics analysis of neurodevelopmental cell types, (2018).
 given the number of lines used at the generation. This in turn 5. López-Tobón, A. et al. Human cortical organoids expose a
 enables a precise design of disease-modeling experiments with differential function of GSK3 on cortical neurogenesis. Stem Cell
 mosaic models. With our protocol, the number of PSC lines that Reports 13, 847–861 (2019).
 can be properly analyzed in terms of single-cell transcriptomic 6. López-Tobón, A. et al. GTF2I dosage regulates neuronal
 characterization of all major neurodevelopmental cell types differentiation and social behavior in 7q11.23 neurodevelopmental
 (considering proliferating progenitors, radial glial progenitors, disorders. Sci. Adv. 9, eadh2726 (2023).
 neurons, migrating neurons, excitatory neurons) from a mosaic 7. Mihailovich, M. et al. 7q11.23 CNV alters protein synthesis and
 experiment is ~12 lines (empirical mean ≈ 12.89; 95% confidence REST-mediated neuronal intrinsic excitability. Preprint at bioRxiv
 interval, 12.85 to 12.93) if starting from 20 lines and sequencing https://doi.org/10.1101/2022.10.10.511483 (2022).
 ~100,000 cells. This means that the ideal settings to apply mCBO 8. Marangon, D. et al. Novel in vitro experimental approaches to
 designs as a transformative tool are cohort-level screenings study myelination and remyelination in the central nervous
 for trait-relevant in vitro endophenotypes, drug screening and system. Front. Cell. Neurosci. 15, 748849 (2021).

Nature Methods | Volume 22 | February 2025 | 358–370 368

Article https://doi.org/10.1038/s41592-024-02555-5

9. Drakulic, D. et al. Copy number variants (CNVs): a powerful tool 33. Srivatsan, S. R. et al. Massively multiplex chemical transcri­
 for iPSC-based modelling of ASD. Mol. Autism 11, 42 (2020). ptomics at single-cell resolution. Science 367, 45–51
10. Villa, C. E. et al. CHD8 haploinsufficiency links autism to transient (2020).
 alterations in excitatory and inhibitory trajectories. Cell Rep. 39, 34. Cuomo, A. S. E. et al. Single-cell RNA-sequencing of
 110615 (2022). differentiating iPS cells reveals dynamic genetic effects on gene
11. Caporale, N. et al. From cohorts to molecules: adverse impacts of expression. Nat. Commun. 11, 810 (2020).
 endocrine disrupting mixtures. Science 375, eabe8244 (2022). 35. Jerber, J. et al. Population-scale single-cell RNA-seq profiling
12. Corsini, N. S. & Knoblich, J. A. Human organoids: new strategies across dopaminergic neuron differentiation. Nat. Genet. 53,
 and methods for analyzing human development and disease. Cell 304–312 (2021).
 185, 2756–2769 (2022). 36. Mitchell, J. M. et al. Mapping genetic effects on cellular
13. Kelley, K. W. & Pașca, S. P. Human brain organogenesis: toward phenotypes with ‘cell villages’. Preprint at bioRxiv https://doi.
 a cellular understanding of development and disease. Cell 185, org/10.1101/2020.06.29.174383 (2020).
 42–61 (2022). 37. Wells, M. F. et al. Natural variation in gene expression and viral
14. Eichmüller, O. L. & Knoblich, J. A. Human cerebral organoids — susceptibility revealed by neural progenitor cell villages. Cell
 a new tool for clinical neurology research. Nat. Rev. Neurol. 18, Stem Cell 30, 312–332 (2023).
 661–680 (2022). 38. Neavin, D. R. et al. A village in a dish model system for
15. Cheroni, C. et al. Benchmarking brain organoid recapitulation of population-scale hiPSC studies. Nat. Commun. 14, 3240 (2023).
 fetal corticogenesis. Transl. Psychiatry 12, 520 (2022). 39. Farbehi, N. et al. Integrating population genetics, stem cell
16. Koi, P. Genetics on the neurodiversity spectrum: genetic, biology and cellular genomics to study complex human diseases.
 phenotypic and endophenotypic continua in autism and ADHD. Nat. Genet. 56, 758–766 (2024).
 Stud. Hist. Philos. Sci. 89, 52–62 (2021). 40. Pașca, S. P. et al. A nomenclature consensus for nervous system
17. Baron-Cohen, S. Editorial Perspective: Neurodiversity — organoids and assembloids. Nature 609, 907–910 (2022).
 a revolutionary concept for autism and psychiatry. J. Child 41. Birey, F. et al. Assembly of functionally integrated human
 Psychol. Psychiatry 58, 744–747 (2017). forebrain spheroids. Nature 545, 54–59 (2017).
18. Pretzsch, C. M. et al. Neurobiological correlates of change in 42. Bizzotto, S. et al. Landmarks of human embryonic development
 adaptive behavior in autism. Am. J. Psychiatry 179, 336–349 (2022). inscribed in somatic mutations. Science 371, 1249–1253 (2021).
19. Rajewsky, N. et al. LifeTime and improving European healthcare 43. Germain, P.-L., Lun, A., Macnair, W. & Robinson, M. D. Doublet
 through cell-based interceptive medicine. Nature 587, 377–386 identification in single-cell sequencing data using scDblFinder.
 (2020). F1000Res. 10, 979 (2021).
20. Cuomo, A. S. E., Nathan, A., Raychaudhuri, S., MacArthur, D. G. & 44. Heiser, C. N., Wang, V. M., Chen, B., Hughey, J. J. & Lau, K. S.
 Powell, J. E. Single-cell genomics meets human genetics. Nat. Automated quality control and cell identification of droplet-based
 Rev. Genet. 24, 535–549 (2023). single-cell data using dropkick. Genome Res. 31, 1742–1752 (2021).
21. De Donno, C. et al. Population-level integration of single-cell 45. Dann, E., Henderson, N. C., Teichmann, S. A., Morgan, M. D. &
 datasets enables multi-scale analysis across samples. Nat. Marioni, J. C. Differential abundance testing on single-cell data
 Methods 20, 1683–1692 (2023). using k-nearest neighbor graphs. Nat. Biotechnol. 40, 245–253
22. Stoeckius, M. et al. Cell Hashing with barcoded antibodies (2022).
 enables multiplexing and doublet detection for single cell 46. Cleary, S. & Seoighe, C. Perspectives on allele-specific
 genomics. Genome Biol. 19, 224 (2018). expression. Annu. Rev. Biomed. Data Sci. 4, 101–122 (2021).
23. Stoeckius, M. et al. Simultaneous epitope and transcriptome 47. Zhao, D., Lin, M., Pedrosa, E., Lachman, H. M. & Zheng, D.
 measurement in single cells. Nat. Methods 14, 865–868 (2017). Characteristics of allelic gene expression in human brain cells
24. Gehring, J., Hwee Park, J., Chen, S., Thomson, M. & Pachter, L. from single-cell RNA-seq data analysis. BMC Genomics 18, 860
 Highly multiplexed single-cell RNA-seq by DNA oligonucleotide (2017).
 tagging of cellular proteins. Nat. Biotechnol. 38, 35–38 (2020). 48. Sollis, E. et al. The NHGRI-EBI GWAS Catalog: knowledgebase and
25. Hwang, B. et al. SCITO-seq: single-cell combinatorial indexed deposition resource. Nucleic Acids Res. 51, D977–D985
 cytometry sequencing. Nat. Methods 18, 903–911 (2021). (2023).
26. Datlinger, P. et al. Ultra-high-throughput single-cell RNA 49. Cuomo, A. S. E. et al. CellRegMap: a statistical framework for
 sequencing and perturbation screening with combinatorial fluidic mapping context-specific regulatory variants using scRNA-seq.
 indexing. Nat. Methods 18, 635–642 (2021). Mol. Syst. Biol. 18, e10663 (2022).
27. Kang, H. M. et al. Multiplexed droplet single-cell RNA-sequencing 50. Schmid, K. T. et al. scPower accelerates and optimizes the design
 using natural genetic variation. Nat. Biotechnol. 36, 89–94 (2018). of multi-sample single cell transcriptomic studies. Nat. Commun.
28. Heaton, H. et al. Souporcell: robust clustering of single-cell 12, 6625 (2021).
 RNA-seq data by genotype without reference genotypes. Nat. 51. Lindenhofer, D. et al. Cerebral organoids display dynamic clonal
 Methods 17, 615–620 (2020). growth and tunable tissue replenishment. Nat. Cell Biol. 26,
29. Huang, Y., McCarthy, D. J. & Stegle, O. Vireo: Bayesian 710–718 (2024).
 demultiplexing of pooled single-cell RNA-seq data without 52. Antón-Bolaños, N. et al. Brain chimeroids reveal individual
 genotype reference. Genome Biol. 20, 273 (2019). susceptibility to neurotoxic triggers. Nature 631, 142–149 (2024).
30. Weber, L. M. et al. Genetic demultiplexing of pooled single-cell 53. Uozumi, T. et al. Generation of a growth curve for iPS cells in
 RNA-sequencing samples in cancer facilitates effective a feeder-free culture by non-invasive image analysis. Nikon
 experimental design. Gigascience 10, giab062 (2021). Instruments www.microscope.healthcare.nikon.com/resources/
31. Yazar, S. et al. Single-cell eQTL mapping identifies cell application-notes/generation-of-a-growth-curve-for-i-ps-
 type-specific genetic control of autoimmune disease. Science cells-in-a-feeder-free-culture-by-non-invasive-image-analysis
 376, eabf3041 (2022). (2011).
32. Perez, R. K. et al. Single-cell RNA-seq reveals cell type-specific 54. Uzquiano, A. et al. Proper acquisition of cell class identity in
 molecular and genetic associations to lupus. Science 376, organoids allows definition of fate specification programs of the
 eabf1970 (2022). human cerebral cortex. Cell 185, 3770–3788 (2022).

Nature Methods | Volume 22 | February 2025 | 358–370 369

Article https://doi.org/10.1038/s41592-024-02555-5

55. Elorriaga, V., Pierani, A. & Causeret, F. Cajal–Retzius cells: recent 70. Baek, S. T. et al. An AKT3–FOXG1–reelin network underlies
 advances in identity and function. Curr. Opin. Neurobiol. 79, defective migration in human focal malformations of cortical
 102686 (2023). development. Nat. Med. 21, 1445–1454 (2015).
56. Pebworth, M.-P., Ross, J., Andrews, M., Bhaduri, A. & Kriegstein, A. R. 71. Nakagawa, N. et al. Memo1-mediated tiling of radial glial cells
 Human intermediate progenitor diversity during cortical facilitates cerebral cortical development. Neuron 103, 836–852
 development. Proc. Natl. Acad. Sci. USA 118, e2019415118 (2021). (2019).
57. Braun, E. et al. Comprehensive cell atlas of the first-trimester 72. Seah, C. et al. Modeling gene × environment interactions
 developing human brain. Science 382, eadf1226 (2023). in PTSD using human neurons reveals diagnosis-specific
58. Aguet, F. et al. Molecular quantitative trait loci. Nat. Rev. Methods glucocorticoid-induced gene expression. Nat. Neurosci. 25,
 Primers 3, 4 (2023). 1434–1445 (2022).
59. van der Wijst, M. et al. The single-cell eQTLGen consortium. eLife 73. Huang, C.-Y. et al. Human iPSC banking: barriers and
 9, e52155 (2020). opportunities. J. Biomed. Sci. 26, 87 (2019).
60. GTEx Consortium et al. Genetic effects on gene expression across 74. Fleck, J. S. et al. Inferring and perturbing cell fate regulomes in
 human tissues. Nature 550, 204–213 (2017). human brain organoids. Nature 621, 365–372 (2022).
61. Coquand, L. et al. A cell fate decision map reveals abundant 75. Esk, C. et al. A human tissue screen identifies a regulator of ER
 direct neurogenesis bypassing intermediate progenitors in the secretion as a brain-size determinant. Science 370, 935–941 (2020).
 human developing neocortex. Nat. Cell Biol. 26, 698–709 76. Meng, X. et al. Assembloid CRISPR screens reveal impact
 (2024). of disease genes in human neurodevelopment. Nature 622,
62. Sloan, S. A., Andersen, J., Pașca, A. M., Birey, F. & Pașca, S. P. 359–366 (2023).
 Generation and assembly of human brain region-specific 77. Li, C. et al. Single-cell brain organoid screening identifies
 three-dimensional cultures. Nat. Protoc. 13, 2062–2085 (2018). developmental defects in autism. Nature 621, 373–380 (2023).
63. Delgado, R. N. et al. Individual human cortical progenitors can
 produce excitatory and inhibitory neurons. Nature 601, 397–403 Publisher’s note Springer Nature remains neutral with regard to
 (2022). jurisdictional claims in published maps and institutional affiliations.
64. Andrews, M. G. et al. LIF signaling regulates outer radial glial to
 interneuron fate during human cortical development. Cell Stem Open Access This article is licensed under a Creative Commons
 Cell 30, 1382–1391 (2023). Attribution-NonCommercial-NoDerivatives 4.0 International License,
65. Breuss, M. W. et al. Somatic mosaicism reveals clonal distributions which permits any non-commercial use, sharing, distribution and
 of neocortical development. Nature 604, 689–696 (2022). reproduction in any medium or format, as long as you give appropriate
66. Huang, A. Y. et al. Parallel RNA and DNA analysis after deep credit to the original author(s) and the source, provide a link to the
 sequencing (PRDD-seq) reveals cell type-specific lineage patterns Creative Commons licence, and indicate if you modified the licensed
 in human brain. Proc. Natl Acad. Sci. USA 117, 13886–13895 material. You do not have permission under this licence to share
 (2020). adapted material derived from this article or parts of it. The images
67. Pauklin, S. & Vallier, L. The cell-cycle state of stem cells or other third party material in this article are included in the article’s
 determines cell fate propensity. Cell 155, 135–147 (2013). Creative Commons licence, unless indicated otherwise in a credit
68. Bertucci, T. et al. Improved protocol for reproducible human line to the material. If material is not included in the article’s Creative
 cortical organoids reveals early alterations in metabolism with Commons licence and your intended use is not permitted by statutory
 MAPT mutations. Preprint at bioRxiv https://doi.org/10.1101/ regulation or exceeds the permitted use, you will need to obtain
 2023.07.11.548571 (2023). permission directly from the copyright holder. To view a copy of this
69. Kim, S.-K. et al. Individual variation in the emergence of licence, visit http://creativecommons.org/licenses/by-nc-nd/4.0/.
 anterior-to-posterior neural fates from human pluripotent stem
 cells. Stem Cell Reports 19, 1336–1350 (2024). © The Author(s) 2024

Department of Oncology and Hemato-Oncology, University of Milan, Milan, Italy. 2Human Technopole, Milan, Italy. 3Institute of Computational Biology,
1

Helmholtz Zentrum München—German Research Center for Environmental Health, Neuherberg, Germany. 4Department of Mathematics, Technical
University Munich, Munich, Germany. 5Department of Experimental Oncology, European Institute of Oncology IRCCS, Milan, Italy. 6These authors
contributed equally: Nicolò Caporale, Davide Castaldi, Marco Tullio Rigoli. 7These authors jointly supervised this work: Nicolò Caporale, Carlo Emanuele
Villa, Giuseppe Testa. e-mail: giuseppe.testa@fht.org

Nature Methods | Volume 22 | February 2025 | 358–370 370

Article https://doi.org/10.1038/s41592-024-02555-5

Methods M7145), 0.1 mM cell culture-grade 2-mercaptoethanol solution (Gibco,
Culture of pluripotent stem cells 31350010), GlutaMAX (1:100, Gibco, 35050061), penicillin at 100 U ml−1
PSC lines were cultured under feeder-free conditions on Matrigel- and streptomycin at 100 μg ml−1 (Thermo Fisher, 15140122), 7 µM dorcoated plates at 37 °C with 5% CO2 and 3% O2. To coat culture dishes, somorphin (Sigma, P5499) and 10 µM TGF-β inhibitor SB431542 (Med-
Matrigel solution was prepared by diluting Matrigel (Corning, 354277) ChemExpress, HY-10431). Since that moment, defined as day 1, cultures
1:40 in ice-cold DMEM/F12 medium (Gibco, 11330057) and stored were grown in normal oxygen conditions (21% O2). Medium changes
at 4 °C until use. Before plating cells, 6-cm dishes were coated with were performed daily for the subsequent 4 d, and, on the fifth day,
1 ml Matrigel solution and incubated for 30 min at 37 °C. PSCs were neural induction medium was substituted with complete neurobasal
maintained in TeSR/E8 medium (Stemcell Technologies, 05990) sup- medium, composed of neurobasal medium (Gibco, 12348017), B-27
plemented with 100 U ml−1 penicillin and 100 µg ml−1 streptomycin supplement without vitamin A (1:50, Gibco, 12587001), GlutaMAX
(Thermo Fisher, 15140122) with daily medium changes and passaged (1:100, Gibco, 35050061), penicillin at 100 U ml−1 and streptomycin at
1:8 to 1:10 when confluency reached around 70%. To detach cells, plates 100 μg ml−1 (Thermo Fisher, 15140122) and 0.1 mM cell culture-grade
were rinsed with 2–3 ml PBS (Gibco, 10010023) and treated with 0.5 ml 2-mercaptoethanol solution (Gibco, 31350010) supplemented with
ReLeSR reagent (Stemcell Technologies, 05872) for 5 min at 37 °C. When 20 ng ml−1 FGF2 (PeproTech, 100-18B) and 20 ng ml−1 EGF (PeproTech,
single-cell dissociation was needed, Accutase (Sigma-Aldrich, A6964) AF-100-15). On day 12, organoids were transferred by pipetting with
was used instead of ReLeSR, and 5 µM ROCK inhibitor Y-27632 (Tocris, cut-end pipette tips from 96-well to 9-cm ultra-low-attachment dishes
1254) was added to the medium to enhance cell survival in the first 24 h. (System Biosciences, MS-90900Z) and placed on a standard orbital
All participants signed an informed consent form, and the use of PSCs shaker (VWR Standard Orbital Shaker, Model 1000). From day 12
was approved by the ethical committee of the University of Milan. All onward, medium changes were performed every other day. On day
iPSC lines were reprogrammed by at least 15 passages. All PSCs have 23, FGF and EGF were replaced with 20 ng ml−1 BDNF (PeproTech, 450been routinely verified to be Mycoplasma free by routine PCR testing, 02) and 20 ng ml−1 neurotrophin 3 (PeproTech, 450-03) to promote
and their identity was confirmed by short tandem repeat profiling. differentiation of neural progenitors. From day 42 onward, complete
Details about the PSC lines can be found in Supplementary Table 1. neurobasal medium without BDNF and NT3 was used, performing
 medium changes every other day.
Multiplexing strategies
In the experimental design, we adopted two distinct multiplexing strat- Cell cycle analysis
egies, namely, mosaic and downstream, that differed in the moment Pure line-derived organoids were subjected to cell cycle analysis at
at which the different cell lines were mixed. multiple time points after their generation along with cell suspensions
 In the former multiplexing approach, CBOs were generated by employed in their generation. Organoids were collected at differenmixing equal amounts of PSCs derived from each cell line to obtain tiation days 0, 5, 12, 25, 50 and 75, dissociated at 37 °C for 5 min with
mosaic brain organoids. Briefly, PSC lines were dissociated in parallel at trypsin-EDTA (Euroclone, ECB3042) (differentiation days 0, 5 and 12)
the single-cell level, and cells were counted separately and then mixed or for 30 min with papain (Stemcell Technologies, 07466) (differentiain equal proportions to obtain a mosaic cellular suspension. After dilut- tion days 25, 50 and 75); papain was more efficient for the dissociation
ing the cell suspension to the desired concentration of 2 × 105 cells per of mature organoids.
ml, organoids were generated as explained in the following chapter As for the first analytical replicate (Fig. 2c), cells were fixed with
entitled 'Cortical brain organoids'. cold ethanol and stored at +4 °C. Upon completing the longitudinal
 In the downstream approach, CBOs were independently generated cohort, cell suspensions were rinsed with PBS, stained overnight with
from each individual PSC line and grown separately. When reaching 3 µM propidium iodide solution (Thermo Fisher, P1304MP) in the
the desired analytical time point, organoids from each cell line were presence of 25 µg ml−1 RNase I (Thermo Fisher, EN0601) and analyzed
dissociated in parallel, and cells were counted and mixed in equal with a FACSCelesta instrument (BD Biosciences) to measure DNA conproportions to obtain a pooled cell suspension. tent. Analyses were performed with FlowJo version 10 software (BD
 For the comparison of neurodevelopmental cell types and trajec- Biosciences).
tories between mosaic and downstream multiplexed CBOs, the design In the second analytical replicate (Fig. 2d), to avoid the deterioraincluded four iPSC lines (CTL08A, CTL01, CTL02A, CTL04E) across tion of early time point samples, 1 million cells per sample were resusreplicates in both multiplexing modalities. For Census-seq-based pended in PBS supplemented with 0.1% BSA (Sigma, A9418), stained
assessment of mosaic organoid scalability, mCBOs were generated for 20 min at 37 °C with 2 µg ml−1 Hoecst 33342 (Sigma-Aldrich, B2261)
with different combinations of PSC lines as shown in Fig. 6a. in the presence of 5 µM verapamil (Sigma, V4629) and analyzed with
 a CytoFLEX instrument (Beckman Coulter Life Sciences) to measure
Cortical brain organoids DNA content.
Pure line-derived and mosaic brain organoids were generated using Analyses were performed with FlowJo (replicate 1, BD Biosciences)
an adaptation of the previously described protocol78, which allows or FCS Express 7 software (replicate 2, De Novo Software). Raw counts
one to obtain dorsal telencephalon cortical organoids, introducing are shown in Supplementary Data 1, and the gating strategy is shown
orbital shaking on day 12 of differentiation as previously published in Supplementary Fig. 2.
by us in refs. 5,11,15. PSCs were grown on Matrigel-coated plates to
a confluency of approximately 60–70%, dissociated with Accutase Histological analysis
(Sigma, A6964) and resuspended in TeSR/E8 medium supplemented Organoids were collected on differentiation days 50 and 100, washed
with 5 µM ROCK inhibitor Y-27632 (Tocris, 1254) to reach a final con- with PBS and fixed overnight at 4 °C in 4% paraformaldehyde–PBS
centration of 2 × 105 cells per ml. The cell suspension (100 µl per well) solution (Santa Cruz, sc-281692). After rinsing with PBS twice, samples
was seeded in ultra-low-attachment, U-bottom 96-well plates (System were embedded in 2% low melting agarose, placed in 70% (vol/vol)
Biosciences, MS9096UZ) and then centrifuged for 3 min at 150 rcf ethanol and immediately given to the Tissue Processing Unit for parafto promote formation of embryoid bodies. Plates were incubated at fin embedding, sectioning and routine hematoxylin–eosin staining.
37 °C with 5% CO2 and 3% O2 for 2 d, and then the first medium change Deparaffinization and rehydration were achieved by consecuwas performed, substituting TeSR/E8 with neural induction medium tive passages of 5 min each in the following solutions: 2× histolemon
containing 80% DMEM/F12 medium (Gibco, 11330057), 20% knockout (Carlo Erba, 454912), 100% ethanol, 95% ethanol, 80% ethanol and
serum (Gibco, 10828028), non-essential amino acids (1:100, Sigma, 2× ddH2O. Sections were then incubated for 45 min at 95 °C with 10 mM

Nature Methods

Article https://doi.org/10.1038/s41592-024-02555-5

sodium citrate buffer (VWR Chemicals, 27833) with 0.05% Tween-20 sequencing libraries were examined on the Agilent Bioanalyzer 2100
(Sigma, P1379) for simultaneous antigen retrieval and permeabiliza- using a High Sensitivity DNA chip (Agilent). Two indexed libraries were
tion and then equilibrated at room temperature for at least 2 h. After pooled equimolarly and sequenced on the Illumina NovaSeq 6000
30 min of blocking with 5% normal donkey serum ( Jackson Immu- platform using the v2 Kit (Illumina) with a customized paired-end,
noResearch, 017-000-121) in PBS, incubation with primary antibodies dual-indexing (26/8/0/98-bp) format according to the recommenin PBS with 5% normal donkey serum was performed. The following dation of 10x Genomics. Using proper cluster density, a coverage
primary antibodies were used: anti-PAX6 (rabbit, 1:200, BioLegend), of around 250 million reads per sample (2,000–5,000 cells) was
anti-TUJ1 (mouse, 1:1,000, BioLegend), anti-nestin (mouse, 1:500, obtained, corresponding to at least 50,000 reads per cell.
Millipore), anti-reelin (mouse, 1:400, Millipore), anti-CTIP2 (rat,
1:400, Abcam), anti-SATB2 (mouse, 1:400, Abcam), anti-HOPX (rabbit, Generation of CellPlex libraries
1:500, Sigma), anti-SOX2 (goat, 1:1,000, R&D Systems), anti-MAP2 Two independent downstream multiplexed datasets were generated
(guinea pig, 1:200, Synaptic Systems), anti-NeuN (mouse, 1:200, for external validation of the SCanSNP pipeline, labeling each geno-
Abcam), anti-Ki-67 (rabbit, 1:250, Abcam). The day after, secondary type with a specific barcode from the 3′ CellPlex Kit (10x Genomics,
antibodies conjugated with Alexa Fluor 488, 594 or 647 (donkey, PN-1000261). Briefly, organoids were collected on day 50 and dis-
1:400, Thermo Fisher) were diluted in PBS and applied to the sections sociated with an HBSS-based solution containing 30 U ml−1 papain
for 1 h, followed by a 5-min incubation with 1 µg ml−1 DAPI solution. (Stemcell, 07466) and 125 U ml−1 DNase I (Zymo Research) for 30–45 min
After each incubation, three 5-min washing steps with TBS buffer according to organoid size. After filtering through 70-µm-pore Flowmi
were performed. After a final rinse with deionized water, slides were Cell Strainers, cells were counted, and 1 million live cells per sample
dried and mounted using Mowiol mounting solution. Images at ×20, were taken and labeled with a unique barcode from the 3′ CellPlex Kit
×40 and ×63 magnification were acquired using a DM6 B MultiFluo Set A according to the manufacturer’s instructions. Once the washmicroscope (Leica) equipped with an Andor Zyla VSC-04470 sCMOS ing steps were completed, 1 × 105 live cells per sample were pooled
camera (Fig. 2) or with an ECLIPSE Ti2 Crest microscope (Nikon) together, and the concentration was adjusted to be within 1.2–1.6 × 106
coupled with a Photometrics Prime 95B camera at ×20 magnifica- cells per ml for droplet-based single-cell partitioning. Libraries were
tion (Extended Data Fig. 1) and then processed with Fiji software. For generated using the Chromium Next GEM Single Cell 3′ v3.1 Kit (10x
choosing the ‘maximum intensity’ option, and a gamma correction expression was set at 50,000 reads per cell, whereas, for CellPlex mulof 0.7 was applied to the AF488 channel. tiplexing oligonucleotides, a sequencing depth of 5,000 reads per cell
 was chosen as recommended.
Cortical brain organoid processing for single-cell
transcriptomic analysis Generation of bulk RNA-seq-based variant-calling file (VCF)
Organoids were collected on differentiation days 50, 100, 250 and Reference genotypes for the deconvolution were obtained from bulk
300 (±3 d). Three to five organoids per condition were dissociated by RNA-seq data of pure line-derived organoids.
incubation with a solution of 0.5 mg ml−1 Collagenase/Dispase (Sigma) Total RNA was isolated from pure line organoids with the RNeasy
with 0.22 mg ml−1 EDTA (Euroclone) and 10 µl DNase I at 1,000 U ml−1 Micro Kit (Qiagen) according to the manufacturer’s instructions. RNA
(Zymo Research) for 30–45 min according to organoid size. Digested quantification and integrity was assessed by electrophoretic analysis
suspensions were filtered through 70-µm-pore Flowmi Cell Strainers with the Agilent 2100 Bioanalyzer. The TruSeq Stranded Total RNA LT
(Sigma, BAH136800040), resuspended in PBS and counted using a Sample Prep Kit (Illumina) was used to run the library for each sam-
TC20 Automated Cell Counter (Bio-Rad). For the day 100 downstream ple using 500 ng total RNA as the starting material. Sequencing was
sample, the single-cell suspension was further centrifuged at 500 rcf performed with the Illumina NovaSeq 6000 platform, sequencing on
for 3 min and resuspended in 200 µl cold PBS–0.04% BSA. Pre-chilled average 35 million 50-bp paired-end reads per sample.
(800 µl) 100% methanol was added dropwise for a final concentration First, raw reads were aligned to the GRCh38 version 93 Ensembl
of 80%. Cells were fixed for 30 min and stored at −80 °C for 6 months. reference genome using STAR80 in two-pass mode to learn splicing
For recovery of a single-cell suspension, fixed cells were thawed junctions from data, subsequently, read group tags were made uniform,
at 4 °C (all steps at 4 °C) and centrifuged at 1,000 rcf for 5 min, the and optical and PCR-duplicated reads were marked using GATK Marksupernatant was completely removed, and pre-chilled SSC cocktail Duplicates. The resulting BAM file (in silico multiplexed BAM creation
(3× SSC, 0.04% BSA, 1% SUPERase-In, 40 mM DTT) was added. Cells is described in the Supplementary Methods) was recalibrated using
were counted and resuspended at a concentration 1,000 cells per BaseRecalibrator and ApplyBQSR with the sorted 00-All.vcf.gz (b151_
µl. Droplet-based single-cell partitioning and scRNA-seq libraries GRCh38p7) file from dbSNP. Next, we performed variant calling using
were generated using the Chromium Single Cell 3′ Reagent v2 Kit GATK HaplotypeCaller81 with the option ‘dont-use-soft-clipped-bases’–
(10x Genomics) following the manufacturer’s instructions79. Briefly, standard-min-confidence-threshold-for-calling set to 30 and –
a small volume (6–8 μl) of single-cell suspension at a density of 1,000 min-base-quality-score equal to 20. We applied thresholds for MIN_DP,
cells per μl was mixed with RT–PCR master mix and immediately DP and quality (GQ) of 10, 10 and 20, respectively. Finally, we used
loaded together with Single Cell 3′ gel beads and partitioning oil into CombineGVCFs and GenotypeGVCFs exclusively to merge together
a Single Cell 3′ Chip. The gel beads were coated with unique primers GVCFs of genotypes mixed in the corresponding single-cell experiment,
bearing 10x cell barcodes, unique molecular identifiers and poly(dT) ignoring the aggregated INFO field.
sequences. The chip was then loaded onto a Chromium instrument
(10x Genomics) for single-cell GEM generation and barcoding. RNA Alignment and genotype demultiplexing
transcripts from single cells were reverse transcribed within droplets scRNA-seq data were aligned using Cell Ranger 3.0.0 count and the
to generate barcoded full-length cDNA. After emulsion disruption, matched reference provided from 10x. For subsequent demultiplexing
cDNA molecules from each sample were pooled and pre-amplified. and downstream analyses, only droplets passing the Cell Ranger filter
Finally, amplified cDNA was fragmented, and adaptor and sample were considered. For demultiplexing, we applied demuxlet, souporindices were incorporated into finished libraries that were compat- cell, Vireo and SCanSNP. The final identities used are the result of the
ible with Illumina sequencing. The final libraries were quantified by consensus call (consensus call setup is described in the Supplementary
real-time quantitative PCR and calibrated with an in-house control Methods). With the exception of souporcell, all the tools were provided
sequencing library. The size profiles of the pre-amplified cDNA and with bulk RNA-seq-derived VCFs and were embedded in a collective

Nature Methods

Article https://doi.org/10.1038/s41592-024-02555-5

singularity image. To optimize the deconvolution process for our Trajectory isolation
samples, we used demuxlet with default parameters and the setting To analyze the cell state transitions with trajectory-wise magnifica-
‘–doublet-prior’ according to the number of retained droplets after tion, we isolated the most relevant neurodevelopmental trajectories.
Cell Ranger filtering and V3 kit specs doublet expectation. CellSNP, For this purpose, we first partitioned cells with the Leiden algorithm
the Vireo companion tool for single-cell variant calling, was launched with double resolution (1.2) with respect to the previous partitioning
‘with -p 10–minMAF 0.1–minCOUNT 20’, and subsequently Vireo was and used it as the basis for PAGA84, obtaining a PAGA graph. The PAGA
launched on the combined VCF file cleaned from loci containing miss- graph was refined by removing edges with weight <0.05. After coming calls. Souporcell was launched using the available singularity image plementing the edges to 1 to obtain the equivalent distance graph,
specifying only the number of genotypes in the mixture (k). hiPSC lines we computed the shortest path from root r to each endpoint e using
included in this analysis are listed in Supplementary Table 1. NetworkX85 with the Bellman–Ford method, where r is the partition
 of cells with highest counts for the ‘TOP2A’ gene and e are partitions
Single-cell data preparation with the highest rate of the cell types considered one of the endpoints
All downstream analyses were performed within the SCANPY single-cell (astrocytes, Cajal–Retzius-like neurons, early excitatory neurons, late
analysis framework82. excitatory neurons, interneurons and migrating neurons).
 Basic filtering was done right after importing count matrices
from Cell Ranger. We inspected the number of genes, mitochondrial Differential abundance analysis
gene counts and ribosomal gene count distributions and adopted We adopted Milo45 for differential abundance analysis. We tested for
dataset-specific thresholds to remove droplets with likely techni- differential abundance between the mosaic organoid dataset and
cal issues. Next, we removed droplets called for low quality or non-mosaic datasets via direct comparison following the Milo standdoublets according to the consensus call. After merging the seven ard workflow. The differential abundance test was between each time
datasets, cell counts were normalized and log transformed using the point and the other two simultaneously; therefore, we provided as
‘sc.pp.normalize_total’ and ‘sc.pp.log1p’ SCANPY functions. Finally, we model contrast CTn = Tn − (Tx + Ty)/2 for each of the n assessed time
regressed out the effect of total counts and the percentage of mitochon- points, where x and y are the other two time points, T is the timepoint
drial transcripts with the ‘sc.pp.regress_out’ and ‘sc.pp.scale’ functions. and CTn is the model contrast for timepoint n. Plots were generated
All functions were run with default parameters. displaying enriched/depleted cells’ neighbors for each time point
 with spatial FDR < 0.1.
Cell filtering and annotation
We relied on multiple tiers of annotation, filtering and dimensional- Differential expression analysis
ity reduction. First, we removed proteoglycan (WLS, ANXA2, TPBG, To compare the molecular impact of mosaic co-culture, we performed
RSPO3, DCN, BGN, MYH3)-expressing cells, considered non-relevant direct differential expression analysis between the same genotypes
for our downstream analyses. We next iteratively partitioned cells and either grown individually (downstream multiplexing) or in mosaics.
assessed the top marker via Leiden and rank_gene_groups, respectively, Given the impact of methanol fixation on the day 100 downstream
to remove cells highly expressing adhesion (WLS, TPBG) and stress dataset, (Supplementary Fig. 1b), we relied on day 50 datasets (Supple-
(BNIP3, PGK1, MT-CO2) markers while manually annotating cell types mentary Fig. 1c). To provide a reference of the expected batch-to-batch
using literature markers. Finally, we used SCANPY’s score_genes func- variability, we also compared the same genotypes when grown in two
tion providing ER stress and hypoxia signatures to remove clusters of different mosaic batches (Supplementary Fig. 1d). For both comparicells scoring >0 and >0.3, respectively. Finally, we repartitioned the sons, we kept the two most abundant genotypes (Supplementary
remaining cells with a Leiden resolution of 0.6 and manually transferred Fig. 1c,d, left) and the three most abundant cell types (that is, proliferatthe annotation to new clusters, merging, if needed, different partitions ing progenitors, radial glial progenitors and neurons; Supplementary
into coherent cell types when key markers were overlapping. Fig. 1c,d, right) present in both experiments. For each genotype and cell
 type combination, single-cell counts were aggregated to obtain two
Highly variable gene selection pseudoreplicates. Gene filtering and normalization were carried out
For HGV detection, we took advantage of having at least two datasets within edgeR86 using the functions filterByExpr() and calcNormFacper time point and detected HVGs by time point with the ‘sc.pp.highly_ tors(), respectively; the latter was performed to account for different
variable_genes’ SCANPY function, providing each dataset as a separate numbers of cells aggregated into the various pseudoreplicate combinabatch and min_mean = 0.0125, max_mean = 5 and min_disp= 0.5 as tions. Finally, count fitting (glmQLFit edgeR function) and the DE test
parameters. For each time point, we kept only genes found as HVGs in (glmQLFTest edgeR function) were repeated individually for each cell
at least two datasets. After major filtering and single-trajectory isola- type comparing the condition (multiplexing paradigm or replicate)
tion, HVGs were recomputed on the cell subset in the same fashion. while providing the genotype as the blocking variable.
Moreover, we included some relevant neurodevelopmental genes
from the literature regardless of whether they were detected as HVGs Developmental trajectory analysis
(Supplementary Data 2). We aimed to assess the distribution of cells along pseudotime by dif-
 ferent covariates for migrating neuron, astrocyte, Cajal–Retzius-like
Dimensionality reduction and dataset integration neuron and interneuron trajectories after their isolation. We wished
After filtering, PCA was computed on defined HVGs, and the seven to assess whether (1) time point differences mirror the asynchronous
datasets were integrated via SCANPY’s Harmony implementation83 development of specific cell types in our in vitro system, (2) the multiwith a maximum of 20 iterations; the cells’ neighborhood graph was plexing paradigm impact on the developmental timing of such populathen computed on top 15 PCs, specifying 100 as the neighborhood size tions and (3) whether we had the resolution to capture developmental
(n). Upon single-trajectory isolation, PCA was recomputed on each cell differences among control genotypes. For each trajectory individually,
subset and branch-specific HVGs, Harmony was run with a maximum of we computed diffusion map87 and dpt88. Next, for the different time
20 iterations, lambda = 2 and theta = 1, and cell neighborhood graphs points and the multiplexing paradigm, we computed the kernel density
were computed with ten PCs and 50 n; in the case of the excitatory neu- of each dataset (sklearn.neighbors.KernelDensity, kernel = ‘gaussian’,
ron lineage, we used nine PCs and 60 n, given the greater differences bandwidth corresponding to 5% of the whole pseudotime window)
between early and late branches than those within lineage-continuous and plotted mean and ±1 s.d. among dataset densities. For genotype
cell states of other cases. comparison, we kept the most relevant time points for each trajectory

Nature Methods

Article https://doi.org/10.1038/s41592-024-02555-5

(early and mid for migrating neurons and Cajal–Retzius-like neurons; at https://github.com/GiuseppeTestaLab/SCanSNP) by dividing the
early, mid and late for the other trajectories) and genotypes for which demultiplexing and filtering in 3(+1) steps:
at least 50 cells were retrieved at each retained time point. Finally, 1. Best ID detection per droplet: here, as for other approaches, we
the genotypes were balanced via random sampling to have the same leveraged the accessibility of bulk RNA-seq data to generate a
amount of cells across time points. Mean and standard deviations were function that maximizes the score difference of each ID to the
computed on kernel densities of 50 sampling iterations to assess the sequenced droplets:
stability.
 n
 For the isolated migrating neuron trajectory, we confirmed the Ai × aig Ri × rig
 Sg = ∑ (( +( ))) ,
dpt-based genotype grouping (Fig. 5c) by assessing their behavior along i=1
 ti Ti
PC1. We started by confirming that PC1 was mainly driven by differentiation, and thus could be used as an alternative of pseudotime measure. where Sg is the score for ID g in each droplet, i are the loci for which
To do so, we quantified the PC1 variance (adjusted R2) explained by the allelic information is accessible from bulk RNA-seq, A and R are,
annotated Leiden covariate using the ordinary least-square implemen- respectively, the number of reads supporting alternative and reftation of the statsmodels Python library (Extended Data Fig. 7a, left). erence alleles, a and r are the number of alternative and reference
Similarly, we then assessed the PC1 variance explained by the genotype alleles in g and t and T are total alternative and reference alleles in
(Extended Data Fig. 7a, right) and genotype distributions along PC1 the cohort at locus i.
(Extended Data Fig. 7b). 2. Second-best ID determination: given an m-by-g contribution
 Subsequently, we used tradeSeq89 (fitGAM function was run matrix, where m are the droplets and g are the multiplexed IDs
with nknots = 8 after trimming cells in the first and 99th dpt percen- containing the number of reads supporting genotype-specific
tiles to increase stability at lowly sampled extremes) and detected alleles. We used this matrix to iteratively train a multinomial
pseudotime-driven transcriptional difference within each lineage for logistic regression model to predict which is the most likely ID
all but excitatory neuron trajectories, whereas, for excitatory neurons, after the first one, assuming ambient contamination consistent
we used tradeSeq to find key transcriptional differences between across droplets. We split the contribution matrix into groups of
early–mid and late neuronal trajectories. droplets sharing the best ID according to step 1; for each group,
 Within lineage differences, to extract key driver genes along pseu- we trained the model on counts and labels from other groups to
dotime, we isolated HVGs between lineage extremes (tradeSeq start- predict the second-best ID of barcodes in the current group.
VsEndTest(), pVal ≤ 0.001 and log (FC) ≥ 2). 3. Doublet detection: to allow doublet detection to be specific
 For early-versus-late excitatory neuron differences, to detect and flexible while accommodating genetic contributions
key differences between the two lineages, we considered both the ranging from balanced doublets to the presence of a cell and
greatest divergently expressed genes at the terminal states (tradeseq debris in the same drop, we implemented a method similar to
diffEndTest(), pVal ≤ 0.001 and log (FC) ≥ 2) and the transiently the one adopted in ref. 22. Starting from the previous m-by-g
varying genes, defined as simultaneously low ranked from the contribution matrix, for every genotype g, we define as negatradeSeq:diffEndTest function and high ranked from the tradeSeq:p tive droplets the ones that do not contain that genotype as the
atternTest(pVal ≤ 0.001) function. best ID according to the first step and fit a negative binomial
 distribution via the fitdistrplus91 R function on counts support-
Allele-specific expression analysis ing private g alleles. We therefore used the 99% quantile of the
We leveraged our multigenotype design to carry out ASE analysis for fitted distribution as the positivity threshold. Droplets positive
each cell type annotated. We first produced the read pileup at genomic for more than one ID are considered multiplets.
(biallelic-only) loci displaying variability within our cohort using 4. We finally took advantage of the mixed-genotype design to
SCanSNP pileup mode, which provided an anndata82 with nCells × nLoci structure an added layer of a low-quality droplet detection to be
dimensionality and two layers: ‘Refreads’ and ‘Altreads’, with the count used during consensus call aggregation.
of reads presenting or not presenting the variant, respectively. To
perform the analysis, we summed the reads mapping to variant sites We applied a Gaussian mixture model expectation-maximization
(at least one heterozygous genotype) of the same cell type. If multiple algorithm (implemented through the R mixtools92 package) to sepagenotypes were heterozygous at the given location, reads were included rate droplets with ‘low’ and ‘high’ signal-to-noise ratios by computing
in the sum regardless of the original genotype. As it is not granted that, log (FC) between the first- and second-best predicted IDs. We started
among different individuals, if present, the dominant allele is the same, by preparing a new contribution matrix similar to the one in passage 2
we first checked that, for loci with detected ASE, the dominant allele but considering only non-ambiguous loci between each possible
was coherent before merging coverages from different individuals. pair of best and second-best IDs in the dataset. Additionally, before
We observed minimal discrepancy, that is, at a given locus, the domi- log (FC) calculation, we add pseudocounts, which mimics average
nant allele was vastly the same (always Ref or Alt) across genotypes ambient RNA contamination coming from each ID, calculated as the
(information available in the Github repository of the paper, Notebook average rate of reads deriving from the other genotype’s unambigu-
04_ASE/13.1_SanityCheck). For each cluster, we kept only loci with at ous reads when they are not labeled as first ID or second ID across
least 20 reads, computed the β value (Alt reads/(Alt reads + Ref reads)) all droplets (according to the contribution matrix); similar to the
and performed binomial test and FDR correction (q < 0.05) provided by approach proposed in the hashedDrops function from the package
the SciPy90 and statsmodels implementations, respectively. To calculate MarioniLab/DropletUtils93,94, this step ensures that log (FC) is always
the correlation among cell types, we used β values of loci with detected defined for all droplets. Given the nature of the model, the resulting
ASE in at least one cell type and covered with at least 20 reads in all cell classification assumes the presence of two distinct populations that
types. Correlation was computed in pandas with ‘spearman’ metrics. can be separated based on the proportion of the two IDs, and, given
 that it is computed after doublet detection, it will likely detect those
SCanSNP droplets that embed enough ambient RNA to pass the Cell Ranger
In our benchmark, the presence of low-quality droplets and doublets emptyDrops filter, while it should not be used if any sort of prior filterwas observed to be an open challenge also for well-established methods ing of low-quality droplets has already been done. Benchmarking of
when assigning genotypes (IDs) to droplets in the genetic demultiplex- SCanSNP and genetic demultiplexing in barcode-tagged samples are
ing. With those challenges in mind, we developed SCanSNP (available described in the Supplementary Methods.

Nature Methods

Article https://doi.org/10.1038/s41592-024-02555-5

Power estimation for single-cell eQTLs details on sample size, number of replicates, statistical tests and signifi-
We estimated the eQTL power using our R package scPower (version cance are provided in the relevant figure legends. CBOs were differenti-
1.0.2)50 for sample sizes between 25 and 200 and for number of cells ated in multiple independent batches, and the number of replicates was
per sample between 250 and 1,500, keeping the read depth as in our chosen on the basis of previous published studies on brain organoids.
experiment. We fitted the required expression priors per cell type using The experiments were not randomized. The investigators were not
the complete scRNA-seq dataset, combining the different multiplexing blinded to allocation during experiments and outcome assignments.
strategies and time points, and took effects from a previously published
single-cell eQTL study in IPS cells35, excluding eQTLs from ROT-treated Graphics and figures
cells. Genes were defined as expressed with at least three counts in at Final figure panels were assembled using Adobe Illustrator version
least 9.5% of the samples. 27.0.1. For the organoids, cells and human shapes in Fig. 1, templates
 were downloaded from BioRender and subsequently modified.
Modeling mCBO clonal dynamics
We integrated the longitudinal Census-seq data with mCBO imaging to Reporting summary
model mCBO clonal dynamics (modeling of PSC and CBO growth with Further information on research design is available in the Nature
imaging; Census-seq and Census-seq ranking of iPSC lines in mosaic Portfolio Reporting Summary linked to this article.
organoids are described in the Supplementary Methods). First, we
used already published imaging of CBOs stained for nuclear markers to Data availability
estimate the density of cells inside CBOs (0.000767495 per µm3). Next, The scRNA-seq data generated in this study are accessible via Array­
for each replicate of each mosaic combination that we longitudinally Express (accession E-MTAB-14574). WGS and low-pass WGS sequencing
profiled with imaging, we multiplied the measured area of the mCBOs data have been deposited at the European Genome–Phenome Archive
(converting this to the equivalent sphere volume simply through the with the study identifier EGAD50000000978. Additional resources
sphere volume formula) by the density to estimate the number of cells include the reference genome Ensembl GRCh38 version 93, dbSNP
present in each mCBO at each time point. We computed the average of version b151 GRCh38p7 (00-All.vcf) and single-cell eQTLs from Jerber
this value for each mosaic combination across the replicates for each et al.35 (Table 7). Source data are provided with this paper.
time point. We then multiplied this value by the average contribution of
each iPSC line in each mosaic combination, as given by the correspond- Code availability
ing Census-seq data (correlation across multimodal ranking is described Full code used for the analyses can be retrieved at https://github.com/
in the Supplementary Methods). This represents the estimated number GiuseppeTestaLab/organoidMultiplexing_release. The latest release
of cells for each PSC line in each mCBO at the different time points. The of SCanSNP and the docker image link are available at https://github.
ratio between sequential time points was computed to estimate the com/GiuseppeTestaLab/SCanSNP.
line-specific growth rates, and their stability across mosaic combinations (Fig. 6b and Extended Data Fig. 10b) as defined by nit = rit · nt and References
gi = (nit+ 1)/nit with nt as the total number of cells in the organoid at time t, 78. Yoon, S.-J. et al. Reliability of human cortical organoid generation.
rit is the ratio of cells measured by Census-seq, nit is the number of cell per Nat. Methods 16, 75–78 (2019).
genotype at time t, gi is the growth rate of the genotype i. The empirical 79. Zheng, G. X. Y. et al. Massively parallel digital transcriptional
distribution is defined by expanding the distribution of gi∀ genotypes profiling of single cells. Nat. Commun. 8, 14049 (2017).
i from our measured data. We used the computed line-specific growth 80. Dobin, A. et al. STAR: ultrafast universal RNA-seq aligner.
rates to estimate an empirical distribution of possible growth rates. We Bioinformatics 29, 15–21 (2013).
then generated the growth rates of the lines inside the mCBO randomly 81. Poplin, R. et al. Scaling accurate genetic variant discovery to tens
(10,000 cycles of sampling) from the probability distribution calculated of thousands of samples. Preprint at bioRxiv https://doi.org/
over the domain. The process was repeated for sample sizes between 10.1101/201178 (2017).
two and 20 theoretically multiplexed lines. 82. Wolf, F. A., Angerer, P. & Theis, F. J. SCANPY: large-scale single-cell
 Because we had a constant number of starting cells (20,000) when gene expression data analysis. Genome Biol. 19, 15 (2018).
generating mCBOs, we multiplied this by the Monte Carlo simulated 83. Korsunsky, I. et al. Fast, sensitive and accurate integration of
growth rates, thus modeling the expected number of cells per line for single-cell data with Harmony. Nat. Methods 16, 1289–1296 (2019).
all the possible conditions (from two to 20 starting lines). 84. Wolf, F. A. et al. PAGA: graph abstraction reconciles clustering
 To translate this into useful guidelines for experimental with trajectory inference through a topology preserving map of
disease-modeling pipelines, we considered that at least 100 cells per single cells. Genome Biol. 20, 59 (2019).
neurodevelopmental cell type should be recovered for each PSC line 85. Hagberg, A. A., Schult, D. A. & Swart, P. J. Exploring network
grown in mCBOs and that 100,000 cells can be sequenced. On the structure, dynamics, and function using NetworkX. In Proc.
basis of these parameters, Supplementary Fig. 10c shows the number Python in Science Conference (SciPy) (eds Varoquaux, G. et al.)
of PSC lines (y axis) retrieved with the highest empirical probability https://doi.org/10.25080/TCWV9851 (SciPy Proceedings, 2008).
given the number of PSC lines used to generate mCBOs (x axis). We 86. Chen, Y., Lun, A. T. L. & Smyth, G. K. From reads to genes
finally employed the curve_fit function from the SciPy python library to to pathways: differential expression analysis of RNA-seq
estimate the coefficients a and b of the power function N = aIb + c linking experiments using Rsubread and the edgeR quasi-likelihood
the number of mixed cell lines I and the average number of recovered pipeline. F1000Res. 5, 1438 (2016).
lines N (Fig. 6c). The scalability of mosaic experiments in terms of 87. Haghverdi, L., Buettner, F. & Theis, F. J. Diffusion maps for
experimental timeline is described in the Supplementary Methods. high-dimensional single-cell analysis of differentiation data.
 Bioinformatics 31, 2989–2998 (2015).
Statistics and reproducibility 88. Haghverdi, L., Büttner, M., Wolf, F. A., Buettner, F. & Theis, F. J.
Statistical analyses were carried out using tests appropriate for each Diffusion pseudotime robustly reconstructs lineage branching.
assessed modality using SCANPY, tradeSeq and Milo for single-cell Nat. Methods 13, 845–848 (2016).
transcriptomics analyses. 89. Van den Berge, K. et al. Trajectory-based differential expression
 The threshold for statistical significance was spatial FDR < 0.1 for analysis for single-cell sequencing data. Nat. Commun. 11, 1201
differential abundance (Milo) and P < 0.05 for other statistical tests. All (2020).

Nature Methods

Article https://doi.org/10.1038/s41592-024-02555-5

90. Virtanen, P. et al. SciPy 1.0: fundamental algorithms for scientific A. Valenti, S.S., M.L., S.T. and M.P. are/were PhD students at the
 computing in Python. Nat. Methods 17, 261–272 (2020). European School of Molecular Medicine (SEMM). N.C., C.E.V. and G.T.
91. Delignette-Muller, M. L. & Dutang, C. fitdistrplus: an R package for conceived the project and, with M.T.R. and D.C., implemented the
 fitting distributions. J. Stat. Softw. 64, 1–34 (2015). experimental and analytical design; M.T.R. has driven the experimental
92. Benaglia, T., Chauveau, D., Hunter, D. R. & Young, D. S. mixtools: activities with the help of S.S., M.L., D.B. and S.T.; D.C. has driven the
 an R package for analyzing mixture models. J. Stat. Softw. 32, 1–29 computational work with the help of C.C., A. Valenti, M.B. and K.T.S.;
 (2010). M.P., A. Vitriolo, A.L.T., D.R., M.H. and F.J.T. contributed to the study
93. Lun, A. T. L. et al. EmptyDrops: distinguishing cells from empty design and critical discussions and interpretation of the results; N.C.,
 droplets in droplet-based single-cell RNA sequencing data. C.E.V. and G.T. supervised wet and computational activities; N.C., D.C.,
 Genome Biol. 20, 63 (2019). M.T.R., C.E.V. and G.T. wrote the paper with input from all other authors.
94. Griffiths, J. A., Richard, A. C., Bach, K., Lun, A. T. L. & Marioni, J. C. All authors read and approved the final paper.
 Detection and removal of barcode swapping in single-cell
 RNA-seq data. Nat. Commun. 9, 2667 (2018). Competing interests
 F.J.T. consults for Immunai, Singularity Bio, CytoReason and
Acknowledgements Omniscope and has ownership interest in Dermagnostix and Cellarity.
We thank present and former members of G.T.’s laboratory for The other authors declare no competing interests.
collaborating to various extents on this study with both technical help
and conceptual discussion. We also thank the Flow Cytometry and Additional information
Imaging facilities of Human Technopole and the European Institute of Extended data is available for this paper at
Oncology (IEO) and colleagues in the Genomics Unit of the IEO and https://doi.org/10.1038/s41592-024-02555-5.
the Center for Genomic Science of the Istituto Italiano di Tecnologia
for helpful discussion at the onset of the project. We thank the Supplementary information The online version
European School of Molecular Medicine (SEMM) at which D.C., M.T.R., contains supplementary material available at
A. Valenti, S.S., M.P., S.T. and M.L. are/were enrolled as students for https://doi.org/10.1038/s41592-024-02555-5.
their PhD degree program in Systems Medicine. Some components
of the schematics were adapted from BioRender. The project, Correspondence and requests for materials should be addressed to
carried out in G.T.’s laboratory at the IEO and at Human Technopole, Giuseppe Testa.
has been funded by European Union Horizon 2020 research and
innovation program grants EDC-MixRisk (634880), ENDpoiNTs Peer review information Nature Methods thanks Carlo Colantuoni and
(825759), NEUROCOV (101057775), RE-MEND (101057604), R2D2-MH the other, anonymous, reviewer(s) for their contribution to the peer
(101057385) and PNRR (Centro Nazionale CN3: RNA, ‘National Center review of this work. Primary Handling Editor: Madhura Mukhopadhyay,
for Gene Therapy and Drugs based on RNA Technology’). in collaboration with the Nature Methods team. Peer reviewer reports
 are available.

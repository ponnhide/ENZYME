nature protocols https://doi.org/10.1038/s41596-025-01299-6


Protocol Check for updates


CRISPR screens in human neural
organoids and assembloids
Xiangling Meng , Noah Reis
 1,2
 , Michael C. Bassik
 1,2 3
 & Sergiu P. Pașca 1,2


Abstract Key points


Studying the molecular mechanisms underlying the assembly of the human • We present pooled CRISPR–
 Cas9 screening with neural
nervous system remains a significant challenge. The ability to generate neural organoid and assembloid models.
cells from pluripotent stem cells, combined with advanced genome-editing Key stages include planning and
 optimizing genetic perturbations,
techniques, provides unprecedented opportunities to uncover the biology of
 designing readouts for neuronal
human neurodevelopment and disease. Organoids and assembloids enable the generation and migration,
in vitro modeling of previously inaccessible developmental processes, such as conducting the screening and
 validating candidate genes.
the specification and migration of human neurons, including the integration
of cortical interneurons from the ventral into the dorsal forebrain. Here, we • Using neural organoids and
 assembloids is ideally suited for
present a detailed protocol that combines pooled CRISPR–Cas9 screening with studying complex developmental
neural organoid and assembloid models and illustrate how it can be applied to processes involving diverse cell-
 cell interaction. This approach
map hundreds of disease genes onto cellular pathways and specific aspects of
 has enabled hundreds of disease
human neural development. Our protocol outlines key steps, from planning genes to be mapped onto cellular
and optimizing genetic perturbations to designing readouts for neuronal pathways and specific aspects of
 human neural development.
generation and migration, conducting the screening and validating candidate
genes. The screening experiments take ~3 months to complete and require
expertise in stem cell culture and neural differentiation, genetic engineering Key references
of human induced pluripotent stem cell lines, fluorescence-activated cell
sorting and next-generation sequencing and analyses. The integration of Birey, F. et al. Nature 545, 54–59
 (2017): https://doi.org/10.1038/
genetic screening and human cellular models constitutes a powerful platform nature22330
for investigating the mechanisms of human brain development and disease,
 Meng, X. et al. Nature 622,
paving the way for the discovery of novel therapeutics. 359–366 (2023): https://doi.org/
 10.1038/s41586-023-06564-w

 Morgens, D. W. et al. Nat.
 Biotechnol. 34, 634–636 (2016):
 https://doi.org/10.1038/nbt.3567


Department of Psychiatry and Behavioral Sciences, Stanford University, Stanford, CA, USA. 2Stanford Brain
1


Organogenesis Program, Wu Tsai Neurosciences Institute & Bio-X, Stanford, CA, USA. 3Department of Genetics,
Stanford University, Stanford, CA, USA. e-mail: spasca@stanford.edu


Nature Protocols 1

Protocol


Introduction

Organoids and assembloids derived from human induced pluripotent stem (hiPS) cells
model various aspects of nervous system development and function and can be used to study
neurodevelopmental and neurodegenerative disorders1–4. For instance, we developed human
forebrain assembloids5 (hFA) by integrating human cortical organoids (hCO), representing
the cerebral cortex, with human subpallial organoids (hSO), mimicking the ventral forebrain
(Fig. 1), which can be used to study cortical interneuron migration and circuit integration5–7. This
preparation mirrors the cellular behavior of neurons in the fetal forebrain5,8. Using this system,
we investigated Timothy syndrome, a neurodevelopmental disorder caused by mutations
in the CaV1.2 calcium channel and discovered that interneurons in mutant assembloids
exhibit abnormal migratory saltations5. Further molecular analyses revealed the underlying
mechanisms driving these migration defects8. Importantly, we also leveraged this platform to
identify and test the efficacy of an antisense oligonucleotide designed to correct the aberrant
exon usage caused by the mutation, successfully mitigating interneuron migration defects9.

Development of the protocol
Abnormalities in the development and function of cortical γ-aminobutyric acid–releasing
interneurons are increasingly recognized as contributing factors to autism spectrum disorder
and other neurodevelopmental disorders (NDDs)10,11. This connection is supported by the high
prevalence of seizures and epilepsy in individuals with autism spectrum disorder and by genetic
studies that have identified numerous NDD-associated genes related to inhibitory signaling,
including multiple γ-aminobutyric acid receptor subunits12,13. Despite these findings, linking
specific genetic mutations to distinct phases of the extended process of human forebrain
development remains challenging.
 Pooled CRISPR–Cas9 genetic screening provides a powerful, high-throughput
approach to systematically study the functions of a group of genes in complex biological
processes14,15. Although this approach has been applied with neural organoids to study early
neural differentiation, its use in investigating more complex developmental events, such as
interneuron differentiation and migration, had not been demonstrated. In particular, it had


a Fig. 1 | Generation of hiPS cell–derived hCO and hSO to model forebrain
 Dorsal forebrain development. a, Coronal section schematic of the gestational week (GW)
 (pallium, hCO) 18–20 human brain, illustrating the dorsal (pallial) and ventral (subpallial)
 forebrain. b, A schematic showing differentiation of hiPS cells into organoids
 Ventral forebrain
 (subpallium, hSO) modeling specific brain regions and the generation of hFA. c, Timeline for the
 neural induction and patterning to generate hCO and hSO. BDNF, brain-derived
 GW 18–20 neurotrophic factor; d, day; DM, dorsomorphin; SAG, smoothened agonist;
b SB, SB-431542; XAV, XAV-939. Panel a adapted with permission from ref. 33,
 Springer Nature.

 hCO

 Guidance
 hFA
 hiPS cells Aggregation


 hSO
c
 d1 d7 d26 d47
hCO
 DM, SB EGF, FGF2 BDNF, NT3

 d1 d7 d13 d26 d47
hSO
 DM,SB, XAV EGF, FGF2, XAV BDNF, NT3
 SAG


Nature Protocols 2

Protocol


been unclear whether significant single-guide RNA (sgRNA) enrichment or depletion could be
maintained in organoid and assembloid models that require long-term differentiation.
 Through combining neural organoid and assembloid models with CRISPR–Cas9 screening,
we systematically assessed the impact of 425 NDD-associated genes on interneuron generation
and migration into cortical circuits16. Specifically, we established a reporter hiPS cell line that
labels interneurons and applied it in both organoid and assembloid models. In organoids,
we assessed interneuron generation, and in assembloids, we assessed interneuron migration
into cortical circuits. By comparing sgRNA enrichment and depletion across interneuron
populations in these contexts, our analysis identified 46 genes (~11% of genes screened) that
significantly disrupted interneuron development. We validated several of these hits and
found results consistent with the screen, demonstrating that significant sgRNA enrichment or
depletion can be reliably maintained long term in both organoid and assembloid models. These
findings underscore the utility of this CRISPR-assembloid platform in mapping NDD-associated
genes to specific developmental processes and uncovering the mechanisms of disease.
 Here, we present a detailed protocol for integrating pooled CRISPR–Cas9 screening with
neural organoids and assembloids to study human interneuron generation (i.e., interneuron
generation screen) and migration to the developing cortex (i.e., interneuron migration screen).
The protocol outlines key steps for applying CRISPR screening in 3D organoid cultures,
addressing challenges such as culture variability and extended culture duration. In addition,
this protocol includes a practical workflow for generating knockout (KO) cell lines for screen
hits, enabling downstream functional validations.

Overview of the procedure
Our protocol for pooled CRISPR screening in neural organoids and assembloids can be divided
into five sections (Fig. 2a,b). Section 1 begins with the transduction of hiPS cells by using
lentivirus carrying sgRNAs, which also encodes mCherry to label infected cells, followed by
the maintenance of transduced hiPS cells to achieve gene perturbation. This is followed by
section 2, which describes the generation of hSO from genetically modified hiPS cells. We also
provide details on the generation of hCO for use in the migration screen. Section 3 describes
steps for isolating cells from parallel screens for interneuron generation and migration. This
involves the use of engineered hiPS cells to stably express eGFP under the control of a previously
validated Dlxi1/2b enhancer, which labels ganglionic eminence-derived cells5,17. Section 4 covers
sequencing and data analysis to curate a list of candidate genes. Finally, section 5 details the
functional validation of gene hits.

a b
 Section 1, hiPS cell transduction and gene perturbation
 GFP– cells
 FACS

 Lenti
 L e sgRNAs GFP+ cells
 Section 2, generation of hSO with genetically perturbed hiPS cells
 Interneuron generation screen
 mCherry+

 FACS hCO
 Section 3, selection hSO
 hS
 SO FACS
 hiPS cells expressing
 Cas9 & Dlxi1/2b::eGFP hCO GFP+ cells


 Cut
 Section 4, gDNA extraction, PCR, sequencing and data analysis
 hFA hSO FACS
 hSO GFP+ cells


 Section 5, validation of individual candidates Control hiPS cells hCO

 t


 Interneuron migration screen

Fig. 2 | Overview of the protocol. a, Overview of the five sections of the CRISPR interneurons into the hCO side of an hFA. Panel b reproduced with permission
screens in hFA. b, Schematic showing the detailed steps of the interneuron from ref. 16, Springer Nature.
generation and migration screens. The inset illustrates migration of hSO-derived


Nature Protocols 3

Protocol


Applications
This protocol combines pooled CRISPR KO screening with hiPS cell–derived neural organoids
and assembloids to provide a versatile platform for investigating the genetic regulation of
neural development. Although it specifically focuses on interneuron development, the protocol
studying interneuron generation can be adapted to studying various developmental processes,
including corticogenesis, gliogenesis and cell-type specification in regions such as the
striatum18, thalamus19 and cerebellum20. The protocol for studying interneuron migration into
the dorsal forebrain may also be adapted to study integration of interneurons into circuits or
the genetic regulation of the migration of other cell types. To adapt the protocol for alternative
applications, reporter hiPS cell lines for the cell type of interest are needed. Experimental
readouts should then be adapted to the biological process of interest.
 By targeting specific groups of genes or through unbiased genome-wide screens, this
approach enables the systematic identification of key regulators involved in diverse biological
processes. Although this protocol focuses on neural organoids and assembloids derived from
hiPS cells, it can be adapted for human embryonic stem cell–derived cultures. The use of neural
organoids and assembloids derived from human cells captures the unique human context of
disease21,22. This makes the protocol particularly powerful for studying the genetic basis of
neurodevelopmental disorders such as autism, epilepsy and schizophrenia.

Comparison with other methods
Among existing approaches, pooled CRISPR screening with 2D hiPS23–25 cell–derived neuronal
cells has been widely used because of their scalability and shorter differentiation time. This
format is particularly useful for assessing basic cellular phenotypes such as viability and
proliferation. These 2D cultures, however, often involve the direct conversion of hiPS cells into
terminally differentiated cell types, which precludes the modeling of intermediate stages of
development. In addition, these cultures are more homogeneous in terms of cell composition,
limiting their use for studying cell-cell interactions, such as interneuron migration. Neural
organoids and assembloids, on the other hand, are suitable for conducting research focused
on investigating the complex developmental processes involving diverse cell-cell interaction.
The combination of CRSIPR-based perturbation with single-cell RNA sequencing26 enables
the profiling of transcriptional consequences due to gene perturbation. This illustrates how
a gene perturbation alters cellular identity, differentiation trajectories or gene regulatory
networks. However, this strategy is technically demanding, requiring high-quality single-cell
RNA sequencing data and sufficient coverage for each perturbation, and therefore limiting
the throughput of the experiment. The approach that we present here relies on genomic DNA
sequencing of bulk samples and therefore can be scaled up to genome-wide screening. In
addition, coupling CRISPR screening with phenotypic assessments allows one to study specific
biological processes, which can be difficult to infer from RNA profiles alone.

Limitations
There are a number of limitations to consider while designing and interpreting results from the
pooled CRISPR KO screen in human neural organoids and assembloids.
 First, the off-target effects of sgRNAs can result in unintended gene perturbations and
confounding phenotypes. To minimize this, we recommend using multiple independent
sgRNAs per gene and validating top candidate genes individually with orthogonal approaches.
 Second, variability between hiPS cell lines and their insufficient benchmarking can
influence differentiation potential, gene expression profiles, and responses to genetic
perturbations, thereby affecting the reproducibility and generalizability of the screen. Carefully
validating the pluripotency and genome integrity of hiPS cell lines is essential27. Conducting
screens across multiple hiPS cell lines can improve robustness. In addition, validating top
candidates across multiple hiPS cell lines ensures broader relevance. Batch-to-batch variability
in organoid cultures can also introduce technical noise; therefore, quality-control steps at
multiple stages of differentiation and across biological replicates is essential.
 Third, the heterogeneous nature of gene disruption in pooled CRISPR screens can
complicate genotype-phenotype correlations. Editing outcomes may range from homozygous

Nature Protocols 4

Protocol


KO to compound heterozygous KO or heterozygous KO. This can obscure phenotype-genotype
associations, particularly for genes with dosage-sensitive effects. Follow-up validation using
isogenic homozygous or heterozygous KO lines is critical for clarifying the effect of complete or
partial loss of the candidate genes.
 Moreover, organoids, despite mimicking many aspects of the developing brain, lack
vascularization and cross-talk between brain regions28. Assembloid generation is laborious,
limiting some readouts and large-scale studies. Moreover, these studies are long, often
requiring >10 weeks of in vitro differentiation. Despite these challenges, this protocol provides
a powerful tool for exploring complex neurodevelopmental processes in a human-relevant
context.

Experimental design
Validation of Cas9 expression
In this protocol, we use a hiPS cell line that stably expresses Cas9 under a Tet-off system, for
which we validated gene-editing efficiency by using a GFP self-cutting assay16. We and others
have observed that Cas9 function may vary in postmitotic cells29. Therefore, we maintained in
culture the virus-infected hiPS cells (with sgRNA and Cas9 expression) for ~10 d to ensure gene
editing. For experiments editing postmitotic cells, including neurons, it is crucial to validate
Cas9 function in the cell type of interest.

Designing the readout of the screen
A critical aspect of CRISPR screening is determining the readout of the screen and the time
point to perform the experimental readout for the phenotype or biological process being
studied. In the protocol presented here, we focused on both interneuron generation and
migration in the forebrain. To track interneurons, we engineered a hiPS cell line to stably
express eGFP under the control of a previously validated Dlxi1/2b enhancer, which labels
the medial ganglionic eminence–derived cell lineage5,17. Consequently, interneurons in the
hSO were marked as Dlxi1/2b::eGFP+. For the interneuron generation screen, we assessed the
relative enrichment of sgRNAs for each targeted gene by comparing sorted Dlxi1/2b::eGFP+
and Dlxi1/2b::eGFP− populations in hSO. To minimize screen duration while still capturing
lineage specification, we performed this comparison immediately after the patterning phase
of hSO differentiation, when ~25% of the cells in the hSO should have acquired an interneuron
identity (Fig. 3d,e). For the interneuron migration screen, we evaluated the relative enrichment
of sgRNAs for each targeted gene in migrated and non-migrated Dlxi1/2b::eGFP+ cells in hFA.
On the basis of our empirical observations, we conducted this comparison on samples that
were collected 30 d after assembly to ensure enough migrated interneurons for downstream
analysis.

Library representation
Maintaining sufficient library representation is essential for ensuring the reproducibility
of a pooled CRISPR screen30, especially considering inter-hiPS cell line variability for neural
organoid generation31. In practice, the actual library representation for a given screen may be
lower than theoretically calculated, particularly in long-term cultures that model dynamic
developmental processes. When resources permit, increasing library representation can help
mitigate these challenges and improve the robustness of the screen.

Minimization of organoid fusion
During neural induction, differentiation and patterning, neural organoids tend to fuse with
each other32. To improve culture quality, we routinely separate fused organoids33, or one can
incorporate xanthan gum polymers to avoid fusion34. Large organoid clusters can impede
cellular growth and result in unwanted cell death.

Minimization of cell death during dissociation
Harsh dissociation of organoids and assembloids can induce cell death, especially in long-term
cultures. To minimize this, we optimized papain concentration and incubation time on the basis

Nature Protocols 5

Protocol


 a b c d
 Dlxi1/2b::eGFP– Dlxi1/2b::eGFP+

 Negative 0.078%
 control

 hSO 33.1%

 0 104 106
 1 mm 1 mm 1 mm
 GFP

 e 40
 f g
Dlxi1/2b::eGFP+ cells


 30
 Percentage of


 20


 10


 0
 hSO

 h i
 hSO
 CTL CAG::Cas9;Dlxi1/2::eGFP
 hCO hSO
 hCO
 hFA


 300 µm 1 mm

 Fig. 3 | Generation of regionalized neural organoids and assembloids. a, hiPS cells seeded in an AggreWell plate.
 b, Neural spheroid formation in the AggreWell plate after 24 h of culturing. c, Representative image of neural spheroids after
 being dislodged and transfered into a 100-mm ultra-low-attachment plate. d, Flow cytometry analysis of the percentage of
 Dlxi1/2b::eGFP+ cells in hSO. Representative histograms of flow cytometry analysis of 45-d hSO. The negative control is hSO
 without GFP expression. The x-axis shows the fluorescence intensity of GFP, and the y-axis shows cell counts. e, Percentage
 of Dlxi1/2b::GFP+ cells in hSO derived from a control hiPS cell line. Each dot represents the data from an individual hSO.
 Data are presented as mean ± s.e.m. f, One hCO and one hSO were transferred into a well of a 24-well low-attachment plate
 to generate an hFA. g, After setting up the hFA, the plate was tilted in the incubator to facilitate hFA formation. h, Schematic
 and representative image of the hFA at 30 d after assembly. The hSO was derived from the CAG::Cas9;Dlxi1/2b::eGFP hiPS
 cell line. i, Representative image showing hFA transferred to a plate for separation of the hCO from the hSO. CTL, control.
 Panels d and e adapted with permission, and panel h reproduced with permission from ref. 16, Springer Nature.


 of the developmental stage of the culture, by using the lowest effective enzyme concentration
 and the shortest possible incubation duration. For day-45 hSO dissociation, we used 10 U ml−1
 papain with a 15-min incubation. For ~day-75 hSO dissociation, we used 30 U ml−1 papain
 with a 45-min incubation. In addition, we included a step to remove debris generated during
 dissociation. It is important to adapt the dissociation method to the specific multicellular
 preparation used.

 Length of the screen
 Optimizing the screen duration can influence the signal-to-noise ratio. For screens focused on
 the generation of a specific cell type, it is important to first establish the time course of cell type
 development. Experimental readout should be conducted at an early time point to maximize
 the signal-to-noise ratio.

 General considerations for culturing hiPS cell–derived neural organoids
 • Genome integrity of hiPS cells should be verified by single-nucleotide polymorphism or
 comparative genomic hybridization arrays after genetic engineering.


 Nature Protocols 6

Protocol


 • All cultures should be regularly monitored for bacterial, mycoplasma and fungal
 contamination.
 • Perform quality-control experiments to verify patterning and specification by using qPCRs
 for brain region–specific genes.
 • Examine the experimental framework for modeling with organoids and assembloids that
 was outlined as part of a consensus effort27.

Validation of candidate genes
Validation of candidate genes from the KO screen can be time consuming, because it involves
the generation of isogenic KO hiPS cell lines and their neural differentiation. Here, we introduce
a practical CRISPR–Cas9–based strategy to generate a KO cell pool for validation. Specifically,
we used Synthego’s gene KO kit, which designs three sgRNAs targeting each candidate gene to
induce concurrent double-strand breaks. We optimized the nucleofection protocol to achieve
high-efficiency delivery of sgRNAs and Cas9 protein into hiPS cells, generating a cell pool with
a high proportion of KO cells for the targeted gene. This KO cell pool is then used to validate
specific phenotypes.

Expertise needed to implement the protocol
Successful execution of CRISPR screening in neural organoids and assembloids requires expertise
across several domains. The first is proficiency in hiPS cell culture, differentiation into regionalized
neural organoids, and integration of organoids into assembloids. The second is experience with
lentiviral production and transduction, genetic engineering of hiPS cell lines (e.g., knock-in
reporters or Cas9 expression) and large-scale pooled library delivery. Downstream workflows
also require expertise in fluorescence-activated cell sorting (FACS). Finally, analysis involves
extracting and processing genomic DNA from organoids, preparing samples for next-generation
sequencing (NGS) and performing computational analyses to assess sgRNA enrichment.


Materials

Biological materials
 • Human iPS cells. The hiPS cells (CAG::Cas9;Dlxi1/2b::eGFP cell line, parental line: 1205-4)
 used to generate the results shown in this protocol were derived at Stanford University and
 validated by using standard methods (pluripotency assays and genome integrity). This
 cell line is available upon request. Details on its generation can be found in the original
 publication reporting this cell line16.
 ▲ CAUTION The experiments using hiPS cells in this study were approved by the Stanford
 University School of Medicine Institutional Review Board and the Stem Cell Research
 Oversight.
 ▲ CAUTION Check cells lines regularly to ensure that they are authentic and are not infected
 with mycoplasma.
 • Pooled lentivirus library. For this study, we cloned five sgRNAs targeting each of the 438
 genes of interest and an extra 10% ‘safe’ harbor-targeting negative control sgRNAs into a
 lentiviral plasmid vector that constitutively expresses the sgRNA and mCherry (pMCB320,
 Addgene, cat. no. 89359). We obtained the sgRNA sequences for our genes of interest
 and negative controls from a human CRISPR KO library that we previously published35.
 Lentivirus was produced in human embryonic kidney 293T cells using standard protocols.
 ▲ CAUTION Lentivirus is often considered a biosafety level 2 or higher material and should
 be handled appropriately. Check the safety regulations in your institution.

Reagents
For cell culture
 • Vitronectin recombinant human protein, truncated (Thermo Fisher Scientific,
 cat. no. A14700)

Nature Protocols 7

Protocol


 • Dulbecco’s PBS (DPBS), no calcium, no magnesium (Thermo Fisher Scientific,
 cat. no. 14190144)
 • Accutase (Innovative Cell Technologies, cat. no. AT-104)
 • Essential 8 (E8) medium (Thermo Fisher Scientific, cat. no. A1517001)
 • ROCK inhibitor Y-27632 (Selleckchem, cat. no. S1049)
 • Polybrene infection/transfection reagent (Sigma-Aldrich, cat. no. TR-1003)
 • Anti-adherence rinsing solution (STEMCELL Technologies, cat. no. 07010)
 • DMEM/F-12 (1:1; Life Technologies, cat. no. 11330-032)
 • Essential 6 (E6) medium (Thermo Fisher Scientific, cat. no. A1516401)
 • Dorsomorphin (Millipore Sigma, cat. no. P5499)
 • SB-431542 (R&D Systems/Tocris, cat. no. 1614)
 • XAV-939 (Tocris, cat. no. 3748)
 • Smoothened agonist (SAG; Selleckchem, cat. no. S7779)
 • Neurobasal A medium (Thermo Fisher Scientific, cat. no. 10888022)
 • B-27 supplement (50×), minus vitamin A (Thermo Fisher Scientific, cat. no. 12587010)
 ▲ CRITICAL There is also a B-27 product with vitamin A. Be sure to use the one without
 vitamin A.
 • GlutaMAX supplement (Thermo Fisher Scientific, cat. no. 35050061)
 • Penicillin-streptomycin (10,000 U ml−1) (Thermo Fisher Scientific, cat. no. 15140122)
 • Human recombinant EGF protein (R&D Systems, cat. no. 236-EG)
 • Human recombinant FGF2 protein (R&D Systems, cat. no. 233-FB)
 • Human recombinant brain-derived neurotrophic factor (BDNF; PeproTech, cat. no. 450-02)
 • Human recombinant neurotrophin 3 (PeproTech, cat. no. 450-03)

For dissociation
 • Ultrapure DNase/RNase-free distilled water (Invitrogen, cat. no. 10977015)
 • 10× Earle’s balanced salt solution (EBSS; Sigma, cat. no. E7510)
 • d(+)-Glucose (Sigma, cat. no. G7021)
 • NaHCO3 (Sigma, cat. no. S5761)
 • EDTA (Sigma, cat. no. ED)
 • Papain (Worthington, cat. no. LS003126)
 • Deoxyribonuclease I (Worthington, cat. no. LS002007); dissolve DNase I in EBSS at a
 concentration of 12,500 U ml−1
 • l-Cysteine hydrochloride monochloride (Sigma, cat. no. C7880)
 • BSA (Sigma, cat. no. A4161)
 • Trypsin inhibitor (Worthington, cat. no. LS003086)
 • 1 N NaOH (MilliporeSigma, cat. no. S2770)

For generating individual KO hiPS cell lines
 • SpCas9 2NLS nuclease, Synthego (currently EditCo)
 • Gene KO kit containing sgRNAs targeting the gene of interest, Synthego (currently EditCo)

Equipment
 • Air-jacketed 37 °C and 5% CO2 incubator (VWR, cat. no. 10810-902)
 • Biological safety cabinet (Labconco, cat. no. 97000-862)
 • Centrifuge 5810 R (Eppendorf, cat. no. 022628187)
 • Bright-Line hemocytometer (MilliporeSigma, cat. no. Z359629)
 • Water bath
 • Costar six-well clear tissue culture-treated multiple-well plates (Corning, cat. no. 3506)
 • Primaria cell culture dish, 10 cm (BD Falcon, cat. no. 353803)
 • Sterile plastic tubes, 15 and 50 ml (Corning, cat. nos. 430791 and 430829, respectively)
 • Sterile plastic pipettes (5, 10, 25 and 50 ml; Corning, cat. nos. 356543, 356551, 356525 and
 356550, respectively)
 • AggreWell800 plates (STEMCELL Technologies, cat. no. 34815)


Nature Protocols 8

Protocol


 • Falcon 40-µm cell strainer, blue, sterile (Corning, cat. no. 352340)
 • Ultra-low-attachment plates (100 mm, 6 well and 24 well; Corning, cat. nos. 3262, 3471 and
 3473, respectively)
 • DNA LoBind 15-ml conical tubes (Eppendorf, cat. no. 0030122208)
 • Sterile tips (P1000, P200 and P20; Thermo Fisher Scientific, cat. nos. 2779-HR, 2769-HR and
 2749-HR, respectively)
 • P1000 pipette tips with wide orifice (Rainin, cat. no. 30389218)
 • CellTrics sterile single-pack filters, 50 µm (Sysmex, cat. no. 04-004-2327)
 • Nylon 0.22-μm nylon syringe filter (Celltreat, cat. no. 229775)
 • BD-Aria II instruments for flow cytometry (BD Biosciences, cat. no. 643180)

Software
 • CasTLE (https://bitbucket.org/dmorgens/castle/downloads/)

Reagent setup
Small molecules and recombinant proteins (for differentiation)
Dorsomorphin (5 mM stock in dimethyl sulfoxide (DMSO)). Dissolve 99.85 mg of dorsomorphin in
50 ml of DMSO to make a 5 mM stock. To avoid freeze-thaw cycles, make 1-ml aliquots and store
at −80 °C for ≤6 months. Use in 1 week when stored at 4 °C.

SB-431542 (10 mM stock in ethanol). Dissolve 192.20 mg of SB-431542 in 50 ml of 200 proof
ethanol to make a 10 mM stock. To avoid freeze-thaw cycles, make 1-ml aliquots and store at
−80 °C for ≤6 months. Use in 1 week when stored at 4 °C.

XAV-939 (2.5 mM stock in DMSO). Dissolve 39.04 mg of XAV-939 in 50 ml of DMSO to make a
2.5 mM stock. To avoid freeze-thaw cycles, make 1-ml aliquots and store at −80 °C for ≤6 months.
Use in 1 week when stored at 4 °C.

SAG (100 µM stock in DMSO). Dissolve 2.63 mg of SAG in 50 ml of DMSO to make a 100 µM stock.
To avoid freeze-thaw cycles, make 100-µl aliquots and store at −80 °C for ≤1 year. Use in 1 week
when stored at 4 °C.

EGF (20 µg ml−1 stock in DPBS with 0.1% BSA). Dissolve 1 mg of FGF2 in 50 ml of fresh DPBS with
0.1% BSA (wt/vol) to make a 20 µg ml−1 stock. To avoid freeze-thaw cycles, make 1-ml aliquots and
store at −80 °C for ≤6 months. Use in 1 month when stored at 4 °C.

FGF2 (20 µg ml−1 stock in DPBS with 0.1% BSA). Dissolve 1 mg of FGF2 in 50 ml of fresh DPBS with
0.1% BSA to make a 20 µg ml−1 stock. To avoid freeze-thaw cycles, make 1-ml aliquots and store at
−80 °C for ≤6 months. Use in 1 month when stored at 4 °C.

BDNF (20 µg ml−1 stock in nuclease-free H2O with 0.1% BSA). Dissolve 1 mg of BDNF in 50 ml
of fresh nuclease-free H2O with 0.1% BSA to make a 20 µg ml−1 stock. To avoid freeze-thaw
cycles, make 1-ml aliquots and store at −80 °C for ≤6 months. Use in 1 week when stored
at 4 °C.

NT3 (20 µg ml−1 stock in nuclease-free H2O with 0.1% BSA). Dissolve 1 mg of NT3 in 50 ml
of fresh nuclease-free H2O with 0.1% BSA to make a 20 µg ml−1 stock. To avoid freeze-thaw
cycles, make 1-ml aliquots and store at −80 °C for ≤6 months. Use in 1 week when stored
at 4 °C.

Chemical solutions (for dissociation)
Y-27632 (10 mM stock in nuclease-free H2O). Dissolve 160.13 mg of Y-27632 in 50 ml of fresh
nuclease-free H2O to make a 10 mM stock. To avoid freeze–thaw cycles, make 1-ml aliquots and
store at −80 °C for ≤1 year. Use in 1 week when stored at 4 °C.


Nature Protocols 9

Protocol


l-Cysteine (6 M stock in nuclease-free H2O). Dissolve 10.54 g of l-cysteine hydrochloride
monohydrate in 10 ml of fresh nuclease-free H2O to make a 6 M stock. To avoid freeze-thaw
cycles, make 0.5-ml aliquots and store at −20 °C for ≤6 months.

Medium preparations (for cell culture)
E8 medium. Prepare the medium as specified in the table below. Store the medium at 4 °C for
≤2 weeks. Allow the E8 medium to come to room temperature (20–25 °C) before use.

Composition Volume (500 ml total) (ml) Final concentration
E8 medium 490 –
E8 supplement 10 2% (vol/vol)


Neural differentiation medium (NM). Prepare the medium as specified in the table below. Store
the medium at 4 °C for ≤2 weeks. Warm NM in a 37 °C water bath for 30 min before use.

Composition Volume (500 ml total) (ml) Final concentration
Neurobasal A medium 480 –
B-27 supplement 10 2% (vol/vol)
GlutaMAX 5 1% (vol/vol)
Penicillin-streptomycin 5 1% (vol/vol)


Solutions (for dissociation)
Enzyme stock solution. Prepare the medium as specified in the table below. Filter the solution
through a nylon 0.22-μm syringe. Store the enzyme stock solution at 4 °C for ≤6 months.

Composition Volume (200 ml total) (ml) Final concentration
ddH2O 170.4 –
10× EBSS 20 1×
30% d(+)-glucose 2.4 0.46% (vol/vol)
1 M NaHCO3 5.2 26 mM
50 mM EDTA 2 0.5 mM

Enzyme solution. Prepare the medium as specified in the table below. Prepare the fresh enzyme
solution on the day of dissociation.

Composition Volume (20 ml total) (ml) Final concentration
Enzyme stock solution 18.76 –
Papain (1,000 U ml−1) 0.6 30 U ml−1
DNase (12,500 U ml−1) 0.6 375 U ml−1
Y-27632 (10 mM stock) 0.02 (1:1,000) 10 µM
l-Cysteine (6 M stock) 0.02 (1:1,000) 6 mM


Inhibitor stock solution. Prepare the medium as specified in the table below. Filter the solution
through a nylon 0.22-μm syringe. Store the inhibitor stock solution at 4 °C for ≤6 months.

Composition Volume (200 ml total) (ml) Final concentration
ddH2O 172.4 –
10× EBSS 20 1×
30% d(+)-glucose 2.4 0.46% (vol/vol)
1 M NaHCO3 5.2 26 mM


Low-ovo stock solution (10×). Prepare the medium as specified in the table below. Filter the
solution through a nylon 0.22-μm syringe. To avoid freeze-thaw cycles, make 1-ml aliquots and
store at −20 °C for ≤6 months.


Nature Protocols 10

Protocol


Composition Volume (200 ml total) (ml) Weight (g) Final concentration Notes
DPBS 150–200 – – –
BSA – 3 1.5% (wt/vol) –
Trypsin inhibitor – 3 1.5% (wt/vol) –
1 N NaOH – – – Add until pH = 7.4


Low-ovo solution. Prepare the medium as specified in the table below. Prepare the fresh low-ovo
solution on the day of dissociation.

Composition Volume (20 ml total) (ml) Final concentration
Inhibitor stock solution 18.45 –
DNase (12,500 U ml−1) 0.1 62.5 U ml−1
Y-27632 (10 mM stock) 0.02 10 µM
Low-ovo stock solution 1.43 –


High-ovo stock solution (10×). Prepare the medium as specified in the table below. Filter the
solution through a nylon 0.22-μm syringe. To avoid freeze-thaw cycles, make 1-ml aliquots and
store at −20 °C for ≤6 months.

Composition Volume (200 ml total) (ml) Weight (g) Final concentration Notes
DPBS 150–200 – – –
BSA – 6 3% (wt/vol) –
Trypsin inhibitor – 6 3% (wt/vol) –
1 N NaOH – – – Add until pH = 7.4


High-ovo solution. Prepare the medium as specified in the table below. Prepare the fresh
high-ovo solution on the day of dissociation.

Composition Volume (20 ml total) (ml) Final concentration
Inhibitor stock solution 15.88 –
DNase (12,500 U ml−1) 0.1 62.5 U ml−1
Y-27632 (10 mM stock) 0.02 10 µM
High-ovo stock solution 4 –


Procedure

Section 1: hiPS cell transduction and gene perturbation
Day 0: preparation of hiPS cells for transduction
● TIMING 2 h
1. Coat six-well plates with diluted vitronectin solution (1:100 dilution with DPBS, 1 ml per
 well) and incubate the plate at room temperature for 1 h. Aspirate vitronectin just before
 transferring the cell suspension to the well.
2. Aspirate culture medium from the hiPS cells cultured in six-well plates and rinse with 1 ml of
 DPBS. Add 1 ml of Accutase and incubate at 37 °C for 7 min in a 5% CO2 incubator. At the end
 of the 7 min, the cells should be easily detached from the plate with gentle shaking.
 ◆ TROUBLESHOOTING
3. Add 1 ml of pre-warmed E8 medium per well to the cells and collect the suspensions into
 15-ml conical tubes. Gently pipette the cell suspension a few times with a serological pipette
 to ensure that any remining clumps are fully dissociated. Centrifuge the samples at 200g
 for 5 min.


Nature Protocols 11

Protocol


4. Aspirate the supernatant and resuspend the cells in E8 medium supplemented with 10 μM
 Y-27632.
5. Count the cells manually by using a Bright-Line hemacytometer and seed 150,000 cells per
 well (in a total of 3 ml of E8 medium) of the six-well plate. Place the plate in a 37 °C, 5% CO2
 incubator.
 ▲ CRITICAL STEP The number of cells seeded on each well is subject to change based on your
 cell line. Ideally, the cells should be ~80–90% confluent at day 4 of the experiment. Avoid
 passaging cells before day 4, as extra cell death can happen during each passaging process.

Day 1: hiPS cell transduction
● TIMING 9 h
6. Aspirate the medium from each well and replace it with 1 ml of pre-warmed E8 medium
 supplemented with 5 μg ml−1 polybrene and the empirically determined volume of lentivirus
 encoding the sgRNA library. After 8 h, add another 1 ml of E8 medium to each well. Place
 the plate back in a 37 °C, 5% CO2 incubator. Maintain one plate of uninfected hiPS cells as a
 negative control.
 ▲ CRITICAL STEP Before conducting the screen, optimize the volume of lentivirus
 required to achieve the desired transduction efficiency—typically ~20–50%—to ensure that
 transduced cells ideally carry only a single copy of the sgRNA expression cassette.

Days 2–3: maintaining transduced hiPS cells
● TIMING 2 d, ~30 min per d
7. Maintain hiPS cell cultures by replacing the medium daily with 3 ml of pre-warmed E8
 medium. Closely monitor the state of the hiPS cells each day before medium change.
 ◆ TROUBLESHOOTING

Day 4: collection of virus-infected hiPS cells through FACS
● TIMING 5 h
8. Dissociate cells with Accutase and prepare a single-cell suspension of hiPS cells the same
 way as described above (day 0, Steps 2–4). Resuspend the cells with 3% BSA/DPBS (wt/vol)
 supplemented with 10 μM Y-27632. Filter the cells with a 50-μm cell strainer and collect the
 cells in 15-ml conical tubes.
9. Conduct FACS to collect mCherry+ cells, which are cells that are infected by the lentivirus
 (the lentivirus encoding the sgRNA library also encodes mCherry to label infected cells).
 Uninfected control cells should be processed similarly as negative controls to set the gate.
 Seed the sorted mCherry+ cells at low density in 10-cm dishes coated with vitronectin in
 10 ml of pre-warmed E8 medium supplemented with 10 μM Y-27632. Place the plate in
 a 37 °C, 5% CO2 incubator.
 ▲ CRITICAL STEP The sgRNA library used in our study contains ~2,400 sgRNAs. We
 collected 3.2 × 106 cells to maintain >1,000× coverage per sgRNA. Guidance on determining
 appropriate sgRNA coverage can be found here36.
 ▲ CRITICAL STEP If appropriate, the selection of virus-infected cells can also be achieved by
 antibiotic selection if the lentivirus encodes an antibiotic resistance gene that the host cells
 do not express.
 ▲ CRITICAL STEP The sorted hiPS cells are seeded in 10-cm dishes to facilitate expansion of
 the cells. The seeding density should be decided by the specific experiment to have enough
 cells for aggregation on day 10 without passaging them from days 5–9.
 ◆ TROUBLESHOOTING

Days 5–9: maintaining hiPS cells
● TIMING 5 d, ~30 min per d
10. Closely monitor the state of hiPS cells each day before the medium change. Maintain hiPS
 cell culture by replacing the medium with 10 ml of pre-warmed E8 medium.
 ■ PAUSE POINT At this point, the cells can either be frozen for future use or be carried
 directly into the next step.

Nature Protocols 12

Protocol


 BOX 1
 Preparation of hCO
 The process of generating hCO is similar to that for hSO, except for the following steps. First, XAV is
 optional while using the E6 medium. Second, no XAV or SAG is required when culturing hCO with NM
 (Fig. 1c)33.


Section 2: generation of hSO with genetically perturbed hiPS cells
▲ CRITICAL We count days of differentiation from day 0.
▲ CRITICAL For the migration screen, hCO are also required. For details on the preparation of
these organoids, see Box 1.

Day 0: generation of 3D neural spheroids with an AggreWell plate
● TIMING 2 h
11. Add 500 μl of anti-adherence rinsing solution to a well of a new AggreWell plate and
 incubate the plate for 5 min at room temperature. Centrifuge the plate at 1,300g for 5 min
 in a swinging bucket rotor to remove any bubbles in the wells. Aspirate the rinsing solution
 and wash with 1 ml of DPBS.
12. Add 1 ml of pre-warmed E8 medium supplemented with 10 μM Y-27632 to each well of the
 AggreWell plate. Centrifuge the plate at 1,300g for 5 min in a swinging bucket rotor to
 remove any bubbles in the wells.
13. Aspirate the medium from the hiPS cell culture plates and rinse the cells with 1 ml of DPBS
 twice.
14. Add 5 ml of Accutase per 10-cm dish and incubate at 37 °C for 7 min in a 5% CO2 incubator.
 At the end of the 7 min, the cells should be easily detached from the plate with gentle
 shaking.
15. Add 5 ml of pre-warmed E8 medium to the cells and collect the suspension into a 50-ml
 conical tube. Gently pipette the cell suspension a few times with a serological pipette to
 ensure that any remining clumps are fully dissociated. Centrifuge the samples at 200g
 for 5 min.
16. Aspirate the supernatant and then resuspend the cells in E8 medium supplemented with
 10 μM Y-27632.
17. Count the cells manually by using a Bright-Line hemacytometer and prepare a cell
 suspension of 3 million cells ml−1. Transfer 1 ml of the cell suspension into a well of an
 AggreWell plate to achieve a final volume of 2 ml per well.
18. Centrifuge the AggreWell plate at 100g for 3 min to distribute the cells in the bottom of
 the micro-wells (Fig. 3a). Carefully transfer the plate into an incubator at 37 °C and 5% CO2.
 Leave the plate untouched for 24 h for the cells to form neural spheroids.
 ◆ TROUBLESHOOTING

Day 1: dislodging neural spheroids from the AggreWell plate
● TIMING 3 h
19. Pre-warm DMEM/F-12 and E6 medium at room temperature for 30 min to 1 h before
 dislodging.
20. Place a 40-μm strainer on top of a 50-ml conical tube and wet the filter with 2 ml of
 DMEM/F-12 (Supplementary Fig. 1).
21. Dislodge neural spheroids from the microwells (Fig. 3b) by gently pipetting the medium
 in the well up and down two to three times with a P1000 pipette by using a 1,000-μl pipette
 tip with wide orifice (1.5 mm) to avoid disturbing the newly formed spheroids.
22. Pass the suspended neural spheroids through the strainer. The neural spheroids will
 remain on the filter of the strainer, while the medium and non-aggregated cells pass
 through.

Nature Protocols 13

Protocol


23. Pipette 1 ml of DMEM/F-12 across the entire surface of the well to dislodge any remaining
 neural spheroids. Pass the remaining neural spheroids through the strainer.
24. Invert the strainer over a 100-mm ultra-low-attachment cell culture dish. Wash the neural
 spheroids from the strainer into the dish by using 10 ml of E6 medium supplemented with
 dorsomorphin (2.5 μM), SB-431542 (10 μM) and XAV-939 (1.25 μM). Place the plate (Fig. 3c)
 in a 37 °C, 5% CO2 incubator for 48 h.
 ▲ CRITICAL STEP Do not perform medium change on the day after dislodging (day 2),
 because it may disturb the recovery of neural spheroids.
 ◆ TROUBLESHOOTING

Days 3–6: neural induction
● TIMING 4 d, ~0.5–3 h per d
25. From day 3 to day 6, perform medium change daily. Carefully remove the medium by using
 a 10-ml serological pipette and replace it with 10 ml of E6 medium supplemented with
 dorsomorphin (2.5 μM), SB-431542 (10 μM) and XAV-939 (1.25 μM).
 ▲ CRITICAL STEP If the organoids fuse to each other, pipette the clusters of organoids
 up and down a few times gently with a 10-ml serological pipette to separate them. If some
 fusions cannot be separated through pipetting, it is fine to leave them as is. Minimize the
 time that the cultures are kept outside of the incubator at all stages of the differentiation.
 ◆ TROUBLESHOOTING

Days 7–44: patterning and differentiation
● TIMING 39 d, ~0.5–3 h per d
26. From day 7 to day 12, perform medium change daily. Carefully remove the medium by using
 a 10-ml serological pipette and replace it with 15 ml of fresh NM supplemented with EGF
 (20 ng ml−1), FGF2 (20 ng ml−1) and XAV-939 (1.25 μM).
27. From day 13 to day 16, perform medium change daily with NM supplemented with EGF
 (20 ng ml−1), FGF2 (20 ng ml−1), XAV-939 (1.25 μM) and Smoothened agonist (SAG, 100 nM).
28. From day 18 to day 24, perform medium change every other day by using NM supplemented
 with EGF (20 ng ml−1), FGF2 (20 ng ml−1), XAV-939 (1.25 μM) and SAG (100 nM).
29. From day 26 to day 44, perform medium change every other day by using NM supplemented
 with BDNF (20 ng ml−1) and NT3 (20 ng ml−1).
 ▲ CRITICAL STEP At this stage, if the organoids still tend to fuse with each other, gently
 separate the fused organoids with a P20 tip to maintain healthy organoids. Limit the
 number of organoids to no more than 30 per 10-cm dish to ensure adequate nutrient
 availability for each organoid.
 ◆ TROUBLESHOOTING

Section 3A: selection for the interneuron generation screen
Day 45: dissociating hSO and sorting Dlxi1/2b::GFP+ and Dlxi1/2b::GFP− cells
● TIMING 8 h
30. Pool 12 organoids into one well of a six-well plate along with 3 ml of enzyme solution
 with papain (10 U ml−1). Incubate the plate with organoids at 37 °C for 15 min in a 5% CO2
 incubator. Gently shake the plate horizontally every 5 min to evenly distribute the papain
 solution. Both control and genetically perturbed hSO should be dissociated at this step,
 because control (uninfected) cells will be needed to set the gate for FACS.
 ▲ CRITICAL STEP Mix the enzyme solution with the appropriate amount of papain and pre-
 warm the mixed solution at 37 °C for 20 min before dissociation of the organoids to activate
 the enzyme. The concentration of papain and incubation time are critical for the yield of
 the dissociation. Optimize these parameters if working with a different type of organoids or
 organoids at a different stage of differentiation.
 ▲ CRITICAL STEP The protocol described here is for dissociation of an individual sample
 consisting of 12 organoids. The yield does not increase linearly with more starting materials.
 We pool 12 organoids as one sample for this step.


Nature Protocols 14

Protocol


31. After digestion, transfer the sample and enzyme solution to a 15-ml conical tube.
32. Centrifuge the 15-ml conical tube for 30 s at 200g. After centrifugation, remove the
 supernatant and add 1 ml of low-ovo solution. Centrifuge the 15-ml conical tube for 30 s
 at 200g. Wash one more time with 1 ml of low-ovo solution and then add 1 ml of low-ovo
 solution to the sample.
33. Mechanically dissociate the organoids by sequentially pipetting a few times with a P1000
 tip. After pipetting, no large chunks of cells should be visible. Transfer ~800 μl of the
 supernatant to a new 15-ml conical tube.
34. Pipette the remaining cell chunks a few times with a P200 tip and transfer ~180 μl of the
 supernatant to the same conical tube. Finally, pipette a few times with a P20 tip to break the
 leftover debris and transfer the remaining supernatant to the same conical tube.
 ▲ CRITICAL STEP Pipette slowly and gently to maintain optimal cell viability. Transferring
 the supernatant between each round of pipetting is needed to avoid repeated pipetting of
 dissociated cells.
 ◆ TROUBLESHOOTING
35. Spin down the cell suspension at 200g for 5 min at 4 °C.
36. Aspirate the supernatant and then resuspend the cell pellet in 1 ml of 3% BSA (wt/vol) diluted
 in 1× DPBS supplemented with 10 μM Y-27632.
37. Filter the cells through a 50-μm pore filter into a 15-ml low-binding tube.
38. Count the cells manually by using a Bright-Line hemacytometer.
39. Collect Dlxi1/2b::GFP+ and Dlxi1/2b::GFP− populations through FACS. Use cells dissociated
 from control hSO as a negative control to set up the gate for FACS. Conduct FACS at 4 °C and
 collect cells in a low-binding 15-ml conical tube containing 5 ml of NM supplemented with
 10% FBS (vol/vol) and 20 μM Y-27632.
 ▲ CRITICAL STEP It is critical to collect a sufficient number of cells. Test the number/
 percentage of Dlxi1/2b::GFP+ cells that you can get through FACS from a certain number of
 organoids to decide on the number of organoids that will be used for the experiment.
 ■ PAUSE POINT Store the collected cells at –80 °C until the next step.

Section 3B: selection for the interneuron migration screen
Days 46–49: generation of hFA by integrating hSO with hCO
● TIMING 4 d
▲ CRITICAL Prepare hCO from control hiPS cells in advance (Box 1). We fused day-61 hCO with
day-46 hSO.
40. Transfer one hCO and one hSO into the same well of a 24-well low-attachment plate by using
 the P1000 pipette tips with wide orifice. Fill each well with 2 ml of NM. Tilt the plate slightly
 to guide both organoids toward the edge of the well. Using a P20 pipette tip, gently position
 the hCO and hSO so that they are in contact with each other (Fig. 3f).
41. Once the assembloids are set up across the entire plate, carefully transfer the plate to a 37 °C
 incubator with 5% CO2, ensuring that the plate remains tilted (Fig. 3g). Keep the plates in the
 tilted position for 4 d without disturbing them.
 ▲ CRITICAL STEP It is important to keep the hFA undisturbed for the first 4 d after fusion
 to successfully generate hFA. We achieved a 100% success rate while generating 1,008
 assembloids.

Days 50–74: maintaining hFA
● TIMING 25 d, ~0.5–3 h per d
42. Change the medium for the hFA every 4 d by replacing 2 ml of NM. Handle the aspiration and
 refilling carefully to avoid disrupting the assembloids.
 ◆ TROUBLESHOOTING
43. Thirty days after assembloid formation, assess interneuron migration in the hFA by using a
 fluorescence microscope. GFP+ cells that have migrated to the hCO region should be readily
 visible (Fig. 3h). hFA with minimal interneuron migration to the hCO side were excluded
 from analysis (~10% of total hFA were excluded on the basis of this criterion).


Nature Protocols 15

Protocol


Day 75: sorting the migrated and leftover Dlxi1/2b::eGFP+ cells
● TIMING depends on the number of samples to process
44. Transfer one hFA into a 10-cm dish. Aspirate the medium as much as possible.
45. Align the assembloid with the hCO on the left and the hSO on the right (Fig. 3i). Use a
 fluorescence microscope to confirm the identity of the hSO by checking the hFA, as the
 hSO should show many Dlxi1/2b::eGFP+ cells.
46. Carefully separate the two organoids at the boundary of the fusion with tweezers or
 scissors.
47. Collect the hCO and hSO into separate dishes with NM. Save the samples in the incubator
 until the next step.
48. Repeat this process for the rest of the hFA.
49. Pool eight organoids per well and then proceed with dissociation. A few control hSO
 (uninfected) should be dissociated at this step to be used as a negative control for FACS.
50. Remove the extra medium from each well and add 3 ml of enzyme solution with papain
 (30 U ml−1) to the well. Incubate the samples at 37 °C for 45 min in a 5% CO2 incubator. Gently
 swirl the plate every 15 min to evenly distribute the enzyme solution.
 ▲ CRITICAL STEP Before dissociation, equilibrate the enzyme solution with an appropriate
 amount of papain at 37 °C for 20 min to activate the enzyme.
51. After digestion with the enzyme solution, transfer the sample and enzyme solution to a
 15-ml conical tube.
52. Centrifuge the 15-ml conical tube for 30 s at 200g. After centrifugation, remove the
 supernatant and add 1 ml of low-ovo solution. Centrifuge the 15-ml conical tube for 30 s
 at 200g. Wash one more time with 1 ml of low-Ovo solution and then add 1 ml of low-ovo
 solution to the sample.
53. Mechanically dissociate the organoids by pipetting a few times with a P1000 tip. After
 pipetting, no large chunks of cells should be visible. Transfer ~800 μl of the supernatant to a
 new 15-ml conical tube.
54. Pipette the remaining cell chunks a few times with a P200 tip and transfer ~180 μl of the
 supernatant to the same conical tube. Finally, pipette a few times with a P20 tip to break the
 leftover debris and transfer the supernatant to the same 15-ml conical tube.
55. Carefully layer 1 ml of high-ovo solution underneath the cell suspension.
56. Centrifuge the 15-ml conical tube for 5 min at 200g to pellet the cells.
57. After centrifugation, aspirate the supernatant and then resuspend the pelleted cells in 1 ml
 of 3% BSA (wt/vol) diluted in 1× DPBS supplemented with 10 μM Y-27632.
58. Filter the cells through a 50-μm pore filter into a 15-ml low-binding tube.
59. Isolate Dlxi1/2b::eGFP+ cells through FACS. Use the cells dissociated from control hSO as a
 negative control to set the FACS gate. Conduct FACS at 4 °C and place the collected cells in a
 low-binding 15-ml conical tube containing 5 ml of NM supplemented with 10% FBS (vol/vol)
 and 20 μM Y-27632.
60. Collect Dlxi1/2b::eGFP+ cells from the separated hSO and hCO. We were able to process
 ~100 hFA in a day.
 ▲ CRITICAL STEP It is crucial to collect a sufficient number of cells. Perform a test to
 determine the number of Dlxi1/2b::eGFP+ cells that can be obtained via FACS from a specific
 number of hFA. Use this information to decide how many hFA will be needed for the
 experiment.
 ◆ TROUBLESHOOTING
 ■ PAUSE POINT Save the cell pellets at –80 °C until the next step.

Section 4: gDNA extraction, PCR, sequencing and data analysis
● TIMING a few weeks
61. Carry out genomic DNA preparation, PCR and sequencing as for any pooled CRISPR
 screen.
62. Analyze the sequencing data with the CasTLE software, which was previously described30,37.
 The analysis provides a maximum likelihood estimator that provides for each gene:


Nature Protocols 16

Protocol


 • a CasTLE score, which is a log-likelihood ratio that considers the relative enrichment
 or depletion of each gene-targeting sgRNA compared to the distribution of negative
 control sgRNA effects
 • an effect size for each sgRNA, which is a CasTLE-estimated maximum gene perturbation
 effect size for each gene.
63. Plot the CasTLE score versus CasTLE-estimated maximum gene perturbation effect size to
 visualize the data. On the basis of this, we selected genes with at least two sgRNAs having
 effects greater than 2× the s.d. of negative controls and no sgRNAs with opposite effects
 beyond the threshold as candidates (see ‘Anticipated results’).

Section 5: validation of individual candidates
● TIMING 3 h for Steps 67–84
Preparing reagents in advance
▲ CRITICAL The following steps outline the optimized nucleofection protocol for generating
15 KO hiPS cell pools for 15 candidate genes.
64. Coat six-well plates with vitronectin (see Step 1).
65. Warm E8 medium supplemented with 10 μM Y-27632 in a 37 °C incubator. Prepare 3.5 ml
 of medium per sample.
66. Obtain the P3 Primary Cell 4D-Nucleofector X kit S. Mix 16.4 μl of Nucleofector solution
 with 3.6 μl of supplement for each sample. Leave the mixture on ice for use.

Assembling ribonucleoprotein (RNP) complexes
67. The sgRNA mix comes in a 96-well plate. Warm the plate to room temperature.
68. Vortex the plate at low speed for 30 s and then centrifuge the plate for 5 min at 500g.
69. Mix 300 pmol of sgRNA with 40 pmol of Cas9 protein in a V-shaped 96-well plate to form
 an RNP complex for sgRNAs targeting each gene. The stock of our sgRNAs was 100 pmol μl−1
 and the Cas9 was 20 pmol μl−1. Therefore, the total volume of our mix was 5 μl.
70. Incubate the RNPs at room temperature for 10 min and then place them on ice until use.

Preparing the cell suspension
71. Aspirate the medium from hiPS cells cultured in six-well plates and wash the cells twice
 with DPBS.
72. Add 1 ml of pre-warmed Accutase to each well. Incubate at 37 °C for 7 min in a 5% CO2
 incubator.
73. Add 1 ml of pre-warmed E8 medium per well to the cells and collect the suspensions into 15-ml
 conical tubes. Gently pipette the cell suspension a few times with a serological pipette to ensure
 that any remining clumps are fully dissociated. Centrifuge the samples at 200g for 5 min.
74. Aspirate the supernatant and then resuspend the cells in E8 medium supplemented with
 10 μM Y-27632. Count the cells manually by using a Bright-Line hemacytometer.
75. We use 0.5 million hiPS cells per nucleofection reaction. To generate 15 KO cell pools for
 15 target genes, plus one negative control, a total of 8 million cells is required. An additional
 1 million cells are included to account for potential loss during the process. Therefore,
 transfer 9 million cells to a new 15-ml Falcon tube and centrifuge at 200g for 5 min.
76. Aspirate the supernatant completely and resuspend the cells with 360 μl of nucleofection
 solution.

Preparing cell/RNP solution
77. Transfer 20 μl of the hiPS cell suspension into each well of the 96-well plate containing 5 μl
 of RNP complex. Mix two to three times through pipetting.

Nucleofection
78. Transfer each cell-RNP mixture (25 μl) to each well of the Nucleocuvette strips. Click the lid
 tight.
79. Gently tap the strip on the benchtop to make sure that the sample covers the bottom of the
 cuvette and that there are no bubbles in the wells.

Nature Protocols 17

Protocol


80. Place the Nucleocuvette strips with closed lid into the retainer of the 4D-Nucleofector X
 unit. Check for proper orientation of the Nucleocuvette strips.
81. Start the nucleofection process by using the CA137 program.
 ▲ CRITICAL STEP Nucleofection efficiency and cell survival rate differ greatly when using
 different nucleofection programs. We tested multiple nucleofection programs and found
 that the current program resulted in high nucleofection efficiency and minimal cell death.
 Optimize nucleofection programs on the basis of specific cell types.
82. After run completion, carefully remove the Nucleocuvette strips from the retainer. Add
 70 μl of pre-warmed E8 supplemented with 10 μM Y-27632 to resuspend the cells. Mix the
 cells by gently pipetting up and down two to three times.

Plating cells
83. Add 5 μl of the cell suspension to one well and the rest to another well of a six-well plate.
 ▲ CRITICAL STEP Seed the desired number of cells according to your experiment. We seed
 5 μl of the cell suspension into a single well of a six-well plate, achieving confluency after 4 d
 of culture, allowing for passaging or hiPS cell aggregation. Any extra cells can be seeded in
 another well and frozen for future use.
84. Change to E8 medium without Y-27632 the next day.
 ◆ TROUBLESHOOTING


 a b hiPS cells
 Potential fragment deletion no. 1
 CSDE1 SYNCRIP SMAD4
 sgRNA1 sgRNA3 CTL KO CTL KO CTL KO


 Exon 500 bp
 sgRNA2

 Potential fragment Potential fragment
 deletion no. 2 deletion no. 3


 c 60 CSDE1 KO d SYNCRIP KO e 40
 SMAD4 KO
 (1205-4) (1205-4)
 (1205-4)
 Percentage of amplicons


 Percentage of amplicons


 40
 Percentage of amplicons


 40

 20
 20
 20


 0 0 0
 8

 4

 64

 58

 0


 6


 5


 8


 4

 99


 0


 8


 7

 8'

 65


 63


 '

 73
 8'
 13
 11
 26


 10


 13
 12


 11


 11


 13


 13


 Deletion size (bp) Deletion size (bp) Deletion size (bp)


 f 1205-4
 g 1205-4 h 1205-4
 KO


 KO
 O
 TL


 TL


 TL
 P
 1K


 RI
 -C


 -C


 4
 -C
 AD
 DE


 NC
 s9


 s9


 s9
 SM
 CS
 Ca


 Ca


 Ca
 SY


 100 kDa 75 kDa
 SMAD4
 CSDE1 SYNCRIP 50 kDa

 GAPDH 37 kDa GAPDH 37 kDa GAPDH 37 kDa

Fig. 4 | Validation of the deletion efficiency of the hiPS KO cell pools. KO (d) and SMAD4 KO (e) cells. The percentage of each amplicon that is >2% is
a, Schematic showing three sgRNAs designed to target an early exon of the gene presented. In e, 138, 138′ and 138′′ indicate three different amplicons that showed
of interest to generate multiple fragment deletions. b, Example of genotype a 138-bp deletion. f–h, Representative western blotting images for KO cell pools
analysis of gDNA extracted from hiPS cells. c–e, Amplicon sequencing results generated from hiPS cells. Panel a reproduced with permission, and panels b–h
from gDNA extracted from day ~40 hSO derived from CSDE1 KO (c), SYNCRIP adapted with permission, from ref. 16, Springer Nature.


Nature Protocols 18

Protocol


Validation of KO efficiency
85. PCR amplification. To validate KO efficiency, amplify the genomic DNA (gDNA) by using
 primers flanking the sgRNA target sites. Because three sgRNAs were used per candidate
 gene (Fig. 4a), we expect the KO cells to exhibit segmental deletions. As a result, PCR
 amplification from KO cells will produce a smaller amplicon. In cases of high KO efficiency,
 only the smaller KO band is detected (Fig. 4b).
86. NGS sequencing of the target gene. For a detailed analysis of mutation types generated by
 the KO, subject the PCR amplicon to NGS. In scenarios with high KO efficiency, only a small
 fraction of PCR amplicons originate from control cells (Fig. 4c–e).
87. Western blotting. To confirm the KO at the protein level, perform western blotting to assess
 the expression of the protein encoded by the target gene. In cases in which KO efficiency
 is high, minimal or no protein expression is observed, with only trace amounts potentially
 originating from control cells (Fig. 4f–h).
 ◆ TROUBLESHOOTING

Conducting functional validations
88. Differentiate the individual KO cell pools into hSO and assess the impact of gene deletion on
 interneuron generation and migration.


Troubleshooting

Troubleshooting advice can be found in Table 1.


Table 1 | Troubleshooting table

Step Problem Possible reason Solution
All culture steps Contamination Inadequate sterile technique Improve sterile technique
 Contaminated hiPS cells Use a new batch of hiPS cells
2 Cells are hard to detach hiPS cells are differentiated Use a new batch of hiPS cells
 from the plate
 Make sure to use E8 medium within 2 weeks of preparation to avoid
 hiPS cell differentiation
7 Low transduction rate Unhealthy hiPS cells Test a new batch of hiPS cells
 Low virus titer Generate high-titer lentivirus
9 Not getting a sufficient The FACS process resulted in extra cell loss Prepare more cells than theoretically calculated. Do a pilot
 number of mCherry+ cells experiment to estimate the cell yield
18 No embryonic body formed Too many dead hiPS cells Conduct the experiment with healthy hiPS cells only
 Issues with the AggreWell plate Make sure to rinse the AggreWell plate with anti-adherence solution
 Mycoplasma or other contamination Perform regular tests to control mycoplasma contamination
24, 25 Dramatic reduction of hiPS cell differentiation See the solution for Step 2
 neural spheroid number
29 Difficult to induce ventral hiPS cell differentiation See the solution for Step 2
 forebrain fate
 Too many organoids per plate Split the culture by maintaining <30 organoids per dish
34 hCO and hSO are hard to Not enough incubation time with the enzyme Adjust the concentration of papain and incubation time depending
 dissociate solution or insufficient amount of papain on your organoid type
42 hFA ‘falling apart’ Timing of fusion It is best to generate hFA with hCO and hSO at 45–60 d
 Too much disturbance to the culture Do not touch the culture for 4 d after setting up the fusion.
 Change the medium by gently removing and replacing the
 medium to the well
60 Poor migration Bad patterning of hCO and hSO Check the quality of hCO and hSO before generating hFA
84 Excess of dead cells after The particular hiPS cell line is vulnerable to Try other nucleofection programs
 nucleofection nucleofection
 Change to another hiPS cell line that better tolerates nucleofection


Nature Protocols 19

Protocol


Table 1 (continued) | Troubleshooting table
Step Problem Possible reason Solution
85–87 Low KO efficiency The experimental design is not optimal Optimize the protocol by testing alternative nucleofection
 programs or increasing the concentrations of sgRNA and Cas9
 protein. In addition, consider designing new sgRNAs to improve
 KO efficiency
 For some genes, it is difficult to achieve high Pick individual clones to identify a KO clone
 KO efficiency


Timing

Section 1, Steps 1–10, hiPS cell transduction and gene perturbation: 10 d
Section 2, Steps 11–29, generation of hSO with genetically perturbed hiPS cells: 46 d
Section 3A, Steps 30–39, selection for the interneuron generation screen: 1 d
Section 3B, Steps 40–60, selection for the interneuron migration screen: 30–37 d
Section 4, Steps 61–63, gDNA extraction, PCR, sequencing and data analysis: a few weeks
Section 5, Steps 64–88, validation of individual candidates: 4 d to generate KO cells


Anticipated results

Aa a reference for screening results, we provide data for the interneuron generation screen
targeting 438 genes of interest. In this screen, we evaluated the relative enrichment of sgRNAs
for each targeted gene when comparing the eGFP+ and eGFP− populations. The plot of CasTLE
score versus CasTLE-estimated maximum gene perturbation effect size shows the overall
distribution of the effect of each gene in interneuron generation (Fig. 5a). Genes with at least
two sgRNAs having effects ≤ –1.57 or ≥ +1.57, approximately 2× the s.d. of negative controls and
no sgRNAs with opposite effects beyond the threshold were selected as candidates (Fig. 5b).
Overall, we identified 13 genes whose sgRNAs have concordant effects that significantly deviate
from the negative control sgRNA distribution.


a Interneuron generation screen b

 Safe sgRNAs
 Dlxi1/2b::eGFP– 20 CSDE1 sgRNAs
 casTLE score


 0.4
 vs CSDE1
 Frequency


 10
 Dlxi1/2b::eGFP+ 0.2


 0
 0
 −4 −2 0 2 4 –4 –2 0 2 4
 KO impairs KO promotes Enrichment
 interneuron casTLE effect interneuron
 generation generation
Fig. 5 | Anticipated results. a, Volcano plot of the CasTLE-estimated maximum gene perturbation effect size and associated
CasTLE score for the interneuron generation screen. Candidates with concordant effects that significantly deviate from
the negative control sgRNA distribution are shown in red. b, Estimation of gene perturbation effect sizes for one of the
candidate genes, CSDE1. Log2 fold change enrichments, normalized to the median of negative ‘safe’-targeting controls, of
sgRNAs between the Dlxi1/2::eGFP+ and Dlxi1/2::eGFP− samples are plotted in green; the distribution of safe-targeting sgRNA
controls is plotted in black. The dashed line is the CasTLE-estimated maximum effect size. Figure adapted with permission
from ref. 16, Springer Nature.


Nature Protocols 20

Protocol


Data availability
The main data discussed in this protocol are available in the supporting primary research
paper16. Additional raw datasets are available for research purposes from the corresponding
author upon request.

Received: 27 January 2025; Accepted: 17 October 2025;
Published online: xx xx xxxx


References


1. Andersen, J. & Pasca, S. P. Absent forebrain replaced by embryonic stem cells. Nature 27. Pasca, S. P. et al. A framework for neural organoids, assembloids and transplantation
 563, 44–45 (2018). studies. Nature 639, 315–320 (2025).
2. Zhang, Z., Wang, X., Park, S., Song, H. & Ming, G. L. Development and application of brain 28. Andrews, M. G. & Kriegstein, A. R. Challenges of organoid research. Annu. Rev. Neurosci.
 region-specific organoids for investigating psychiatric disorders. Biol. Psychiatry 93, 45, 23–39 (2022).
 594–605 (2023). 29. Zhu, Y. et al. Sec61beta facilitates the maintenance of endoplasmic reticulum
3. Camp, J. G. & Treutlein, B. Human organomics: a fresh approach to understanding homeostasis by associating microtubules. Protein Cell 9, 616–628 (2018).
 human development using single-cell transcriptomics. Development 144, 1584–1587 30. Abid, T. et al. Genome-wide pooled CRISPR screening in neurospheres. Nat. Protoc. 18,
 (2017). 2014–2031 (2023).
4. Simoes-Abade, M. B. C., Patterer, M., Nicaise, A. M. & Pluchino, S. Brain organoid 31. Lindenhofer, D. et al. Cerebral organoids display dynamic clonal growth and tunable
 methodologies to explore mechanisms of disease in progressive multiple sclerosis. tissue replenishment. Nat. Cell Biol. 26, 710–718 (2024).
 Front. Cell. Neurosci. 18, 1488691 (2024). 32. Yoon, S. J. et al. Reliability of human cortical organoid generation. Nat. Methods 16, 75–78
5. Birey, F. et al. Assembly of functionally integrated human forebrain spheroids. Nature (2019).
 545, 54–59 (2017). 33. Sloan, S. A., Andersen, J., Pasca, A. M., Birey, F. & Pasca, S. P. Generation and assembly
6. Xiang, Y. et al. Fusion of regionally specified hPSC-derived organoids models human of human brain region–specific three-dimensional cultures. Nat. Protoc. 13, 2062–2085
 brain development and interneuron migration. Cell Stem Cell 21, 383–398.e7 (2017). (2018).
7. Bagley, J. A., Reumann, D., Bian, S., Levi-Strauss, J. & Knoblich, J. A. Fused cerebral 34. Narazaki, G. et al. Biocompatible polymers for scalable production of human neural
 organoids model interactions between brain regions. Nat. Methods 14, 743–751 (2017). organoids. Nat. Biomed. Eng. https://doi.org/10.1038/s41551-025-01427-3 (2025).
8. Birey, F. et al. Dissecting the molecular basis of human interneuron migration in forebrain 35. Morgens, D. W. et al. Genome-scale measurement of off-target activity using Cas9
 assembloids from Timothy syndrome. Cell Stem Cell 29, 248–264.e7 (2022). toxicity in high-throughput screens. Nat. Commun. 8, 15178 (2017).
9. Chen, X. et al. Antisense oligonucleotide therapeutic approach for Timothy syndrome. 36. Bock, C. et al. High-content CRISPR screening. Nat. Rev. Methods Prim. 2, 9 (2022).
 Nature 628, 818–825 (2024). 37. Morgens, D. W., Deans, R. M., Li, A. & Bassik, M. C. Systematic comparison of CRISPR/
10. Contractor, A., Ethell, I. M. & Portera-Cailliau, C. Cortical interneurons in autism. Cas9 and RNAi screens for essential genes. Nat. Biotechnol. 34, 634–636 (2016).
 Nat. Neurosci. 24, 1648–1659 (2021).
11. Nomura, T. Interneuron dysfunction and inhibitory deficits in autism and fragile X Acknowledgements
 syndrome. Cells 10, 2610 (2021). We thank members of the Pașca laboratory for scientific input. Flow cytometry analysis and
12. Palmen, S. J., van Engeland, H., Hof, P. R. & Schmitz, C. Neuropathological findings in cell sorting were performed on instruments in the Stanford Shared FACS Facility obtained by
 autism. Brain 127, 2572–2583 (2004). using an NIH S10 Shared Instrument Grant (S10RR025518-01).
13. Lawrence, Y. A., Kemper, T. L., Bauman, M. L. & Blatt, G. J. Parvalbumin-, calbindin-, and
 calretinin-immunoreactive hippocampal interneuron density in autism. Acta Neurol. Author contributions
 Scand. 121, 99–108 (2010). X.M. optimized the protocol and conducted the screen with supervision from S.P.P. and
14. Kampmann, M. CRISPR-based functional genomics for neurological disease. Nat. Rev. M.C.B. X.M. collected the data for validating screen candidates with help from N.R. X.M., N.R.
 Neurol. 16, 465–480 (2020). and S.P.P. wrote the manuscript.
15. Holcomb, E. A. et al. High-content CRISPR screening in tumor immunology. Front.
 Immunol. 13, 1041451 (2022). Competing interests
16. Meng, X. et al. Assembloid CRISPR screens reveal impact of disease genes in human Stanford University holds multiple patents on organoids and assembloids, with S.P.P. listed as
 neurodevelopment. Nature 622, 359–366 (2023). an inventor.
17. Potter, G. B. et al. Generation of Cre-transgenic mice using Dlx1/Dlx2 enhancers and their
 characterization in GABAergic interneurons. Mol. Cell. Neurosci. 40, 167–186 (2009). Additional information
18. Miura, Y. et al. Generation of human striatal organoids and cortico-striatal assembloids Supplementary information The online version contains supplementary material available at
 from human pluripotent stem cells. Nat. Biotechnol. 38, 1421–1430 (2020). https://doi.org/10.1038/s41596-025-01299-6.
19. Kim, J. I. et al. Human assembloids reveal the consequences of CACNA1G gene variants
 in the thalamocortical pathway. Neuron 112, 4048–4059.e7 (2024). Correspondence and requests for materials should be addressed to Sergiu P. Pașca.
20. Amin, N. D. et al. Generating human neural diversity with a multiplexed morphogen
 screen in organoids. Cell Stem Cell 31, 1831–1846.e9 (2024). Peer review information Nature Protocols thanks the anonymous reviewers for their
21. Eichmuller, O. L. & Knoblich, J. A. Human cerebral organoids—a new tool for clinical contribution to the peer review of this work.
 neurology research. Nat. Rev. Neurol. 18, 661–680 (2022).
22. Levy, R. J. & Pasca, S. P. What have organoids and assembloids taught us about the Reprints and permissions information is available at www.nature.com/reprints.
 pathophysiology of neuropsychiatric disorders? Biol. Psychiatry 93, 632–641 (2023).
23. Tian, R. et al. CRISPR interference-based platform for multimodal genetic screens in Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in
 human iPSC-derived neurons. Neuron 104, 239–255.e12 (2019). published maps and institutional affiliations.
24. Guo, W. et al. CRISPR/Cas9 screen in human iPSC-derived cortical neurons identifies
 NEK6 as a novel disease modifier of C9orf72 poly(PR) toxicity. Alzheimers Dement. 19, Springer Nature or its licensor (e.g. a society or other partner) holds exclusive rights to this
 1245–1259 (2023). article under a publishing agreement with the author(s) or other rightsholder(s); author self-
25. Saurat, N. et al. Genome-wide CRISPR screen identifies neddylation as a regulator of archiving of the accepted manuscript version of this article is solely governed by the terms
 neuronal aging and AD neurodegeneration. Cell Stem Cell 31, 1162–1174.e8 (2024). of such publishing agreement and applicable law.
26. Li, C. et al. Single-cell brain organoid screening identifies developmental defects in
 autism. Nature 621, 373–380 (2023). © Springer Nature Limited 2025


Nature Protocols 21
